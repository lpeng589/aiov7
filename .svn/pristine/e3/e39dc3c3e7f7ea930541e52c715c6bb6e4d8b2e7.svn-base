<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="销售开票明细"/><fieldInfo><field fieldname="Total.startDate" AsfieldName="startDate" groupByFlag="0" displayFlag="1" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="单据日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≥"/><Display localStr="en" display="Document date≥"/><Display localStr="zh_TW" display="單據日期≥"/></Displays><groupNames/></field><field fieldname="Total.endDate" AsfieldName="endDate" groupByFlag="0" displayFlag="1" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="单据日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≤"/><Display localStr="en" display="Document date≤"/><Display localStr="zh_TW" display="单据日期≤"/></Displays><groupNames/></field><field fieldname="Total.ComNumber" AsfieldName="ComNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="供应商编号" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="供应商编号"/><Display localStr="en" display="Supplier code"/><Display localStr="zh_TW" display="供應商編號"/></Displays><groupNames/></field><field fieldname="Total.ComFullName" AsfieldName="ComFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="供应商" fieldType="18" inputType="0" popUpName="" width="200" classCode="1" linkAdd="ReportDataAction.do?reportNumber=ReportBuyInvoice&amp;detTable_list=tblBuyInvoiceInfo&amp;classCode=@ValueofDB:CompanyCode&amp;hide_classCode=@ValueofDB:hide_CompanyCode&amp;tblCompany.ComNumber=@ValueofDB:ComNumber&amp;tblCompany.ComFullName=@ValueofDB:ComFullName&amp;BillDate1=@ValueofDB:startDate&amp;BillDate2=@ValueofDB:endDate" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="供应商"/><Display localStr="en" display="Supplier"/><Display localStr="zh_TW" display="供應商"/></Displays><groupNames/></field><field fieldname="Total.CompanyCode" AsfieldName="CompanyCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="供应商" fieldType="18" inputType="2" popUpName="ReportSelectProvider_v2" width="0" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="供应商"/><Display localStr="en" display="Supplier"/><Display localStr="zh_TW" display="供應商"/></Displays><groupNames/></field><field fieldname="Total.TotalTaxAmount" AsfieldName="TotalTaxAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="总金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="6" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="AmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="总金额"/><Display localStr="en" display="Total amount"/><Display localStr="zh_TW" display="總金額"/></Displays><groupNames/></field><field fieldname="Total.InvoiceAmount" AsfieldName="InvoiceAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="开票金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="AmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="开票金额"/><Display localStr="en" display="Invoice amount"/><Display localStr="zh_TW" display="開票金額"/></Displays><groupNames/></field><field fieldname="Total.NoInvoiceAmount" AsfieldName="NoInvoiceAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="未开票金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="AmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="未开票金额"/><Display localStr="en" display="Invoice amount"/><Display localStr="zh_TW" display="未開票金額"/></Displays><groupNames/></field><field fieldname="Total.NoInvoiceAmount" AsfieldName="NoInvAmount" groupByFlag="0" displayFlag="1" condition="&lt;&gt; ?" conditionJoin="and" orderbyFlag="" display="未开票金额" fieldType="1" inputType="5" popUpName="zero" width="0" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="0" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="AmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="未开票金额"/><Display localStr="en" display="No Invoice Amount"/><Display localStr="zh_TW" display="未開票金額"/></Displays><groupNames/></field><field fieldname="Total.SCompanyID" AsfieldName="SCompanyID" groupByFlag="0" displayFlag="1" condition="='@Sess:SCompanyID'" conditionJoin="and" orderbyFlag="" display="分支机构" fieldType="2" inputType="5" popUpName="zero" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="分支机构"/><Display localStr="en" display="Branch"/><Display localStr="zh_TW" display="分支機構"/></Displays><groupNames/></field><field fieldname="Total.CompanyCode+'#;#0#;##;#'" AsfieldName="hide_CompanyCode" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="11" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field></fieldInfo><SQL text="select vbCrLf    Total.startDate as startDate,vbCrLf    Total.endDate as endDate,vbCrLf    Total.ComNumber as ComNumber,vbCrLf    Total.ComFullName as ComFullName,vbCrLf    Total.CompanyCode as CompanyCode,vbCrLf    Total.TotalTaxAmount as TotalTaxAmount,vbCrLf    Total.InvoiceAmount as InvoiceAmount,vbCrLf    Total.NoInvoiceAmount as NoInvoiceAmount,vbCrLf    Total.NoInvoiceAmount as NoInvAmount,vbCrLf    Total.SCompanyID as SCompanyID,vbCrLf    Total.CompanyCode+'#;#0#;##;#' as hide_CompanyCodevbCrLffrom (vbCrLf    select @condition:startDate as startDate,vbCrLf           @condition:endDate as endDate,vbCrLf           isnull(b.TotalTaxAmount,0)+isnull(c.TotalTaxAmount,0)+isnull(d.TotalTaxAmount,0) AS TotalTaxAmount,vbCrLf           ISNULL(a.InvoiceAmount ,0) AS InvoiceAmount,vbCrLf           isnull(b.TotalTaxAmount,0)+isnull(c.TotalTaxAmount,0)+isnull(d.TotalTaxAmount,0)-ISNULL(a.InvoiceAmount ,0) AS NoInvoiceAmount,vbCrLf           tblCompany.ComNumber,vbCrLf           tblCompany.ComFullName,vbCrLf           tblCompany.SCompanyID,vbCrLf           tblCompany.classCode as CompanyCodevbCrLf    from tblCompany vbCrLf    LEFT JOIN ( vbCrLf         SELECT -SUM(AfterChangeAmt) TotalTaxAmount,CompanyCode vbCrLf         FROM   tblBuyOutStock vbCrLf         WHERE  workFlowNodeName = 'finish' AND (InVoiceType=2 OR InVoiceType=1) AND SCompanyID = @Sess:SCompanyID and BillDate &gt;= @condition:startDate and BillDate &lt;= (case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) vbCrLf         GROUP BY CompanyCodevbCrLf    ) c ON  tblcompany.classcode = c.CompanyCodevbCrLf    left join (vbCrLf         select sum(AfterChangeAmt) TotalTaxAmount,CompanyCode vbCrLf         from tblBuyInStock vbCrLf         where workFlowNodeName = 'finish' and (InVoiceType=2 or InVoiceType=1) and SCompanyID = @Sess:SCompanyID and BillDate &gt;= @condition:startDate and BillDate &lt;= (case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) vbCrLf         group by CompanyCodevbCrLf    ) b ON tblcompany.classcode=b.CompanyCode  vbCrLf    left join (vbCrLf         select sum(TotalTaxAmount) TotalTaxAmount,CompanyCode vbCrLf         from tblBuyReplacevbCrLf         where workFlowNodeName = 'finish' and (InVoiceType=2 or InVoiceType=1) and SCompanyID = @Sess:SCompanyID and BillDate &gt;= @condition:startDate and BillDate &lt;= (case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) vbCrLf         group by CompanyCodevbCrLf    ) d ON tblcompany.classcode=d.CompanyCode  vbCrLf    left join (vbCrLf         select sum(tblBuyInfoDet.ExeBalAmt) InvoiceAmount,tblBuyInfoDet.companycode vbCrLf         from tblBuyInvoiceInfo vbCrLf         join tblBuyInfoDet on tblBuyInfoDet.f_ref=tblBuyInvoiceInfo.id vbCrLf         where tblBuyInvoiceInfo.workFlowNodeName = 'finish' AND tblBuyInvoiceInfo.SCompanyID = @Sess:SCompanyID and tblBuyInvoiceInfo.BillDate &gt;= @condition:startDate and tblBuyInvoiceInfo.BillDate &lt;= (case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) vbCrLf         group by tblBuyInfoDet.companycodevbCrLf    ) a on a.companycode=tblcompany.classcode  vbCrLf    WHERE (tblcompany.ClientFlag = 1 or tblcompany.ClientFlag = 3) AND (LEN(isnull(a.companycode,''))&gt;0 OR LEN(isnull(b.companycode,''))&gt;0 OR LEN(ISNULL(c.companycode ,''))&gt;0)  vbCrLf    group by tblCompany.classcode,a.InvoiceAmount,b.TotalTaxAmount,c.TotalTaxAmount,d.TotalTaxAmount,tblCompany.ComNumber,tblCompany.ComFullName,tblCompany.SCompanyIDvbCrLf) TotalvbCrLfwhere 1=1 vbCrLf      and (Total.startDate &gt;=?)vbCrLf      and (Total.endDate &lt;=?)vbCrLf      and (Total.CompanyCode =?)vbCrLf      and (Total.NoInvoiceAmount &lt;&gt; ?)vbCrLf      and (Total.SCompanyID ='@Sess:SCompanyID')vbCrLfvbCrLfvbCrLfvbCrLf"/><charts/></ReportDataSource>
