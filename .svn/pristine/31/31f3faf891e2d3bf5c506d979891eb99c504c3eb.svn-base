<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="成交分析"/><fieldInfo><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="80" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="职员"/><Display localStr="en" display="Full name of employee"/><Display localStr="zh_TW" display="職員"/></Displays></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="80" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0"><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department full name"/><Display localStr="zh_TW" display="部門"/></Displays></field><field fieldname="ViewCRMCompanyAll.BillDate" AsfieldName="BillDate1" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="开始日期" fieldType="5" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1"><Displays><Display localStr="zh_CN" display="开始日期"/><Display localStr="en" display="Start time"/><Display localStr="zh_TW" display="開始日期"/></Displays></field><field fieldname="ViewCRMCompanyAll.BillDate" AsfieldName="BillDate2" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="结束日期" fieldType="5" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1"><Displays><Display localStr="zh_CN" display="结束日期"/><Display localStr="en" display="End time"/><Display localStr="zh_TW" display="結束日期"/></Displays></field><field fieldname="ViewCRMCompanyAll.createBy" AsfieldName="createBy" groupByFlag="1" displayFlag="1" condition="ViewCRMCompanyAll.createBy in (select id from tblemployee)" conditionJoin="and" orderbyFlag="" display="建立人" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0"><Displays><Display localStr="zh_TW" display="建立人"/><Display localStr="zh_CN" display="建立人"/><Display localStr="en" display="Created by"/></Displays></field><field fieldname="(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMWillClient' and a.BillDate&gt;=@condition:BillDate1 and a.BillDate&lt;=@condition:BillDate2 and a.createBy=ViewCRMCompanyAll.createBy)" AsfieldName="WillQty" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="意向客户数" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="6" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="意向客户数"/><Display localStr="en" display="will Qty"/><Display localStr="zh_TW" display="意向客戶數"/></Displays></field><field fieldname="(select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate1 and b.BillDate&lt;=@condition:BillDate2 and b.createBy=ViewCRMCompanyAll.createBy)" AsfieldName="OKQty" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成交客户数" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="成交客户数"/><Display localStr="en" display="dealing Qty"/><Display localStr="zh_TW" display="成交客戶數"/></Displays></field><field fieldname="case (select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate1 and b.BillDate&lt;=@condition:BillDate2 and b.createBy=ViewCRMCompanyAll.createBy) when 0 then 0 else convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMCompleteClient' and a.BillDate&gt;=@condition:BillDate1 and a.BillDate&lt;=@condition:BillDate2 and a.createBy=ViewCRMCompanyAll.createBy)/(convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate1 and b.BillDate&lt;=@condition:BillDate2 and b.createBy=ViewCRMCompanyAll.createBy))+convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMWillClient' and a.BillDate&gt;=@condition:BillDate1 and a.BillDate&lt;=@condition:BillDate2 and a.createBy=ViewCRMCompanyAll.createBy)))) end " AsfieldName="ratio" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成交率" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="成交率"/></Displays></field></fieldInfo><SQL text="select vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    ViewCRMCompanyAll.createBy as createBy,vbCrLf    (select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMWillClient' and a.BillDate&gt;=@condition:BillDate1 and a.BillDate&lt;=@condition:BillDate2 and a.createBy=ViewCRMCompanyAll.createBy) as WillQty,vbCrLf    (select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate1 and b.BillDate&lt;=@condition:BillDate2 and b.createBy=ViewCRMCompanyAll.createBy) as OKQty,vbCrLf    case (select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate1 and b.BillDate&lt;=@condition:BillDate2 and b.createBy=ViewCRMCompanyAll.createBy) when 0 then 0 else convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMCompleteClient' and a.BillDate&gt;=@condition:BillDate1 and a.BillDate&lt;=@condition:BillDate2 and a.createBy=ViewCRMCompanyAll.createBy)/(convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate1 and b.BillDate&lt;=@condition:BillDate2 and b.createBy=ViewCRMCompanyAll.createBy))+convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMWillClient' and a.BillDate&gt;=@condition:BillDate1 and a.BillDate&lt;=@condition:BillDate2 and a.createBy=ViewCRMCompanyAll.createBy)))) end  as ratiovbCrLffrom ViewCRMCompanyAllvbCrLfleft join tblemployee on tblemployee.id=ViewCRMCompanyAll.createbyvbCrLfleft join tblDepartment on tblDepartment.classCode=tblemployee.DepartmentCodevbCrLfwhere 1=1 vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLf      and (tblDepartment.DeptFullName like '%'+?+'%')vbCrLf      and (ViewCRMCompanyAll.BillDate &gt;=?)vbCrLf      and (ViewCRMCompanyAll.BillDate &lt;=?)vbCrLf      and ViewCRMCompanyAll.createBy in (select id from tblemployee)vbCrLfgroup by vbCrLf   tblEmployee.EmpFullName,vbCrLf   tblDepartment.DeptFullName,vbCrLf   ViewCRMCompanyAll.createByvbCrLfvbCrLf"/></ReportDataSource>
