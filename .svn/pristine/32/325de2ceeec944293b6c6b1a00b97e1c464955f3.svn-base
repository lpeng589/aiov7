<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="活动成果"/><fieldInfo><field fieldname="CRMMartAction.BeginDate" AsfieldName="BeginDate" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="Start date" fieldType="5" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="開始日期"/><Display localStr="zh_CN" display="开始日期"/><Display localStr="en" display="Start date"/></Displays><groupNames/></field><field fieldname="CRMMartAction.EndDate" AsfieldName="EndDate" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="End date" fieldType="5" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="結束日期"/><Display localStr="zh_CN" display="结束日期"/><Display localStr="en" display="End date"/></Displays><groupNames/></field><field fieldname="CRMMartAction.BeginDate" AsfieldName="BeginDate1" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="Start date≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="开始日期≥"/><Display localStr="en" display="Start date≥"/><Display localStr="zh_TW" display="開始日期≥"/></Displays><groupNames/></field><field fieldname="CRMMartAction.EndDate" AsfieldName="EndDate1" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="End date≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="结束日期≤"/><Display localStr="en" display="End date≤"/><Display localStr="zh_TW" display="結束日期≤"/></Displays><groupNames/></field><field fieldname="CRMMartAction.Topic" AsfieldName="Action" groupByFlag="1" displayFlag="1" condition="like+'%'+?+'%'" conditionJoin="and" orderbyFlag="" display="Topic" fieldType="18" inputType="2" popUpName="SelectActionMat" width="200" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="活动"/><Display localStr="en" display="Topic"/><Display localStr="zh_TW" display="活動"/></Displays><groupNames/></field><field fieldname="(select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction)" AsfieldName="ClientQty" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="商機數量" fieldType="0" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="商机数量"/><Display localStr="en" display="Customer Qty"/><Display localStr="zh_TW" display="商機數量"/></Displays><groupNames/></field><field fieldname="(select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction and c.Status=4)" AsfieldName="FinishQty" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成交數量" fieldType="0" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="成交数量"/><Display localStr="en" display="Complete Qty"/><Display localStr="zh_TW" display="成交數量"/></Displays><groupNames/></field><field fieldname="CRMClientInfo.AssociatedAaction" AsfieldName="AssociatedAaction" groupByFlag="1" displayFlag="0" condition="" conditionJoin="" orderbyFlag="" display="Associated action" fieldType="2" inputType="6" popUpName="" width="0" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="關聯活動"/><Display localStr="zh_CN" display="关联活动"/><Display localStr="en" display="Associated action"/></Displays><groupNames/></field><field fieldname="case when len(@condition:Action)=0 and (select count(*) from CRMClientInfo c where c.Status=4  and len(c.AssociatedAaction)!=0)=0 then '0'+'%'  when len(@condition:Action)=0 and (select count(*) from CRMClientInfo c where c.Status=4  and len(c.AssociatedAaction)!=0)!=0 then cast(dbo.getdigits('tblStockDet','lastPrice',cast((select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction and c.Status=4) as numeric(18,4))/(select count(*) from CRMClientInfo c where c.Status=4 and len(c.AssociatedAaction)!=0))*100 as varchar(100))+'%' when len(@condition:Action)!=0 and (select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction)=0 then '0'+'%'  when  len(@condition:Action)!=0 and (select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction)!=0  then cast(dbo.getdigits('tblStockDet','lastPrice',cast((select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction and c.Status=4) as numeric(18,4))/(select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction))*100 as varchar(100))+'%' end" AsfieldName="Scale" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="Scale" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="成交比例"/><Display localStr="en" display="Scale"/><Display localStr="zh_TW" display="成交比例"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    CRMMartAction.BeginDate as BeginDate,vbCrLf    CRMMartAction.EndDate as EndDate,vbCrLf    CRMMartAction.Topic as Action,vbCrLf    (select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction) as ClientQty,vbCrLf    (select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction and c.Status=4) as FinishQty,vbCrLf    case when len(@condition:Action)=0 and (select count(*) from CRMClientInfo c where c.Status=4  and len(c.AssociatedAaction)!=0)=0 then '0'+'%'  when len(@condition:Action)=0 and (select count(*) from CRMClientInfo c where c.Status=4  and len(c.AssociatedAaction)!=0)!=0 then cast(dbo.getdigits('tblStockDet','lastPrice',cast((select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction and c.Status=4) as numeric(18,4))/(select count(*) from CRMClientInfo c where c.Status=4 and len(c.AssociatedAaction)!=0))*100 as varchar(100))+'%' when len(@condition:Action)!=0 and (select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction)=0 then '0'+'%'  when  len(@condition:Action)!=0 and (select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction)!=0  then cast(dbo.getdigits('tblStockDet','lastPrice',cast((select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction and c.Status=4) as numeric(18,4))/(select count(*) from CRMClientInfo c where c.AssociatedAaction=CRMClientInfo.AssociatedAaction))*100 as varchar(100))+'%' end as ScalevbCrLffrom CRMMartActionvbCrLfleft join CRMClientInfo on CRMClientInfo.AssociatedAaction=CRMMartAction.idvbCrLfwhere 1=1 vbCrLf      and (CRMMartAction.BeginDate &gt;=?)vbCrLf      and (CRMMartAction.EndDate &lt;=?)vbCrLf      and (CRMMartAction.Topic like+'%'+?+'%')vbCrLfgroup by vbCrLf   CRMMartAction.BeginDate,vbCrLf   CRMMartAction.EndDate,vbCrLf   CRMMartAction.Topic,vbCrLf   CRMClientInfo.AssociatedAactionvbCrLfvbCrLf  vbCrLf"/><charts><chart><chartName>饼图</chartName><type>Pie3D</type><xAxis name=""><x>Topic</x></xAxis><yAxis name=""><y>FinishQty</y></yAxis></chart></charts></ReportDataSource>
