<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="销售按单毛利表"/><fieldInfo><field fieldname="ViewSalesEmployee.BillDate" AsfieldName="BillDate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="单据日期" fieldType="5" inputType="0" popUpName="" width="80" classCode="1" linkAdd="UserFunctionAction.do?tableName=@ValueofDB:BillType&amp;keyId=@ValueofDB:id&amp;operation=5" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="单据日期"/><Display localStr="en" display="Document date"/><Display localStr="zh_TW" display="單據日期"/></Displays><groupNames/></field><field fieldname="tblModules.modelName" AsfieldName="modelName" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="单据类型" fieldType="2" inputType="4" popUpName="" width="80" classCode="1" linkAdd="UserFunctionAction.do?tableName=@ValueofDB:BillType&amp;keyId=@ValueofDB:id&amp;operation=5" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="单据类型"/><Display localStr="en" display="Document type"/><Display localStr="zh_TW" display="單據類型"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployee.BillNo" AsfieldName="BillNo" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="单据编号" fieldType="2" inputType="0" popUpName="" width="85" classCode="1" linkAdd="UserFunctionAction.do?tableName=@ValueofDB:BillType&amp;keyId=@ValueofDB:id&amp;operation=5" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="单据编号"/><Display localStr="en" display="Document No."/><Display localStr="zh_TW" display="單據編號"/></Displays><groupNames/></field><field fieldname="tblCompany.ComFullName" AsfieldName="ComFullName" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="往来单位" fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="往来单位"/><Display localStr="en" display="Related company"/><Display localStr="zh_TW" display="往來單位"/></Displays><groupNames/></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="经手人" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="经手人"/><Display localStr="en" display="Handler"/><Display localStr="zh_TW" display="經手人"/></Displays><groupNames/></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department"/><Display localStr="zh_TW" display="部門"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployee','Amount',ViewSalesEmployee.Amount)" AsfieldName="Amount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="销售金额" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="UserFunctionAction.do?tableName=@ValueofDB:BillType&amp;keyId=@ValueofDB:id&amp;operation=5" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="销售金额"/><Display localStr="en" display="Sales amount"/><Display localStr="zh_TW" display="銷售金額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployee','CurrentAmt',ViewSalesEmployee.CurrentAmt)" AsfieldName="CurrentAmt" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成本金额" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="成本金额"/><Display localStr="en" display="Cost amount"/><Display localStr="zh_TW" display="成本金額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployee','PresentAmt',ViewSalesEmployee.PresentAmt)" AsfieldName="PresentAmt" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="赠样品费" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="9" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="赠样品费"/><Display localStr="en" display="Gift/sample expense"/><Display localStr="zh_TW" display="贈樣品費"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployee.BillDate" AsfieldName="BillDate_s" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="开始日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="开始日期≥"/><Display localStr="en" display="Start date"/><Display localStr="zh_TW" display="開始日期"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployee.BillDate" AsfieldName="BillDate_e" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="结束日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="11" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="结束日期≤"/><Display localStr="en" display="End date"/><Display localStr="zh_TW" display="結束日期"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('tblSalesFreight','Amount',isnull(tblSalesFreight.Amount,0))" AsfieldName="FreightAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="运费" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="12" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="运费"/><Display localStr="en" display="Transportation charge"/><Display localStr="zh_TW" display="運費"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('tblSalesFreight','PalletAmount',isnull(tblSalesFreight.PalletAmount,0))" AsfieldName="PalletAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="木架费" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="13" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="木架费"/><Display localStr="en" display="Wooden rack expense"/><Display localStr="zh_TW" display="木架費"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('tblSalesInvoiceInfo','TaxAmount',isnull(tblSalesInvoiceInfo.TaxAmount,0))" AsfieldName="TaxAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="税额" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="14" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="税额"/><Display localStr="en" display="Tax amount"/><Display localStr="zh_TW" display="稅額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('tblAccAdjustDet','Amount',isnull(tblAccAdjustDet.Amount,0))" AsfieldName="AdjustAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="调少金额" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="15" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="调少金额"/><Display localStr="en" display="Deducted amount"/><Display localStr="zh_TW" display="調少金額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployee','GrossProfit',ViewSalesEmployee.GrossProfit-isnull(tblSalesFreight.Amount,0)-isnull(tblSalesFreight.PalletAmount,0)-isnull(tblSalesInvoiceInfo.TaxAmount,0)-isnull(tblAccAdjustDet.Amount,0))" AsfieldName="netProfit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="净利" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="16" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="净利"/><Display localStr="en" display="Net profit"/><Display localStr="zh_TW" display="淨利"/></Displays><groupNames/></field><field fieldname="str((ViewSalesEmployee.GrossProfit-isnull(tblSalesFreight.Amount,0)-isnull(tblSalesFreight.PalletAmount,0)-isnull(tblSalesInvoiceInfo.TaxAmount,0)-isnull(tblAccAdjustDet.Amount,0))/case ViewSalesEmployee.Amount when 0 then 1 else  ViewSalesEmployee.Amount end*100,18,2)+'%'" AsfieldName="GrossProfitVar" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="净利率" fieldType="2" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="17" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="净利率"/><Display localStr="en" display="Net profit rate"/><Display localStr="zh_TW" display="淨利率"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployee.Period" AsfieldName="Period" groupByFlag="0" displayFlag="0" condition="" conditionJoin="  " orderbyFlag="" display="会计期间" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="18" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="会计期间"/><Display localStr="en" display="Accounting period"/><Display localStr="zh_TW" display="會計期間"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployee.id" AsfieldName="id" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="19" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays/><groupNames/></field><field fieldname="ViewSalesEmployee.BillType" AsfieldName="BillType" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="单据类型" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="20" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="单据类型"/><Display localStr="en" display="Document type"/><Display localStr="zh_TW" display="單據類型"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployee.SCompanyID" AsfieldName="SCompanyID" groupByFlag="0" displayFlag="1" condition="like ?+'%'" conditionJoin="and" orderbyFlag="" display="分支机构" fieldType="2" inputType="1" popUpName="AllSunCompany" width="0" classCode="1" linkAdd="" order="21" isStat="0" defaultValue="@Sess:SCompanyID" fieldSysType="sunCompany" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="分支机构"/><Display localStr="en" display="Branch"/><Display localStr="zh_TW" display="分支機搆"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    ViewSalesEmployee.BillDate as BillDate,vbCrLf    tblModules.modelName as modelName,vbCrLf    ViewSalesEmployee.BillNo as BillNo,vbCrLf    tblCompany.ComFullName as ComFullName,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    dbo.getDigits('ViewSalesEmployee','Amount',ViewSalesEmployee.Amount) as Amount,vbCrLf    dbo.getDigits('ViewSalesEmployee','CurrentAmt',ViewSalesEmployee.CurrentAmt) as CurrentAmt,vbCrLf    dbo.getDigits('ViewSalesEmployee','PresentAmt',ViewSalesEmployee.PresentAmt) as PresentAmt,vbCrLf    dbo.getDigits('tblSalesFreight','Amount',isnull(tblSalesFreight.Amount,0)) as FreightAmount,vbCrLf    dbo.getDigits('tblSalesFreight','PalletAmount',isnull(tblSalesFreight.PalletAmount,0)) as PalletAmount,vbCrLf    dbo.getDigits('tblSalesInvoiceInfo','TaxAmount',isnull(tblSalesInvoiceInfo.TaxAmount,0)) as TaxAmount,vbCrLf    dbo.getDigits('tblAccAdjustDet','Amount',isnull(tblAccAdjustDet.Amount,0)) as AdjustAmount,vbCrLf    dbo.getDigits('ViewSalesEmployee','GrossProfit',ViewSalesEmployee.GrossProfit-isnull(tblSalesFreight.Amount,0)-isnull(tblSalesFreight.PalletAmount,0)-isnull(tblSalesInvoiceInfo.TaxAmount,0)-isnull(tblAccAdjustDet.Amount,0)) as netProfit,vbCrLf    str((ViewSalesEmployee.GrossProfit-isnull(tblSalesFreight.Amount,0)-isnull(tblSalesFreight.PalletAmount,0)-isnull(tblSalesInvoiceInfo.TaxAmount,0)-isnull(tblAccAdjustDet.Amount,0))/case ViewSalesEmployee.Amount when 0 then 1 else  ViewSalesEmployee.Amount end*100,18,2)+'%' as GrossProfitVar,vbCrLf    ViewSalesEmployee.id as id,vbCrLf    ViewSalesEmployee.BillType as BillType,vbCrLf    ViewSalesEmployee.SCompanyID as SCompanyIDvbCrLffrom ViewSalesEmployeevbCrLfleft join tblDepartment on tblDepartment.classCode=ViewSalesEmployee.DepartmentCode vbCrLfleft join tblEmployee on tblEmployee.id=ViewSalesEmployee.EmployeeID vbCrLfleft join tblCompany on tblCompany.classCode=ViewSalesEmployee.CompanyCode vbCrLfleft join tblModules on tblModules.tblName=ViewSalesEmployee.BillType vbCrLfleft join tblSalesInfoDet on tblSalesInfoDet.RefBillID = ViewSalesEmployee.id vbCrLfleft join tblSalesInvoiceInfo on tblSalesInfoDet.f_ref=tblSalesInvoiceInfo.idvbCrLfleft join tblAccAdjustDet on tblAccAdjustDet.RefBillID = ViewSalesEmployee.id vbCrLfleft join tblSalesFreight on tblSalesFreight.refBillid = ViewSalesEmployee.id andvbCrLftblSalesFreight.freightType=2 vbCrLfwhere 1=1 vbCrLf      and (tblModules.modelName like '%'+?+'%')vbCrLf      and (ViewSalesEmployee.BillNo like '%'+?+'%')vbCrLf      and (tblCompany.ComFullName like '%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName =?)vbCrLf      and (tblDepartment.DeptFullName =?)vbCrLf      and (ViewSalesEmployee.BillDate &gt;=?)vbCrLf      and (ViewSalesEmployee.BillDate &lt;=?)vbCrLf      and (ViewSalesEmployee.SCompanyID like ?+'%')vbCrLfvbCrLfvbCrLf  vbCrLf"/><charts/></ReportDataSource>
