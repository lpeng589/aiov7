var scrollcallback;function startScroll(a){scrollcallback=a;setTimeout(loaded,200)}var myScroll;var pullUpEl;var pullUpOffset;function loaded(){pullUpEl=document.getElementById("pullUp");pullUpOffset=pullUpEl.offsetHeight;myScroll=new iScroll("wrapper",{useTransition:true,onRefresh:function(){if(pullUpEl.className.match("loading")){pullUpEl.className="";pullUpEl.querySelector(".pullUpLabel").innerHTML="上拉显示更多..."}},onScrollMove:function(){if(this.y<(this.maxScrollY-5)&&!pullUpEl.className.match("flip")){pullUpEl.className="flip";pullUpEl.querySelector(".pullUpLabel").innerHTML="释放准备刷新...";this.maxScrollY=this.maxScrollY}else{if(this.y>(this.maxScrollY+5)&&pullUpEl.className.match("flip")){pullUpEl.className="";pullUpEl.querySelector(".pullUpLabel").innerHTML="上拉显示更多...";this.maxScrollY=pullUpOffset}}},onScrollEnd:function(){if(pullUpEl.className.match("flip")){pullUpEl.className="loading";pullUpEl.querySelector(".pullUpLabel").innerHTML="正在加载...";setTimeout(function(){if(typeof(scrollcallback)=="function"){scrollcallback()}},1000)}}});setTimeout(function(){document.getElementById("wrapper").style.left="0"},800)}var mbimgs=new Array();function showWeiXinPic(a){mbimgs=new Array();$("#"+a).find("img[weixinshow=true]").each(function(){mbimgs.push(this.src);var b=this.src;$(this).bind("click",function(){WeixinJSBridge.invoke("imagePreview",{urls:mbimgs,current:b})})})}function mconfirm(d,c,b){var e="popupDialog";$('<div id="'+e+'" style="min-width: 216px; max-width: 500px; position: absolute; z-index: 20000; width: 375px; height: 667px; vertical-align: middle; background-color: #fff;">             <div  class="ui-content" style=" margin: 150px auto; background-color: #777973; border-radius: 8px; width: 60%;">                <span class="ui-title" style="color: #fff; text-align: center;margin-bottom: 15px;letter-spacing: 3px;font-weight: 400;display: inline-block;">'+d+'</span>                <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b optionConfirm"  style="background: #1784fd;width: 33%;border-radius: 5px;height: 30px;line-height: 30px;padding: 0;font-size: .9em;margin: 0 0 0 12%;font-weight: 100;">确定</a>                <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b optionCancel"  style="background: #DBDBDB;width: 33%;border-radius: 5px;height: 30px;line-height: 30px;padding: 0;font-size: .9em;margin: 0 0 0 5%;font-weight: 100;color: #333;text-shadow: none;">取消</a>            </div>        </div>').appendTo(jQuery.mobile.pageContainer);var a=$("#"+e);$(".optionConfirm").on("click",function(){c();$("#"+e).remove()});$(".optionCancel").on("click",function(){b();$("#"+e).remove()});a.show();a.height(document.documentElement.clientHeight);a.width(document.documentElement.clientWidth)}function malert(b){var c="popupDialog";$('<div data-role="popup" id="'+c+'" data-confirmed="no" data-transition="pop" data-overlay-theme="b" data-theme="b" data-dismissible="false" style="min-width:216px;max-width:500px;">                      <div role="main" class="ui-content"  style="text-align: center;">                         <h4 class="ui-title" style="color:#fff; text-align:center;margin-bottom:15px">'+b+'</h4>                         <a href="#" class="ui-btn ui-corner-all ui-shadow ui-btn-inline ui-btn-b optionConfirm" data-rel="back" style="background: #1784fd;width: 33%;border-radius: 5px;height: 30px;line-height: 30px;padding: 0;font-size: .9em;margin: 0 ;font-weight: 100;">确定</a>                     </div>                 </div>').appendTo(jQuery.mobile.pageContainer);var a=$("#"+c);a.trigger("create");a.popup({afterclose:function(d,e){$(d.target).remove()}});a.popup("open")}var checkdefineInfo="";function checkBillDeliver(b,c,a){updateSuccessCallback=a;checkAjax(b,c,"")}function checkAjax(a,c,b){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=check";if(b==undefined||b==""){checkdefineInfo="";b=""}else{checkdefineInfo+=b}jQuery.post(url,{tableName:a,keyId:c,defineInfo:checkdefineInfo},function(d){jQuery.mobile.loading("hide");if(d.code=="CONFIRM"){msg=d.msg.split("#;#");mconfirm(msg[0].replace(/\\n/g,"<br/>"),function(){if(msg[1]!=""){b=msg[1];checkAjax(a,c,b)}},function(){if(msg[2]!=""){b=msg[2];checkAjax(a,c,b)}})}else{if(d.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{if(d.code=="OK"){deliverToPrepare(c,a)}else{alert(d.msg)}}}},"json")}var mydefineInfo="";function execDefine(f,a,b,e,c,d){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=execDefine";if(c==undefined||c==""){mydefineInfo="";c=""}else{mydefineInfo+=c}jQuery.post(url,{defineName:f,buttonTypeName:a,tableName:b,keyId:e,defineInfo:mydefineInfo},function(g){jQuery.mobile.loading("hide");if(g.code=="CONFIRM"){msg=g.msg.split("#;#");mconfirm(msg[0].replace(/\\n/g,"<br/>"),function(){if(msg[1]!=""){c=msg[1];execDefine(f,a,b,e,c,d)}},function(){if(msg[2]!=""){c=msg[2];execDefine(f,a,b,e,c,d)}})}else{if(g.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{if(g.code=="OK"){d()}else{alert(g.msg)}}}},"json")}function getEnum(b){url="/MobileAjax?op=getEnum&enum="+b;var a=jQuery.ajax({url:url,async:false,dataType:"json"}).responseJSON;if(a.code=="OK"){return a.obj}else{alert(a.msg)}}function canAdd(a,c,b,d){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=canAdd";adddata=new Object();adddata.tableName=a;adddata.parentTableName=c;adddata.moduleType=b;jQuery.post(url,adddata,function(e){if(e.code=="OK"){if(d!=undefined){d(e.msg)}}else{if(e.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(e.msg)}}jQuery.mobile.loading("hide")},"json")}function addPrepare(c,f,e,d,a,b,g){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=addPrepare";if(b==undefined||b==""){b=new Object()}b.tableName=c;b.parentTableName=f;b.moduleType=e;b.f_brother=d;b.parentCode=a;jQuery.post(url,b,function(h){if(h.code=="OK"){if(g!=undefined){g(h.obj)}}else{if(h.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(h.msg)}}jQuery.mobile.loading("hide")},"json")}function addBill(c,e,f,d,b,a){updateSuccessCallback=a;addAjax(c,e,f,d,b,"")}function addAjax(b,e,f,c,a,d){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=add";if(d==undefined||d==""){updatedefineInfo="";d=""}else{updatedefineInfo+=d}jQuery.post(url,{tableName:b,parentTableName:e,saveType:f,values:a,defineInfo:updatedefineInfo},function(g){jQuery.mobile.loading("hide");if(g.code=="CONFIRM"){msg=g.msg.split("#;#");mconfirm(msg[0].replace(/\\n/g,"<br/>"),function(){if(msg[1]!=""){d=msg[1];addAjax(b,e,f,c,a,d)}},function(){if(msg[2]!=""){d=msg[2];addAjax(b,e,f,c,a,d)}})}else{if(g.code=="OK"){keyId=g.obj.keyId;if(c){deliverToPrepare(keyId,b)}else{alert(g.obj.msg);if(typeof(updateSuccessCallback)=="function"){updateSuccessCallback()}}}else{if(g.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{alert(g.msg)}}}},"json")}var deletedefineInfo="";function deleteBill(c,a,b){mconfirm("确定要删除吗？",function(){deleteAjax(c,a,b,"")},function(){})}function deleteAjax(d,a,c,b){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=delete";if(b==undefined||b==""){deletedefineInfo="";b=""}else{deletedefineInfo+=b}jQuery.post(url,{tableName:a,keyId:d,defineInfo:deletedefineInfo},function(e){jQuery.mobile.loading("hide");if(e.code=="CONFIRM"){msg=e.msg.split("#;#");mconfirm(msg[0].replace(/\\n/g,"<br/>"),function(){if(msg[1]!=""){b=msg[1];deleteAjax(d,a,c,b)}},function(){if(msg[2]!=""){b=msg[2];deleteAjax(d,a,c,b)}})}else{if(e.code=="OK"){alert(e.msg);if(typeof(c)=="function"){c()}}else{if(e.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{alert(e.msg)}}}},"json")}function cancelTo(c,a,b){mconfirm("确定要撤回吗？",function(){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});jQuery.post("/MobileAjax?op=cancelTo",{keyId:c,tableName:a},function(d){jQuery.mobile.loading("hide");malert(d.msg);if(d.code=="OK"){b()}else{if(d.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}}},"json");$("#detailBtDiv").hide()},function(){})}function retCheck(c,a,b){mconfirm("确定要反审核吗？",function(){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});jQuery.post("/MobileAjax?op=retCheck",{keyId:c,tableName:a},function(d){jQuery.mobile.loading("hide");malert(d.msg);if(d.code=="OK"){b()}else{if(d.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}}},"json");$("#detailBtDiv").hide()},function(){})}function hurryTrans(c,a,b){$("#detailBtDiv").hide();if($("hurryTransDiv").size()==0){$(document.body).append('			 <div data-role="dialog"  id="hurryTransDiv">			 	<div data-role="header">				    <h1>请输入催办信息</h1>				</div> 					  <div data-role="content">					<textarea id="hurryTranscontent" ></textarea>				  </div>									  <div data-role="footer" class="ui-btn">				  <div data-role="controlgroup" data-type="horizontal">				    <a href="javascript:dohurryTrans()" id="hurryTransbt" data-role="button" data-icon="check">确定</a>				    <a href="#" data-role="button" data-rel="back" data-icon="delete">关闭</a>				  </div>  				  </div>				</div>		')}$("#hurryTranscontent").val("有"+b+"需要你审核，请查看 ");$("#hurryTransbt").attr("href","javascript:dohurryTrans('"+c+"','"+a+"')");jQuery.mobile.changePage($("#hurryTransDiv"),{transition:"fade"});return}function dohurryTrans(b,a){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=hurryTrans";wakeType="4,";jQuery.post(url,{tableName:a,keyId:b,content:$("#hurryTranscontent").val(),wakeType:wakeType},function(c){jQuery.mobile.loading("hide");alert(c.msg);if(c.code=="OK"){$(".ui-dialog").dialog("close")}else{if(c.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}}},"json")}var updatedefineInfo="";var updateSuccessCallback;function updateBill(c,e,f,d,b,a){updateSuccessCallback=a;updateAjax(c,e,f,d,b,"")}function updateAjax(b,e,f,c,a,d){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=update";if(d==undefined||d==""){updatedefineInfo="";d=""}else{updatedefineInfo+=d}jQuery.post(url,{tableName:b,parentTableName:e,saveType:f,values:a,defineInfo:updatedefineInfo},function(g){jQuery.mobile.loading("hide");if(g.code=="CONFIRM"){msg=g.msg.split("#;#");mconfirm(msg[0].replace(/\\n/g,"<br/>"),function(){if(msg[1]!=""){d=msg[1];updateAjax(b,e,f,c,a,d)}},function(){if(msg[2]!=""){d=msg[2];updateAjax(b,e,f,c,a,d)}})}else{if(g.code=="OK"){if(c){deliverToPrepare(keyId,b)}else{alert(g.msg);if(typeof(updateSuccessCallback)=="function"){updateSuccessCallback()}}}else{if(g.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{alert(g.msg)}}}},"json")}var curDeliverInfo;var lastActivePage="";var curDeliverKeyId="";function deliverToPrepare(b,a){curDeliverKeyId=b;jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=deliverToPrepare";jQuery.post(url,{keyId:b,tableName:a},function(c){jQuery.mobile.loading("hide");if(c.code=="OK"){curDeliverInfo=(c.obj);showDeliverToPrepare()}else{if(c.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(c.msg)}}jQuery.mobile.loading("hide")},"json")}function showDeliverToPrepare(){if($("#pageAppNode").size()==0){$(document.body).append('  		 <div data-role="page" id="pageAppNode"> 		  <div data-role="header" data-position="fixed">		  	<a href="#pageone"  data-transition="flip" id="pageAppNodeBack" data-role="button" data-icon="back">返回</a>		    <h1>请选择下一步</h1>		  </div>		  <div data-role="content">		    <div data-role="fieldcontain">		    <label for="info">审核意见</label>		    <textarea name="deliverance" id="deliverance"></textarea>		    </div>		  	<ul data-role="listview" id="pageAppNodeUl" style="padding-top:15px">		    </ul>    		  </div>		</div>')}lastActivePage=jQuery.mobile.activePage.attr("id");$("#pageAppNodeBack").attr("href","#"+lastActivePage);flag=false;$("#pageAppNodeUl").empty();$("#pageAppNodeUl").append('<li data-role="list-divider">转交下一结点</li>');for(var a=0;a<curDeliverInfo.nextNodes.length;a++){nextNB=curDeliverInfo.nextNodes[a];if(nextNB.keyId.indexOf("back")<0){$("#pageAppNodeUl").append("<li><a href=\"javascript:showPeople('"+nextNB.keyId+"')\">"+nextNB.display+"</a></li>")}else{flag=true}}if(flag){$("#pageAppNodeUl").append('<li data-role="list-divider">转交回退结点</li>');for(var a=0;a<curDeliverInfo.nextNodes.length;a++){nextNB=curDeliverInfo.nextNodes[a];if(nextNB.keyId.indexOf("back")>=0){$("#pageAppNodeUl").append("<li><a href=\"javascript:showPeople('"+nextNB.keyId+"')\">"+nextNB.display+"</a></li>")}else{flag=true}}}jQuery.mobile.changePage($("#pageAppNode"),{transition:"flip"});$("#pageAppNodeUl").listview("refresh")}var selKeyid;var selNodeCheck;function showPeople(b){$("#oaTimeLimit").val("");selKeyid=b;for(var a=0;a<curDeliverInfo.nextNodes.length;a++){nextNB=curDeliverInfo.nextNodes[a];if(nextNB.keyId==b){selNodeCheck=curDeliverInfo.nextNodes[a];break}}if(b=="-1"){saveDeliver();return}if($("#peopleShow").size()==0){$(document.body).append('  		 <div data-role="page" id="peopleShow">			  <div data-role="header" data-position="fixed">			  	<a href="#pageAppNode" data-transition="slidedown" data-role="button" data-icon="back">返回</a>			    <h1>请选择审核人</h1>			    <a href="javascript:saveDeliverOne()" data-transition="slideup" data-role="button" data-icon="forward">下一步</a>  			  </div>			  <div data-role="content">				<fieldset data-role="controlgroup" id="peopleset">				</fieldset>			  </div>		</div>')}jQuery.mobile.changePage($("#peopleShow"),{transition:"slideup"});$("#peopleset").empty();$("#peopleset").append("<legend>所选审核步骤："+selNodeCheck.display+"</legend>");ckd="";if(selNodeCheck.checkPeople.length==1||selNodeCheck.approvePeople=="fix"){ckd=" checked "}for(var a=0;a<selNodeCheck.checkPeople.length;a++){$("#peopleset").append('<label for="l_'+selNodeCheck.checkPeople[a][0]+'">'+selNodeCheck.checkPeople[a][1]+'</label><input type="checkbox" '+ckd+'  name="checkPeople" id="l_'+selNodeCheck.checkPeople[a][0]+'" value="'+selNodeCheck.checkPeople[a][0]+'">')}$("#peopleset").trigger("create")}function saveDeliverOne(){if(selNodeCheck.forwardTime=="true"){if($("#peopleShow").size()==0){$(document.body).append('  			<div data-role="page" id="approveTime">			  <div data-role="header" data-position="fixed">			  	<a href="#peopleShow" data-transition="slidedown" data-role="button" data-icon="back">返回</a>			    <h1>请指定办理时限</h1>			    <a href="javascript:saveDeliver()" data-transition="slideup" data-role="button" data-icon="forward">下一步</a>  			  </div>			  <div data-role="content">				<fieldset data-role="controlgroup" id="peopleset">					<legend>请指定下一步办理的时限：</legend>					<label for="oaTimeLimit">下一步办理时限:</label>					<input type="text" name="oaTimeLimit" id="oaTimeLimit">				</fieldset>				<fieldset data-role="controlgroup" data-type="horizontal">        			          <label for="t0">天</label>			          <input type="radio" name="oaTimeLimitUnit" id="t0" value="0">			          <label for="t1" >时</label>			          <input type="radio" name="oaTimeLimitUnit" checked id="t1" value="1">			          <label for="t2">分</label>			          <input type="radio" name="oaTimeLimitUnit" id="t2" value="2">				     </fieldset>			  </div>			</div>')}jQuery.mobile.changePage($("#approveTime"),{transition:"slideup"})}else{saveDeliver()}}var selectcheckPerson="";function saveDeliver(){selectcheckPerson="";$("input[type=checkbox]:checked").each(function(){selectcheckPerson+=$(this).val()+";"});if(selKeyid!="-1"&&selectcheckPerson==""){malert("审核人不能为空");return}else{if(selKeyid=="-1"){selectcheckPerson=""}}if(selNodeCheck.forwardTime!="true"){$("#oaTimeLimit").val("")}else{if(selNodeCheck.forwardTime=="true"&&$("#oaTimeLimit").val()==""){malert("请指定办理时限");return}else{if(selNodeCheck.forwardTime=="true"&&!isInt($("#oaTimeLimit").val())){malert("办理时限必须是整数");return}}}mconfirm("确定要提交审核吗？",function(){confirmDeliver()},function(){})}function confirmDeliver(){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});jQuery.post("/MobileAjax?op=deliverTo",{keyId:curDeliverKeyId,type:"",nextStep:selKeyid,currNode:curDeliverInfo.currNode.keyId,designId:curDeliverInfo.designId,tableName:curDeliverInfo.tableName,checkPerson:selectcheckPerson,deliverance:$("#deliverance").val(),oaTimeLimit:$("#oaTimeLimit").val(),oaTimeLimitUnit:$("input[name=oaTimeLimitUnit]:checked").val()},function(a){jQuery.mobile.loading("hide");if(a.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{if(a.code!="OK"){malert(a.msg)}else{jQuery.mobile.changePage($("#"+lastActivePage),{transition:"slidedown"});if(typeof(updateSuccessCallback)=="function"){updateSuccessCallback()}}}},"json")}function detail(c,a,b){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=detail";jQuery.post(url,{keyId:c,tableName:a},function(d){if(d.code=="OK"){if(b!=undefined){b(d.obj)}}else{if(d.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(d.msg)}}jQuery.mobile.loading("hide")},"json")}var totalPage=0;function reportQuery(a,c,b,d){url="/MobileAjax?op=report";if(c){url+="&tableName="+a}else{url+="&reportNumber="+a}jQuery.post(url,b,function(e){if(e.code=="OK"){totalPage=e.obj.totalPage;if(d!=undefined){d(e.obj.conditions,e.obj.cols,e.obj.rows==undefined?[]:e.obj.rows)}if(myScroll){myScroll.refresh()}}else{if(e.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(e.msg)}}},"json")}var popupObject=new Object();var ispopuping=false;function createPopupSelect(b,g,d,a,f,c,e){if(ispopuping){return}else{ispopuping=true}jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});popupObject.tableName=b;popupObject.fieldName=g;popupObject.moduleType=d;popupObject.pageSize=a;popupObject.popupName=f;popupObject.showCallback=c;popupObject.cornfirmCallback=e;popupObject.keyword="";if($("#popupselectDiv").size()==0){$("body").append('<div data-role="dialog" id="popupselectDiv"><div data-role="header"><h1 id="popupselectDivTitle"></h1></div> 			<div data-role="fieldcontain" style="padding:8px;border: none;"> 				  	 	<input  type="search" id="popupselectDivkw" onchange="doPopupSelect(this.value)" value=""> 			</div> 			<div id="scrollerpop">	 					<fieldset id="popupselectListDiv" data-role="controlgroup">  					</fieldset>  			</div>  			<div data-role="footer" class="ui-btn">  			<div data-role="controlgroup" data-type="horizontal"> 			    <a href="javascript:doselectok()" data-role="button" data-icon="check">确定</a> 			    <a href="javascript:doPopupSelectPageNo(false) " data-role="button" data-icon="arrow-l">上页</a> 			    <a href="javascript:doPopupSelectPageNo(true) " data-role="button" data-icon="arrow-r">下页</a> 			</div>   			</div> 		</div>');$(document).on("pageshow","#popupselectDiv",function(){ispopuping=false})}$("#popupselectDivTitle").text(f);$("#popupselectDivkw").val("");jQuery.mobile.changePage($("#popupselectDiv"),{transition:"dialog"});popupSelectInfo(b,g,"",d,"",function(l,h){popupObject.showfields=l;var j=new Object();for(i=0;i<h.length;i++){j[h[i]]=$("#"+h[i]).val()}popupObject.tabParam=j;doPopupSelect("")})}function doselectok(){obj=$("input[name=pkeyId]:checked");if(obj.size()==0){alert("请先选择再确定");return}pos=obj.val();popupObject.cornfirmCallback(popupObject.result[pos]);$(".ui-dialog").dialog("close")}function doPopupSelectPageNo(a){$("#popupselectListDiv").empty();if(a){popupObject.pageNo++}else{popupObject.pageNo--}if(popupObject.pageNo<1){popupObject.pageNo=1}popupSelect(popupObject.tableName,popupObject.fieldName,"",popupObject.moduleType,"",popupObject.pageSize,popupObject.pageNo,popupObject.keyword,popupObject.tabParam,function(b){popupObject.result=b;popupObject.showCallback(popupObject.showfields,b)})}function doPopupSelect(a){$("#popupselectListDiv").empty();popupObject.pageNo=1;popupObject.keyword=a;popupSelect(popupObject.tableName,popupObject.fieldName,"",popupObject.moduleType,"",popupObject.pageSize,popupObject.pageNo,popupObject.keyword,popupObject.tabParam,function(b){popupObject.result=b;popupObject.showCallback(popupObject.showfields,b)})}function popupSelect(g,l,b,d,f,e,a,c,h,j){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=popup&tableName="+g+"&fieldName="+l+"&selectName="+b+"&MOID="+f+"&moduleType="+d+"&pageSize="+e+"&pageNo="+a;if(h==null||h==undefined){h={keyword:c}}else{h.keyword=c}jQuery.post(url,h,function(m){jQuery.mobile.loading("hide");if(m.code=="OK"){if(j!=undefined){j(m.obj.result)}}else{if(m.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(m.msg)}}},"json")}function popupSelectInfo(b,f,a,d,c,e){jQuery.mobile.loading("show",{text:"正在努力中...",textVisible:true,theme:"a",textonly:false,html:""});url="/MobileAjax?op=popupInfo&tableName="+b+"&fieldName="+f+"&selectName="+a+"&MOID="+c+"&moduleType="+d+"&pageSize=10&pageNo=1";jQuery.post(url,function(g){jQuery.mobile.loading("hide");if(g.code=="OK"){if(e!=undefined){e(g.obj.showfields,g.obj.tabParam)}}else{if(g.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(g.msg)}}},"json")}function getSTop(){if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollTop}else{if(document.body){return document.body.scrollTop}}}function getSHeight(){if(document.documentElement&&document.documentElement.scrollTop){return document.documentElement.scrollHeight-document.documentElement.clientHeight}else{if(document.body){return document.body.scrollHeight-document.documentElement.clientHeight}}}function showFlowDepict(b,a){if($("#flowDepict").size()==0){$("#"+a).append('		<div class="view-ul-wp" id="flowDepict">			<p class="t-p">审核记录</p>			<ul class="view-ul">							</ul>		</div>')}if(b!=undefined&&b!=null&&b.length>0){vul=$("#flowDepict").find("ul");vul.empty();for(k=1;k<=b.length;k++){deliver=b[k-1];vul.append('<li class="view-li">					<div class="d-pa">						<em class="node-em">第'+k+"步&nbsp;"+deliver.nodeID+'</em>						<span class="check-person">'+deliver.checkPerson+'</span>					</div>					<div class="d-dbk">						<em class="end-time">['+deliver.endTime+']</em>						<div class="app-work-check">							&nbsp;'+(deliver.approvalOpinions!=undefined?deliver.approvalOpinions:"")+'<br>						</div>						<em class="node-type">							'+deliver.nodeType+(deliver.workFlowNode!=undefined&&deliver.workFlowNode!=""?"-> ["+deliver.workFlowNode+"]"+(deliver.checkPersons!=undefined&&deliver.checkPersons!=""?"-"+deliver.checkPersons:""):"")+" 						</em>					</div>				</li>")}}else{$("#flowDepict").hide()}}function getUrlkeyId(){var a=new RegExp("(^|&)keyId=([^&]*)(&|$)","i");var b=window.location.search.substr(1).match(a);if(b!=null){return unescape(b[2])}return null}function showpic(a){if($("#imgObj").size()==0){$(document.body).append('	<div data-role="popup" id="pageimg"  class="photopopup" data-position-to="window" data-overlay-theme="a" data-corners="true" data-tolerance="0,0,0,0">	    <a href="javascript:closeImg();" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">关闭</a>	    <img id="imgObj"  /> 	</div>')}$("#imgObj").attr("src",a);$("#pageimg").popup().popup("open")}function closeImg(){$("#pageimg").popup("close")}function myWorkflowQuery(b,c,a){url="/MobileAjax?op=myworkflow";jQuery.post(url,{approveStatus:b,keyWord:c,pageNo:a},function(e){if(e.code=="OK"){totalPage=e.obj.totalPage;for(var d=0;d<e.obj.list.length;d++){flow=e.obj.list[d];if($("a[href*="+flow.billId+"]").size()>0){continue}$("#myflowlist").append(" 		<li>			<a href=\"javascript:tourl('"+flow.tableName+"','"+flow.billId+'\')" >				<h2><span class="w4">'+flow.templateName+'</span> <span class="w5">'+flow.applyContent+'</span></h2>				<p><span class="w2"> '+flow.applyBy+'</span>				<span class="w3">'+flow.currNodeName+(flow.checkPersonName!=undefined&&flow.checkPersonName!=""?"("+flow.checkPersonName+")":"")+"</span></p>			</a>		</li>			")}$("#myflowlist").listview("refresh");if(myScroll){myScroll.refresh()}}else{if(e.code=="NOLOGIN"){location.href="/MobileQueryAction.do?operation=21"}else{malert(e.msg)}}},"json")}function ajaxUpdateHtml(b,a,c){jQuery.post(b,{},function(d){html=d.substring(d.indexOf("<body>")+6,d.indexOf("</body>")).trim();html=html.substring(html.indexOf(">")+1,html.length-7);$("#"+a).empty();$("#"+a).append(html);c()})};
