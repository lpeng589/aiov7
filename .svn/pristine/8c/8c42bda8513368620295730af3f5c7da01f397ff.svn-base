<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName=""/><fieldInfo><field fieldname="CRMClientRevisit.BillDate" AsfieldName="startDate" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="回访时间≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="回访时间≥"/><Display localStr="en" display="Period From≥"/><Display localStr="zh_TW" display="回訪時間≥"/></Displays><groupNames/></field><field fieldname="CRMClientRevisit.BillDate" AsfieldName="endDate" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="回访时间≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="回访时间≤"/><Display localStr="en" display="Period To≤"/><Display localStr="zh_TW" display="回訪時間≤"/></Displays><groupNames/></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="100" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department"/><Display localStr="zh_TW" display="部門"/></Displays><groupNames/></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="100" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="职员"/><Display localStr="en" display="Employee"/><Display localStr="zh_TW" display="職員"/></Displays><groupNames/></field><field fieldname="count(CRMClientRevisit.id)" AsfieldName="RevisitNum" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="次数" fieldType="0" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="次数"/><Display localStr="en" display="Counts"/><Display localStr="zh_TW" display="次數"/></Displays><groupNames/></field><field fieldname="sum(CRMClientRevisit.TotalScore)" AsfieldName="TotalScore" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="总得分" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="总得分"/><Display localStr="en" display="Total Score"/><Display localStr="zh_TW" display="總得分"/></Displays><groupNames/></field><field fieldname="(case count(CRMClientRevisit.id) when 0 then 0 else sum(CRMClientRevisit.TotalScore)/count(CRMClientRevisit.id) end)" AsfieldName="AvgScore" groupByFlag="0" displayFlag="1" condition="CRMClientRevisit.workFlowNodeName='finish'" conditionJoin="and" orderbyFlag="" display="平均分" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="平均分"/><Display localStr="en" display="Avg Score"/><Display localStr="zh_TW" display="平均分"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    count(CRMClientRevisit.id) as RevisitNum,vbCrLf    sum(CRMClientRevisit.TotalScore) as TotalScore,vbCrLf    (case count(CRMClientRevisit.id) when 0 then 0 else sum(CRMClientRevisit.TotalScore)/count(CRMClientRevisit.id) end) as AvgScorevbCrLffrom CRMClientRevisitvbCrLfleft join tblMaintainNote on tblMaintainNote.id=CRMClientRevisit.RefBillIDvbCrLfleft join tblEmployee on tblEmployee.id=CRMClientRevisit.EmployeeIDvbCrLfleft join tblDepartment on tblDepartment.classCode=tblEmployee.DepartmentCodevbCrLfwhere 1=1 vbCrLf      and (CRMClientRevisit.BillDate &gt;=?)vbCrLf      and (CRMClientRevisit.BillDate &lt;=?)vbCrLf      and (tblDepartment.DeptFullName like '%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLf      and CRMClientRevisit.workFlowNodeName='finish'vbCrLfgroup by vbCrLf   tblDepartment.DeptFullName,vbCrLf   tblEmployee.EmpFullNamevbCrLfvbCrLf  vbCrLf"/><charts/></ReportDataSource>
