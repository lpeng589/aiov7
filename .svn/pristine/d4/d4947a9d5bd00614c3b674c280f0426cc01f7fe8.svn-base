<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName=""/><fieldInfo><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="80" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="职员"/><Display localStr="en" display="Full name of employee"/><Display localStr="zh_TW" display="職員"/></Displays></field><field fieldname="cast(year(ViewCRMCompanyAll.BillDate) as varchar(10))+'.'+cast(month(ViewCRMCompanyAll.BillDate) as varchar(10))" AsfieldName="createTime" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="日期" fieldType="6" inputType="0" popUpName="" width="70" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="日期"/><Display localStr="en" display="Date"/><Display localStr="zh_TW" display="日期"/></Displays></field><field fieldname="case (select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate_s and b.BillDate&lt;=@condition:BillDate_e and b.createBy=ViewCRMCompanyAll.createBy and year(b.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(b.BillDate)=month(ViewCRMCompanyAll.BillDate)) when 0 then 0  else convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMCompleteClient' and a.BillDate&gt;=@condition:BillDate_s and a.BillDate&lt;=@condition:BillDate_e and a.createBy=ViewCRMCompanyAll.createBy and year(a.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(a.BillDate)=month(ViewCRMCompanyAll.BillDate))/(convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate_s and b.BillDate&lt;=@condition:BillDate_e and b.createBy=ViewCRMCompanyAll.createBy and year(b.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(b.BillDate)=month(ViewCRMCompanyAll.BillDate)))+convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMWillClient' and a.BillDate&gt;=@condition:BillDate_s and a.BillDate&lt;=@condition:BillDate_e and a.createBy=ViewCRMCompanyAll.createBy and year(a.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(a.BillDate)=month(ViewCRMCompanyAll.BillDate))))) end" AsfieldName="CompanyName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成交率" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0"><Displays><Display localStr="zh_CN" display="成交率"/><Display localStr="en" display="Strike a bargain customer"/><Display localStr="zh_TW" display="成交率"/></Displays></field><field fieldname="ViewCRMCompanyAll.BillDate" AsfieldName="BillDate_s" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="开始日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="1"><Displays><Display localStr="zh_CN" display="开始日期≥"/><Display localStr="en" display="Start date≥"/><Display localStr="zh_TW" display="結束日期≥"/></Displays></field><field fieldname="ViewCRMCompanyAll.BillDate" AsfieldName="BillDate_e" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="结束日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="1"><Displays><Display localStr="zh_CN" display="结束日期≤"/><Display localStr="en" display="End date≤"/><Display localStr="zh_TW" display="結束日期≤"/></Displays></field><field fieldname="year(ViewCRMCompanyAll.BillDate)" AsfieldName="periodYear" groupByFlag="1" displayFlag="0" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0"><Displays/></field><field fieldname="month(ViewCRMCompanyAll.BillDate)" AsfieldName="period" groupByFlag="1" displayFlag="0" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0"><Displays/></field><field fieldname="ViewCRMCompanyAll.createBy" AsfieldName="createBy" groupByFlag="1" displayFlag="0" condition="" conditionJoin="" orderbyFlag="" display="建立人" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0"><Displays><Display localStr="zh_TW" display="建立人"/><Display localStr="zh_CN" display="建立人"/><Display localStr="en" display="Created by"/></Displays></field></fieldInfo><SQL text="select vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    cast(year(ViewCRMCompanyAll.BillDate) as varchar(10))+'.'+cast(month(ViewCRMCompanyAll.BillDate) as varchar(10)) as createTime,vbCrLf    case (select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate_s and b.BillDate&lt;=@condition:BillDate_e and b.createBy=ViewCRMCompanyAll.createBy and year(b.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(b.BillDate)=month(ViewCRMCompanyAll.BillDate)) when 0 then 0  else convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMCompleteClient' and a.BillDate&gt;=@condition:BillDate_s and a.BillDate&lt;=@condition:BillDate_e and a.createBy=ViewCRMCompanyAll.createBy and year(a.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(a.BillDate)=month(ViewCRMCompanyAll.BillDate))/(convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll b where b.companycategory='tblCMCompleteClient' and b.BillDate&gt;=@condition:BillDate_s and b.BillDate&lt;=@condition:BillDate_e and b.createBy=ViewCRMCompanyAll.createBy and year(b.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(b.BillDate)=month(ViewCRMCompanyAll.BillDate)))+convert(numeric(18, 2),(select  count(*) from  ViewCRMCompanyAll a where a.companycategory='tblCMWillClient' and a.BillDate&gt;=@condition:BillDate_s and a.BillDate&lt;=@condition:BillDate_e and a.createBy=ViewCRMCompanyAll.createBy and year(a.BillDate)=year(ViewCRMCompanyAll.BillDate) and month(a.BillDate)=month(ViewCRMCompanyAll.BillDate))))) end as CompanyNamevbCrLffrom ViewCRMCompanyAllvbCrLfleft join tblemployee on tblemployee.id=ViewCRMCompanyAll.createbyvbCrLfwhere 1=1 vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLf      and (ViewCRMCompanyAll.BillDate &gt;=?)vbCrLf      and (ViewCRMCompanyAll.BillDate &lt;=?)vbCrLfgroup by vbCrLf   tblEmployee.EmpFullName,vbCrLf   year(ViewCRMCompanyAll.BillDate),vbCrLf   month(ViewCRMCompanyAll.BillDate),vbCrLf   ViewCRMCompanyAll.createByvbCrLfvbCrLf"/></ReportDataSource>
