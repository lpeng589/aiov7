<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="销售按单毛利表"/><fieldInfo><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="  " display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="80" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department"/><Display localStr="zh_TW" display="部門"/></Displays><groupNames/></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员全称" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="80" classCode="1" linkAdd="ReportDataAction.do?reportNumber=ReportSalesGrossProfit&amp;src=menu&amp;DeptFullName=@ValueofDB:DeptFullName&amp;src=menu&amp;EmpFullName=@ValueofDB:EmpFullName" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="职员全称"/><Display localStr="en" display="Full name of employee"/><Display localStr="zh_TW" display="職員全稱"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployeeTotal','Amount',sum(ViewSalesEmployeeTotal.Amount))" AsfieldName="Amount" groupByFlag="0" displayFlag="1" condition="(ViewSalesEmployeeTotal.createBy in ('@Sess:UserId') or '@Sess:UserId'='1')" conditionJoin="and" orderbyFlag="" display="销售金额" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="3" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="销售金额"/><Display localStr="en" display="Sales amount"/><Display localStr="zh_TW" display="銷售金額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployeeTotal','CurrentAmt',sum(ViewSalesEmployeeTotal.CurrentAmt))" AsfieldName="CurrentAmt" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成本金额" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="4" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="成本金额"/><Display localStr="en" display="Cost amount"/><Display localStr="zh_TW" display="成本金額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployeeTotal','PresentAmt',sum(ViewSalesEmployeeTotal.PresentAmt))" AsfieldName="PresentAmt" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="赠样品费" fieldType="1" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="5" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="赠样品费"/><Display localStr="en" display="Gift/sample expense"/><Display localStr="zh_TW" display="贈樣品費"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesFreight','FreightAmount',sum(isnull(ViewSalesFreight.FreightAmount,0)))" AsfieldName="FreightAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="运费" fieldType="1" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="6" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="运费"/><Display localStr="en" display="Transportation charge"/><Display localStr="zh_TW" display="運費"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesFreight','InvoiceFreight',sum(isnull(ViewInvoiceFreight.InvoiceFreight,0)))" AsfieldName="InvoiceFreight" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="发票快递费" fieldType="1" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="发票快递费"/><Display localStr="en" display="Invoice express fee"/><Display localStr="zh_TW" display="發票快遞費"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesFreight','PalletAmount',sum(isnull(ViewSalesFreight.PalletAmount,0)))" AsfieldName="PalletAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="木架费" fieldType="1" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="木架费"/><Display localStr="en" display="Wooden rack expense"/><Display localStr="zh_TW" display="木架費"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesInvoice','TaxAmount',sum(isnull(ViewSalesInvoice.TaxAmount,0)))" AsfieldName="TaxAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="含税额" fieldType="1" inputType="0" popUpName="" width="75" classCode="1" linkAdd="" order="9" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="含税额"/><Display localStr="en" display="Amount (tax included)"/><Display localStr="zh_TW" display="含稅額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesAdjust','AdjustAmount',sum(isnull(ViewSalesAdjust.AdjustAmount,0)))" AsfieldName="AdjustAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="调少金额" fieldType="1" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="调少金额"/><Display localStr="en" display="Deducted amount"/><Display localStr="zh_TW" display="調少金額"/></Displays><groupNames/></field><field fieldname="dbo.getDigits('ViewSalesEmployeeTotal','GrossProfit',sum(ViewSalesEmployeeTotal.GrossProfit)-sum(isnull(ViewSalesFreight.FreightAmount,0))-sum(isnull(ViewSalesFreight.PalletAmount,0))-sum(isnull(ViewSalesInvoice.TaxAmount,0))-sum(isnull(ViewSalesAdjust.AdjustAmount,0))-sum(isnull(ViewInvoiceFreight.InvoiceFreight,0)))" AsfieldName="netProfit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="净利" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="11" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="净利"/><Display localStr="en" display="Net profit"/><Display localStr="zh_TW" display="淨利"/></Displays><groupNames/></field><field fieldname="str((sum(ViewSalesEmployeeTotal.GrossProfit)-sum(isnull(ViewSalesFreight.FreightAmount,0))-sum(isnull(ViewSalesFreight.PalletAmount,0))-sum(isnull(ViewSalesInvoice.TaxAmount,0))&#xA;-sum(isnull(ViewSalesAdjust.AdjustAmount,0))-sum(isnull(ViewInvoiceFreight.InvoiceFreight,0)))/case sum(ViewSalesEmployeeTotal.Amount)  when 0 then 1 else sum(ViewSalesEmployeeTotal.Amount) end*100,18,2)+'%'" AsfieldName="GrossProfitVar" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="净利率" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="12" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="净利率"/><Display localStr="en" display="Net profit rate"/><Display localStr="zh_TW" display="淨利率"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployeeTotal.Period" AsfieldName="Period" groupByFlag="0" displayFlag="0" condition="" conditionJoin="  " orderbyFlag="" display="会计期间" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="13" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="会计期间"/><Display localStr="en" display="Accounting period"/><Display localStr="zh_TW" display="會計期間"/></Displays><groupNames/></field><field fieldname="tblDepartment.classCode" AsfieldName="classCode" groupByFlag="1" displayFlag="0" condition="" conditionJoin="" orderbyFlag="升" display="分类代码" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="14" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="分类代码"/><Display localStr="en" display="Sub-category code"/><Display localStr="zh_TW" display="分類代碼"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployeeTotal.BillDate" AsfieldName="BillDate1" groupByFlag="0" displayFlag="0" condition="&gt;= ?" conditionJoin="and" orderbyFlag="" display="开始日期" fieldType="5" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="15" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="开始日期"/><Display localStr="en" display="Start date"/><Display localStr="zh_TW" display="開始日期"/></Displays><groupNames/></field><field fieldname="ViewSalesEmployeeTotal.BillDate" AsfieldName="BillDate2" groupByFlag="0" displayFlag="0" condition="&lt;= ?" conditionJoin="and" orderbyFlag="" display="结束日期" fieldType="5" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="16" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity=""><Displays><Display localStr="zh_CN" display="结束日期"/><Display localStr="en" display="End date"/><Display localStr="zh_TW" display="結束日期"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    dbo.getDigits('ViewSalesEmployeeTotal','Amount',sum(ViewSalesEmployeeTotal.Amount)) as Amount,vbCrLf    dbo.getDigits('ViewSalesEmployeeTotal','CurrentAmt',sum(ViewSalesEmployeeTotal.CurrentAmt)) as CurrentAmt,vbCrLf    dbo.getDigits('ViewSalesEmployeeTotal','PresentAmt',sum(ViewSalesEmployeeTotal.PresentAmt)) as PresentAmt,vbCrLf    dbo.getDigits('ViewSalesFreight','FreightAmount',sum(isnull(ViewSalesFreight.FreightAmount,0))) as FreightAmount,vbCrLf    dbo.getDigits('ViewSalesFreight','InvoiceFreight',sum(isnull(ViewInvoiceFreight.InvoiceFreight,0))) as InvoiceFreight,vbCrLf    dbo.getDigits('ViewSalesFreight','PalletAmount',sum(isnull(ViewSalesFreight.PalletAmount,0))) as PalletAmount,vbCrLf    dbo.getDigits('ViewSalesInvoice','TaxAmount',sum(isnull(ViewSalesInvoice.TaxAmount,0))) as TaxAmount,vbCrLf    dbo.getDigits('ViewSalesAdjust','AdjustAmount',sum(isnull(ViewSalesAdjust.AdjustAmount,0))) as AdjustAmount,vbCrLf    dbo.getDigits('ViewSalesEmployeeTotal','GrossProfit',sum(ViewSalesEmployeeTotal.GrossProfit)-sum(isnull(ViewSalesFreight.FreightAmount,0))-sum(isnull(ViewSalesFreight.PalletAmount,0))-sum(isnull(ViewSalesInvoice.TaxAmount,0))-sum(isnull(ViewSalesAdjust.AdjustAmount,0))-sum(isnull(ViewInvoiceFreight.InvoiceFreight,0))) as netProfit,vbCrLf    str((sum(ViewSalesEmployeeTotal.GrossProfit)-sum(isnull(ViewSalesFreight.FreightAmount,0))-sum(isnull(ViewSalesFreight.PalletAmount,0))-sum(isnull(ViewSalesInvoice.TaxAmount,0))&#xA;-sum(isnull(ViewSalesAdjust.AdjustAmount,0))-sum(isnull(ViewInvoiceFreight.InvoiceFreight,0)))/case sum(ViewSalesEmployeeTotal.Amount)  when 0 then 1 else sum(ViewSalesEmployeeTotal.Amount) end*100,18,2)+'%' as GrossProfitVarvbCrLffrom ViewSalesEmployeeTotalvbCrLfleft join tblDepartment on tblDepartment.classCode=ViewSalesEmployeeTotal.DepartmentCodevbCrLfleft join tblEmployee on tblEmployee.id = ViewSalesEmployeeTotal.employeeidvbCrLfleft join ViewSalesFreight on  ViewSalesFreight.employeeid=ViewSalesEmployeeTotal.employeeid andvbCrLfViewSalesFreight.BillDate=ViewSalesEmployeeTotal.BillDatevbCrLfleft join ViewSalesInvoice on  ViewSalesInvoice.employeeid=ViewSalesEmployeeTotal.employeeid andvbCrLfViewSalesInvoice.BillDate=ViewSalesEmployeeTotal.BillDatevbCrLfleft join ViewSalesAdjust on ViewSalesAdjust.employeeid=ViewSalesEmployeeTotal.employeeid andvbCrLfViewSalesAdjust.BillDate=ViewSalesEmployeeTotal.BillDatevbCrLfleft join ViewInvoiceFreight on ViewInvoiceFreight.employeeid=ViewSalesEmployeeTotal.employeeid andvbCrLfViewInvoiceFreight.BillDate=ViewSalesEmployeeTotal.BillDatevbCrLfwhere 1=1 vbCrLf      and (tblDepartment.DeptFullName like '%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLf      and (ViewSalesEmployeeTotal.createBy in ('@Sess:UserId') or '@Sess:UserId'='1')vbCrLf      and (ViewSalesEmployeeTotal.BillDate &gt;= ?)vbCrLf      and (ViewSalesEmployeeTotal.BillDate &lt;= ?)vbCrLfgroup by vbCrLf   tblDepartment.DeptFullName,vbCrLf   tblEmployee.EmpFullName,vbCrLf   tblDepartment.classCodevbCrLforder by vbCrLf   tblDepartment.classCode vbCrLf  vbCrLf"/><charts/></ReportDataSource>
