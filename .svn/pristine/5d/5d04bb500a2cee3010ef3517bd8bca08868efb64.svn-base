<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="供应商往来统计"/><fieldInfo><field fieldname="'startDate1'" AsfieldName="startDate1" groupByFlag="0" displayFlag="0" condition="=? or 1=1" conditionJoin="and" orderbyFlag="" display="单据日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≥"/><Display localStr="en" display="Document date≥"/><Display localStr="zh_TW" display="單據日期≥"/></Displays><groupNames/></field><field fieldname="'endDate2'" AsfieldName="endDate2" groupByFlag="0" displayFlag="0" condition="=? or 1=1" conditionJoin="and" orderbyFlag="" display="单据日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≤"/><Display localStr="en" display="Document date≤"/><Display localStr="zh_TW" display="單據日期≤"/></Displays><groupNames/></field><field fieldname="'Currency'" AsfieldName="Currency" groupByFlag="0" displayFlag="1" condition="=? or 1=1" conditionJoin="and" orderbyFlag="" display="币种" fieldType="2" inputType="2" popUpName="ReportSelectCurrency_v2" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="currency" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="币种"/><Display localStr="zh_CN" display="币种"/><Display localStr="en" display="Currency type"/></Displays><groupNames/></field><field fieldname="tblCompany.classCode" AsfieldName="CompanyCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="供应商" fieldType="2" inputType="2" popUpName="ReportSelectProvider_v2" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="供应商"/><Display localStr="en" display="Sub-category code"/><Display localStr="zh_TW" display="分类代码"/></Displays><groupNames/></field><field fieldname="tblCompany.[tblCompany_1]" AsfieldName="ComNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="升" display="单位编号" fieldType="2" inputType="0" popUpName="" width="130" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="单位编号"/><Display localStr="en" display="Company No."/><Display localStr="zh_TW" display="單據編號"/></Displays><groupNames/></field><field fieldname="tblCompany.SCompanyID" AsfieldName="SCompanyID" groupByFlag="0" displayFlag="0" condition="=@Sess:SCompanyID" conditionJoin="and" orderbyFlag="" display="分支机构" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="分支机构"/><Display localStr="en" display="Branch"/><Display localStr="zh_TW" display="分支機搆"/></Displays><groupNames/></field><field fieldname="tblCompany.ClassCode" AsfieldName="classCode" groupByFlag="0" displayFlag="1" condition="like ?+'%'" conditionJoin="and" orderbyFlag="升" display="往来单位代码" fieldType="2" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="往来单位代码"/><Display localStr="en" display="Related company code"/><Display localStr="zh_TW" display="往來單位代碼"/></Displays><groupNames/></field><field fieldname="isnull(b.PrePayIni,0)" AsfieldName="PrePayBegin" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="上期预付" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="上期预付"/><Display localStr="en" display="Prepayment b/f"/><Display localStr="zh_TW" display="上期預付"/></Displays><groupNames/></field><field fieldname="isnull(b.PayIni,0)" AsfieldName="PayBegin" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="上期应付" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="9" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="上期应付"/><Display localStr="en" display="Payable b/f"/><Display localStr="zh_TW" display="上期應付"/></Displays><groupNames/></field><field fieldname="isnull(b.PayIni,0)-isnull(b.PrePayIni,0)" AsfieldName="IniPayBegin" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="上期余额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="10" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="上期余额"/><Display localStr="en" display="Balance"/><Display localStr="zh_TW" display="上期餘額"/></Displays><groupNames/></field><field fieldname="isnull(c.CurrPrePay,0)" AsfieldName="PrePayTotalDebit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="预付金额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="11" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="本期发生" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="预付金额"/><Display localStr="en" display="prepayment"/><Display localStr="zh_TW" display="預付金額"/></Displays><groupNames><Display localStr="zh_CN" display="本期发生"/><Display localStr="en" display="Current period"/><Display localStr="zh_TW" display="本期發生"/></groupNames></field><field fieldname="isnull(c.CurrPay,0)" AsfieldName="PayTotalLend" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="应付金额" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="12" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="本期发生" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="应付金额"/><Display localStr="en" display="Payable"/><Display localStr="zh_TW" display="應付金额"/></Displays><groupNames><Display localStr="zh_CN" display="本期发生"/><Display localStr="en" display="Current period"/><Display localStr="zh_TW" display="本期發生"/></groupNames></field><field fieldname="isnull(c.CurrFactPay,0)" AsfieldName="PayTotalDebit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="实付金额" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="13" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="本期发生" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="实付金额"/><Display localStr="en" display="Payment"/><Display localStr="zh_TW" display="實付金額"/></Displays><groupNames><Display localStr="zh_CN" display="本期发生"/><Display localStr="en" display="Current period"/><Display localStr="zh_TW" display="本期發生"/></groupNames></field><field fieldname="isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0)" AsfieldName="PrePayBal" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="预付余额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="14" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="预付余额"/><Display localStr="en" display="Prepayment c/f"/></Displays><groupNames/></field><field fieldname="isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)" AsfieldName="PayBal" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="应付余额" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="15" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="应付余额"/><Display localStr="en" display="Payable c/f"/></Displays><groupNames/></field><field fieldname="isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0))" AsfieldName="PayTotalRemain" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="期末余额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="16" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="期末余额"/><Display localStr="en" display="Ending balance"/><Display localStr="zh_TW" display="期末餘額"/></Displays><groupNames/></field><field fieldname="isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0))" AsfieldName="totalRemain" groupByFlag="0" displayFlag="1" condition="&lt;&gt; ?" conditionJoin="and" orderbyFlag="" display="余额" fieldType="1" inputType="5" popUpName="zero" width="0" classCode="1" linkAdd="" order="17" isStat="0" defaultValue="0" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="余额"/><Display localStr="en" display="totalRemain"/><Display localStr="zh_TW" display="餘額"/></Displays><groupNames/></field><field fieldname="tblCompany.ClientFlag" AsfieldName="ClientFlag" groupByFlag="0" displayFlag="1" condition="(tblCompany.ClientFlag=1 or tblCompany.ClientFlag=3)" conditionJoin="and" orderbyFlag="" display="单位类型" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="18" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单位类型"/><Display localStr="en" display="Organization type"/><Display localStr="zh_TW" display="單位類型"/></Displays><groupNames/></field><field fieldname="tblCompany.isCatalog" AsfieldName="isCatalog" groupByFlag="0" displayFlag="1" condition="=0" conditionJoin="and" orderbyFlag="" display="isCatalog" fieldType="0" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="19" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="isCatalog"/><Display localStr="zh_CN" display="isCatalog"/><Display localStr="en" display="isCatalog"/></Displays><groupNames/></field><field fieldname="(case when '@Sess:Local'='zh_CN' then '应付明细' when '@Sess:Local'='zh_TW' then '應付明細' when '@Sess:Local'='en' then 'Customer Check Detail' end)" AsfieldName="companyDetail" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="操作" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="ReportDataAction.do?reportNumber=@ValueofDB:reportName&amp;hide_CompanyCode=@ValueofDB:hideCode&amp;tblCompany.ComFullName=@ValueofDB:ComFullName&amp;CompanyCode=@ValueofDB:CompanyCode&amp;Currency=@condition:Currency&amp;startDate=@condition:startDate1&amp;endDate=@condition:endDate2&amp;TotalReceive1=0&amp;mainNumber=RptCompanyG" order="20" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="操作"/><Display localStr="en" display="operation"/><Display localStr="zh_TW" display="操作"/></Displays><groupNames/></field><field fieldname="(case when '@Sess:Local'='zh_CN' then '应付对账' when '@Sess:Local'='zh_TW' then '應付對賬' when '@Sess:Local'='en' then 'Customer Check Detail' end)" AsfieldName="accountDetail" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="操作" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="ReportDataAction.do?reportNumber=@ValueofDB:reportName1&amp;hide_CompanyCode=@ValueofDB:hideCode&amp;tblCompany.ComFullName=@ValueofDB:ComFullName&amp;CompanyCode=@ValueofDB:CompanyCode&amp;startDate=@condition:startDate1&amp;endDate=@condition:endDate2&amp;ClientFlag=@ValueofDB:ClientFlag&amp;mainNumber=RptCompanyG&#xA;" order="21" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="操作"/><Display localStr="en" display="operation"/><Display localStr="zh_TW" display="操作"/></Displays><groupNames/></field><field fieldname="(case when tblCompany.ClientFlag=3 then 'ReportCompanyCG' else 'ReportCompanyG' end)" AsfieldName="reportName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="22" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="(case when tblCompany.ClientFlag=3 then 'ComCheckClientProvider' else 'ComCheckProvider' end)" AsfieldName="reportName1" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="23" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="tblCompany.classCode+'#;#'+cast(tblCompany.isCatalog as  varchar(10))+'#;##;#'" AsfieldName="hideCode" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="24" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="(tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))" AsfieldName="Credit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="信用额度" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="25" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="信用額度"/><Display localStr="zh_CN" display="信用额度"/><Display localStr="en" display="Credit amount"/></Displays><groupNames/></field><field fieldname="(tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))" AsfieldName="HideCredit" groupByFlag="0" displayFlag="0" condition="&lt;(isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0))) and (tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))&gt;0 and ?&lt;&gt;100" conditionJoin="and" orderbyFlag="" display="信用额度" fieldType="2" inputType="5" popUpName="PayTotalRemainOverCredit" width="0" classCode="1" linkAdd="" order="26" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="信用額度"/><Display localStr="zh_CN" display="信用额度"/><Display localStr="en" display="Credit amount"/></Displays><groupNames/></field><field fieldname="tblCompany.statusId" AsfieldName="statusId" groupByFlag="0" displayFlag="0" condition="=0" conditionJoin="and" orderbyFlag="" display="状态" fieldType="0" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="27" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="狀態"/><Display localStr="zh_CN" display="状态"/><Display localStr="en" display="Status"/></Displays><groupNames/></field><field fieldname="tblCompany.workFlowNodeName" AsfieldName="workFlowNodeName" groupByFlag="0" displayFlag="0" condition="='finish'" conditionJoin="and" orderbyFlag="" display="workFlowNodeName" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="28" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="workFlowNodeName"/><Display localStr="zh_CN" display="workFlowNodeName"/><Display localStr="en" display="workFlowNodeName"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    'Currency' as Currency,vbCrLf    tblCompany.classCode as CompanyCode,vbCrLf    tblCompany.[tblCompany_1] as ComNumber,vbCrLf    tblCompany.ClassCode as classCode,vbCrLf    isnull(b.PrePayIni,0) as PrePayBegin,vbCrLf    isnull(b.PayIni,0) as PayBegin,vbCrLf    isnull(b.PayIni,0)-isnull(b.PrePayIni,0) as IniPayBegin,vbCrLf    isnull(c.CurrPrePay,0) as PrePayTotalDebit,vbCrLf    isnull(c.CurrPay,0) as PayTotalLend,vbCrLf    isnull(c.CurrFactPay,0) as PayTotalDebit,vbCrLf    isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0) as PrePayBal,vbCrLf    isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0) as PayBal,vbCrLf    isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0)) as PayTotalRemain,vbCrLf    isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0)) as totalRemain,vbCrLf    tblCompany.ClientFlag as ClientFlag,vbCrLf    tblCompany.isCatalog as isCatalog,vbCrLf    (case when '@Sess:Local'='zh_CN' then '应付明细' when '@Sess:Local'='zh_TW' then '應付明細' when '@Sess:Local'='en' then 'Customer Check Detail' end) as companyDetail,vbCrLf    (case when '@Sess:Local'='zh_CN' then '应付对账' when '@Sess:Local'='zh_TW' then '應付對賬' when '@Sess:Local'='en' then 'Customer Check Detail' end) as accountDetail,vbCrLf    (case when tblCompany.ClientFlag=3 then 'ReportCompanyCG' else 'ReportCompanyG' end) as reportName,vbCrLf    (case when tblCompany.ClientFlag=3 then 'ComCheckClientProvider' else 'ComCheckProvider' end) as reportName1,vbCrLf    tblCompany.classCode+'#;#'+cast(tblCompany.isCatalog as  varchar(10))+'#;##;#' as hideCode,vbCrLf    (tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0)) as CreditvbCrLffrom tblCompanyvbCrLfleft join (vbCrLf    select a.classCode companyCode,(case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcPrePayTotalRemain,0)) else sum(isnull(tblCompanyIni.PrePayTotalRemain,0)) end) as PrePayIni,vbCrLf           (case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcPayTotalRemain,0)) else sum(isnull(tblCompanyIni.PayTotalRemain,0)) end) as PayIni vbCrLf    from tblCompany a vbCrLf    left join tblCompanyIni on tblCompanyIni.BillDate&lt;@condition:startDate1 vbCrLf           and tblCompanyIni.id=(select top 1 id from tblCompanyIni k where tblCompanyIni.CompanyCode=k.CompanyCode and BillDate&lt;@condition:startDate1  and  ((case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)!=@conditionv2:Currency then k.Currency else '-99999' end) else '-99999' end)=@conditionv2:Currency or (case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)=@conditionv2:Currency then k.Currency else '-99999' end) else '-99999' end)='' or (case when len(@conditionv2:Currency)=0 then '' else '-99999' end)='') ORDER BY ItemNo desc) vbCrLf           and tblCompanyIni.CompanyCode like a.classCode+'%' vbCrLf           and dbo.deptScope('@Sess:UserId',tblCompanyIni.DepartmentCode)='true' vbCrLf    where ((case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)!=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)=@conditionv2:Currency or (case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)='' or (case when len(@conditionv2:Currency)=0 then '' else '-99999' end)='') vbCrLf    group by a.classCode) as b on b.CompanyCode=tblCompany.classCodevbCrLfleft join (vbCrLf    select a.classCode CompanyCode,(case when len(@conditionv2:Currency)&gt;0 then sum(isnull(FcPrePayTotalDebit,0))-sum(isnull(FcPrePayTotalCredit,0)) else sum(isnull(PrePayTotalDebit,0))-sum(isnull(PrePayTotalLend,0)) end) as CurrPrePay,vbCrLf          (case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcPayTotalCredit,0)) else sum(isnull(tblCompanyIni.PayTotalLend,0)) end) as CurrPay, vbCrLf          (case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcPayTotalDebit,0)) else sum(isnull(tblCompanyIni.PayTotalDebit,0)) end) as CurrFactPay vbCrLf    from tblCompany a vbCrLf    left join tblCompanyIni on tblCompanyIni.BillDate&gt;=@condition:startDate1 vbCrLf          and ((len(@condition:endDate2)=0 and tblCompanyIni.BillDate&lt;='9999-12-31') or tblCompanyIni.BillDate&lt;=@condition:endDate2) and tblCompanyIni.CompanyCode like a.classCode+'%' and dbo.deptScope('@Sess:UserId',tblCompanyIni.DepartmentCode)='true' where ((case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)!=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)=@conditionv2:Currency or (case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)='' or (case when len(@conditionv2:Currency)=0 then '' else '-99999' end)='') vbCrLf    group by a.classCodevbCrLf) as c on c.CompanyCode=tblCompany.classCodevbCrLfLEFT JOIN tblTempCreditApply noRight ON  tblCompany.classCode = tblTempCreditApply.CompanyCodevbCrLfwhere 1=1 vbCrLf      and ('startDate1' =? or 1=1)vbCrLf      and ('endDate2' =? or 1=1)vbCrLf      and ('Currency' =? or 1=1)vbCrLf      and (tblCompany.classCode =?)vbCrLf      and (tblCompany.SCompanyID =@Sess:SCompanyID)vbCrLf      and (tblCompany.ClassCode like ?+'%')vbCrLf      and (isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0)) &lt;&gt; ?)vbCrLf      and (tblCompany.ClientFlag=1 or tblCompany.ClientFlag=3)vbCrLf      and (tblCompany.isCatalog =0)vbCrLf      and ((tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0)) &lt;(isnull(b.PayIni,0)+isnull(c.CurrPay,0)-isnull(c.CurrFactPay,0)-(isnull(b.PrePayIni,0)+isnull(c.CurrPrePay,0))) and (tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))&gt;0 and ?&lt;&gt;100)vbCrLf      and (tblCompany.statusId =0)vbCrLf      and (tblCompany.workFlowNodeName ='finish')vbCrLfvbCrLforder by vbCrLf   tblCompany.[tblCompany_1] ,vbCrLf   tblCompany.ClassCode vbCrLfvbCrLf"/><charts/></ReportDataSource>
