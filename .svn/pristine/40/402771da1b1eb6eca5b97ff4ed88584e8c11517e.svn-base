<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="223f763e_1203211042182350010" reportName="ReportGoalCompleteDept"/><fieldInfo><field fieldname="tblDepartment.DeptFullName" AsfieldName="DepartmentCode" groupByFlag="1" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="100" classCode="1" linkAdd="UserFunctionAction.do?tableName=tblDepartmentGoal&amp;keyId=@ValueofDB:id&amp;operation=5" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="部门"/><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.year" AsfieldName="year" groupByFlag="1" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="年度" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="年度"/><Display localStr="zh_CN" display="年度"/><Display localStr="en" display="Year"/></Displays><groupNames/></field><field fieldname="tblGoalType.name" AsfieldName="goalType" groupByFlag="1" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="类型" fieldType="2" inputType="4" popUpName="" width="100" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="类型"/><Display localStr="zh_CN" display="类型"/><Display localStr="en" display="Type"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.id" AsfieldName="id" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="tblDepartmentGoal.lowGoal" AsfieldName="lowGoal" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="保底目标" fieldType="1" inputType="8" popUpName="" width="120" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="保底目標"/><Display localStr="zh_CN" display="保底目标"/><Display localStr="en" display="Low Goal"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.Goal" AsfieldName="Goal" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="目标" fieldType="1" inputType="8" popUpName="" width="120" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="目標"/><Display localStr="zh_CN" display="目标"/><Display localStr="en" display="Goal"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.highGoal" AsfieldName="highGoal" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="冲刺目标" fieldType="1" inputType="8" popUpName="" width="120" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="衝刺目標"/><Display localStr="zh_CN" display="冲刺目标"/><Display localStr="en" display="Hight Goal"/></Displays><groupNames/></field><field fieldname="sum(isnull(TempGoalComplete.completes,0))" AsfieldName="complete" groupByFlag="0" displayFlag="1" condition="len(isnull(tblGoalType.name,''))!=0" conditionJoin="and" orderbyFlag="" display="已完成数" fieldType="1" inputType="0" popUpName="" width="120" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="已完成数"/><Display localStr="zh_CN" display="已完成数"/><Display localStr="en" display="Complete total"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoalDet.month" AsfieldName="month" groupByFlag="0" displayFlag="0" condition="=?" conditionJoin="and" orderbyFlag="" display="月" fieldType="0" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="月"/><Display localStr="zh_CN" display="月"/><Display localStr="en" display="Month"/></Displays><groupNames/></field><field fieldname="(case when '@Sess:Local'='zh_CN' then '部门目标明细' when '@Sess:Local'='zh_TW' then '部門目標明細' when '@Sess:Local'='en' then 'Department Detail' end)" AsfieldName="ReportDepartDet" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="操作" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="ReportDataAction.do?reportNumber=ReportGoalCompleteDeptDet&amp;DepartmentCode=@ValueofDB:DepartmentCode&amp;goalType=@ValueofDB:goalType1" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="操作"/></Displays><groupNames/></field><field fieldname="TempGoalComplete.dataSource" AsfieldName="goalType1" groupByFlag="0" displayFlag="0" condition="=?" conditionJoin="and" orderbyFlag="" display="类型" fieldType="0" inputType="1" popUpName="goalType" width="0" classCode="1" linkAdd="" order="11" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="类型"/><Display localStr="en" display="Data source"/><Display localStr="zh_TW" display="类型"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.defineGoal1" AsfieldName="defineGoal1" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="自定义1" fieldType="1" inputType="6" popUpName="" width="80" classCode="1" linkAdd="" order="12" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="自定義1"/><Display localStr="zh_CN" display="自定义1"/><Display localStr="en" display="Define1"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.defineGoal2" AsfieldName="defineGoal2" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="自定义2" fieldType="1" inputType="6" popUpName="" width="80" classCode="1" linkAdd="" order="13" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="自定義2"/><Display localStr="zh_CN" display="自定义2"/><Display localStr="en" display="Define2"/></Displays><groupNames/></field><field fieldname="tblDepartmentGoal.defineGoal3" AsfieldName="defineGoal3" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="自定义3" fieldType="1" inputType="6" popUpName="" width="80" classCode="1" linkAdd="" order="14" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="自定義3"/><Display localStr="zh_CN" display="自定义3"/><Display localStr="en" display="Define3"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblDepartment.DeptFullName as DepartmentCode,vbCrLf    tblDepartmentGoal.year as year,vbCrLf    tblGoalType.name as goalType,vbCrLf    tblDepartmentGoal.id as id,vbCrLf    tblDepartmentGoal.lowGoal as lowGoal,vbCrLf    tblDepartmentGoal.Goal as Goal,vbCrLf    tblDepartmentGoal.highGoal as highGoal,vbCrLf    sum(isnull(TempGoalComplete.completes,0)) as complete,vbCrLf    (case when '@Sess:Local'='zh_CN' then '部门目标明细' when '@Sess:Local'='zh_TW' then '部門目標明細' when '@Sess:Local'='en' then 'Department Detail' end) as ReportDepartDet,vbCrLf    tblDepartmentGoal.defineGoal1 as defineGoal1,vbCrLf    tblDepartmentGoal.defineGoal2 as defineGoal2,vbCrLf    tblDepartmentGoal.defineGoal3 as defineGoal3vbCrLffrom TempGoalCompletevbCrLfleft join tblDepartmentGoal on TempGoalComplete.DepartmentCode=tblDepartmentGoal.DepartmentCode and TempGoalComplete.Years=tblDepartmentGoal.yearvbCrLfleft join tblGoalType on  TempGoalComplete.dataSource=tblGoalType.dataType and tblGoalType.cNum= tblDepartmentGoal.goalType vbCrLfleft join tblDepartment on tblDepartment.classcode=tblDepartmentGoal.DepartmentCode vbCrLfwhere 1=1 vbCrLf      and (tblDepartment.DeptFullName =?)vbCrLf      and (tblDepartmentGoal.year =?)vbCrLf      and len(isnull(tblGoalType.name,''))!=0vbCrLf      and (tblDepartmentGoalDet.month =?)vbCrLf      and (TempGoalComplete.dataSource =?)vbCrLfgroup by vbCrLf   tblDepartment.DeptFullName,vbCrLf   tblDepartmentGoal.year,vbCrLf   tblGoalType.name,vbCrLf   tblDepartmentGoal.id,vbCrLf   tblDepartmentGoal.lowGoal,vbCrLf   tblDepartmentGoal.Goal,vbCrLf   tblDepartmentGoal.highGoal,vbCrLf   tblDepartmentGoal.defineGoal1,vbCrLf   tblDepartmentGoal.defineGoal2,vbCrLf   tblDepartmentGoal.defineGoal3vbCrLfvbCrLf  vbCrLf"/><charts/></ReportDataSource>
