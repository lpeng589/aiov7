<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="销售开票明细"/><fieldInfo><field fieldname="Total.startDate" AsfieldName="startDate" groupByFlag="0" displayFlag="1" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="单据日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≥"/><Display localStr="en" display="Document date≥"/><Display localStr="zh_TW" display="單據日期≥"/></Displays><groupNames/></field><field fieldname="Total.endDate" AsfieldName="endDate" groupByFlag="0" displayFlag="1" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="单据日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≤"/><Display localStr="en" display="Document date≤"/><Display localStr="zh_TW" display="单据日期≤"/></Displays><groupNames/></field><field fieldname="Total.classcode" AsfieldName="CompanyCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="客户" fieldType="2" inputType="2" popUpName="ReportSelectClient_v2" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="客户"/><Display localStr="en" display="Customer Name"/><Display localStr="zh_TW" display="客戶"/></Displays><groupNames/></field><field fieldname="Total.ComNumber" AsfieldName="ComNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="客户编号" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="客户编号"/><Display localStr="en" display="company No."/><Display localStr="zh_TW" display="客戶編號"/></Displays><groupNames/></field><field fieldname="Total.ComFullName" AsfieldName="ComFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="客户名称" fieldType="2" inputType="0" popUpName="" width="200" classCode="1" linkAdd="ReportDataAction.do?reportNumber=ReportSalesInvoice&amp;detTable_list=tblSalesInvoiceInfo&amp;CompanyCode=@ValueofDB:CompanyCode&amp;hide_CompanyCode=@ValueofDB:hide_CompanyCode&amp;tblCompany.ComNumber=@ValueofDB:ComNumber&amp;tblCompany.ComFullName=@ValueofDB:ComFullName&amp;BillDate1=@condition:startDate&amp;BillDate2=@condition:endDate" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="客户名称"/><Display localStr="en" display="Customer Name"/><Display localStr="zh_TW" display="客戶名稱"/></Displays><groupNames/></field><field fieldname="Total.TotalTaxAmount" AsfieldName="TotalTaxAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="应开票金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="6" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="SAmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="应开票金额"/><Display localStr="en" display="Total amount"/><Display localStr="zh_TW" display="應開票金額"/></Displays><groupNames/></field><field fieldname="Total.InvoiceAmount" AsfieldName="InvoiceAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="已开票金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="SAmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="已开票金额"/><Display localStr="en" display="Invoice amount"/><Display localStr="zh_TW" display="已開票金額"/></Displays><groupNames/></field><field fieldname="Total.NoInvoiceAmount" AsfieldName="NoInvoiceAmount1" groupByFlag="0" displayFlag="0" condition="&lt;&gt;?" conditionJoin="and" orderbyFlag="" display="未开票金额" fieldType="1" inputType="5" popUpName="zero" width="0" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="0" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="SAmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="未开票金额"/><Display localStr="en" display="Not Invoice amount"/><Display localStr="zh_TW" display="未開票金額"/></Displays><groupNames/></field><field fieldname="Total.NoInvoiceAmount" AsfieldName="NoInvoiceAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="未开票金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="9" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="SAmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="未开票金额"/><Display localStr="en" display="Not Invoice amount"/><Display localStr="zh_TW" display="未開票金額"/></Displays><groupNames/></field><field fieldname="Total.classCode+'#;#0#;##;#'" AsfieldName="hide_CompanyCode" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field></fieldInfo><SQL text="select vbCrLf    Total.startDate as startDate,vbCrLf    Total.endDate as endDate,vbCrLf    Total.classcode as CompanyCode,vbCrLf    Total.ComNumber as ComNumber,vbCrLf    Total.ComFullName as ComFullName,vbCrLf    Total.TotalTaxAmount as TotalTaxAmount,vbCrLf    Total.InvoiceAmount as InvoiceAmount,vbCrLf    Total.NoInvoiceAmount as NoInvoiceAmount,vbCrLf    Total.classCode+'#;#0#;##;#' as hide_CompanyCodevbCrLffrom (select tblCompany.classcode,@condition:startDate as startDate,(case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) as endDate,isnull(sum(b.TotalTaxAmount),0) as TotalTaxAmount,(isnull(a.InvoiceAmount,0)) as InvoiceAmount,sum(b.TotalTaxAmount)-isnull(a.InvoiceAmount,0) as NoInvoiceAmount,tblCompany.ComNumber,tblCompany.ComFullName,tblCompany.SCompanyIDvbCrLffrom tblcompany vbCrLfleft join(select sum(b.AfterChangeAmt) TotalTaxAmount,a.CompanyCode,a.workFlowNodeName,a.InVoiceType,a.BillDate from tblSalesOutStock a ,tblSalesOutStockDet b where a.id=b.f_ref and a.workFlowNodeName = 'finish' and a.SCompanyID = @Sess:SCompanyID and (a.InVoiceType=2 or a.InVoiceType=1) and a.BillDate &gt;= @condition:startDate and a.BillDate &lt;= (case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) group by a.CompanyCode,a.workFlowNodeName,a.InVoiceType,a.BillDatevbCrLfunion all select -sum(b.AfterChangeAmt) TotalTaxAmount,a.CompanyCode,a.workFlowNodeName,a.InVoiceType,a.BillDate from tblSalesReturnStock a ,tblSalesReturnStockDet b where a.id=b.f_ref and a.workFlowNodeName = 'finish' and a.SCompanyID = @Sess:SCompanyID and (a.InVoiceType=2 or a.InVoiceType=1) and a.BillDate &gt;= @condition:startDate and a.BillDate &lt;= (case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) group by a.CompanyCode,a.workFlowNodeName,a.InVoiceType,a.BillDate) b ON tblcompany.classcode=b.CompanyCodevbCrLfleft join (select  sum(tblSalesInfoDet.ExeBalAmt) InvoiceAmount,tblSalesInfoDet.companycode,tblSalesInvoiceInfo.workFlowNodeName from tblSalesInvoiceInfo join tblSalesInfoDet on tblSalesInfoDet.f_ref=tblSalesInvoiceInfo.id where tblSalesInvoiceInfo.workFlowNodeName = 'finish' and tblSalesInvoiceInfo.SCompanyID = @Sess:SCompanyID group by tblSalesInfoDet.companycode,tblSalesInvoiceInfo.workFlowNodeName) a  ON tblcompany.classcode=a.CompanyCodevbCrLfwhere (tblcompany.ClientFlag = 2 or tblcompany.ClientFlag = 3) AND (LEN(isnull(a.companycode,''))&gt;0 OR LEN(isnull(b.companycode,''))&gt;0) group by tblCompany.classcode,a.InvoiceAmount,tblCompany.ComNumber,tblCompany.ComFullName,tblCompany.SCompanyID) TotalvbCrLfwhere 1=1 vbCrLf      and (Total.startDate &gt;=?)vbCrLf      and (Total.endDate &lt;=?)vbCrLf      and (Total.classcode =?)vbCrLf      and (Total.NoInvoiceAmount &lt;&gt;?)vbCrLfvbCrLfvbCrLfvbCrLf"/><charts/></ReportDataSource>
