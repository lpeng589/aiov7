<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName=""/><fieldInfo><field fieldname="substring(tblDeskClerk.IntendComeTime,1,10)" AsfieldName="startDate" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="开始日期≥" fieldType="6" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="开始日期≥"/><Display localStr="en" display="start Date≥"/><Display localStr="zh_TW" display="開始日期≥"/></Displays><groupNames/></field><field fieldname="substring(tblDeskClerk.IntendComeTime,1,10)" AsfieldName="endDate" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="结束日期≤" fieldType="6" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="结束日期≤"/><Display localStr="en" display="end Date≤"/><Display localStr="zh_TW" display="結束日期≤"/></Displays><groupNames/></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="100" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department"/><Display localStr="zh_TW" display="部門"/></Displays><groupNames/></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="100" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="职员"/><Display localStr="en" display="Employee"/><Display localStr="zh_TW" display="職員"/></Displays><groupNames/></field><field fieldname="k.ComNum" AsfieldName="CompanyCode" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="看样客户数量" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="看样客户数量"/><Display localStr="en" display="No. of Customer"/><Display localStr="zh_TW" display="看樣客戶數量"/></Displays><groupNames/></field><field fieldname="m.ContractNum" AsfieldName="ContractNum" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="签约数量" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="签约数量"/><Display localStr="en" display="No. of Contract"/><Display localStr="zh_TW" display="簽約數量"/></Displays><groupNames/></field><field fieldname="replace(cast(dbo.getdigits('tblStockDet','lastPrice',(case k.ComNum when 0 then 0 else m.ContractNum/k.ComNum end))*100 as varchar(100))+'%','0%','')" AsfieldName="ContractRate" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="降" display="签约比例" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="签约比例"/><Display localStr="en" display="%"/><Display localStr="zh_TW" display="簽約比例"/></Displays><groupNames/></field><field fieldname="replace(cast(dbo.getdigits('tblStockDet','lastPrice',(case u.EmpNum when 0 then 0 else (case k.ComNum when 0 then 0 else m.ContractNum/k.ComNum end)/u.EmpNum end))*100 as varchar(100))+'%','0%','')" AsfieldName="AvgRate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="平均比例" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="平均比例"/><Display localStr="en" display="Avg %"/></Displays><groupNames/></field><field fieldname="'看样明细'" AsfieldName="Detail" groupByFlag="0" displayFlag="1" condition="tblDeskClerk.workFlowNodeName='finish'" conditionJoin="and" orderbyFlag="" display="看样明细" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="ReportDataAction.do?reportNumber=CRMFinishSampleDetail&amp;startDate=@condition:startDate&amp;endDate=@condition:endDate&amp;DeptFullName=@ValueofDB:DeptFullName&amp;EmpFullName=@ValueofDB:EmpFullName" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="看样明细"/><Display localStr="en" display="Sample Detail"/><Display localStr="zh_TW" display="看樣明細"/></Displays><groupNames/></field><field fieldname="u.EmpNum" AsfieldName="EmpNum" groupByFlag="1" displayFlag="0" condition="" conditionJoin="" orderbyFlag="" display="职员数量" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="职员数量"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    k.ComNum as CompanyCode,vbCrLf    m.ContractNum as ContractNum,vbCrLf    replace(cast(dbo.getdigits('tblStockDet','lastPrice',(case k.ComNum when 0 then 0 else m.ContractNum/k.ComNum end))*100 as varchar(100))+'%','0%','') as ContractRate,vbCrLf    replace(cast(dbo.getdigits('tblStockDet','lastPrice',(case u.EmpNum when 0 then 0 else (case k.ComNum when 0 then 0 else m.ContractNum/k.ComNum end)/u.EmpNum end))*100 as varchar(100))+'%','0%','') as AvgRate,vbCrLf    '看样明细' as DetailvbCrLffrom tblDeskClerkvbCrLfleft join tblEmployee on tblEmployee.id=tblDeskClerk.EmployeeIDvbCrLfleft join tblDepartment on tblDepartment.classCode=tblEmployee.DepartmentCodevbCrLfleft join (select EmployeeID,count(CompanyCode) as ComNum from tblDeskClerk where vbCrLfsubstring(tblDeskClerk.IntendComeTime,1,10)&gt;=(case @condition:startDate when '' then '0001-01-01' else @condition:startDate end)vbCrLfand substring(tblDeskClerk.IntendComeTime,1,10)&lt;=(case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) vbCrLfgroup by EmployeeID) k on k.EmployeeID=tblDeskClerk.EmployeeIDvbCrLfleft join (select EmployeeID,count(ClientId) as ContractNum from CRMSaleContract where vbCrLfCRMSaleContract.SignUpDate&gt;=(case @condition:startDate when '' then '0001-01-01' else @condition:startDate end)vbCrLfand CRMSaleContract.SignUpDate&lt;=(case @condition:endDate when '' then '9999-12-31' else @condition:endDate end) vbCrLfgroup by EmployeeID) m on m.EmployeeID=tblDeskClerk.EmployeeIDvbCrLfleft join (select count(n.EmployeeID) as EmpNum from (select distinct EmployeeID from tblDeskClerk a where substring(a.IntendComeTime,1,10) &gt;=(case @condition:startDate when '' then '0001-01-01' else @condition:startDate end) vbCrLfand substring(a.IntendComeTime,1,10)&lt;=(case @condition:endDate when '' then '9999-12-31' else @condition:endDate end)) n) u on 1=1vbCrLfwhere 1=1 vbCrLf      and (substring(tblDeskClerk.IntendComeTime,1,10) &gt;=?)vbCrLf      and (substring(tblDeskClerk.IntendComeTime,1,10) &lt;=?)vbCrLf      and (tblDepartment.DeptFullName like '%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLf      and tblDeskClerk.workFlowNodeName='finish'vbCrLfgroup by vbCrLf   tblDepartment.DeptFullName,vbCrLf   tblEmployee.EmpFullName,vbCrLf   k.ComNum,vbCrLf   m.ContractNum,vbCrLf   replace(cast(dbo.getdigits('tblStockDet','lastPrice',(case k.ComNum when 0 then 0 else m.ContractNum/k.ComNum end))*100 as varchar(100))+'%','0%',''),vbCrLf   u.EmpNumvbCrLforder by vbCrLf   replace(cast(dbo.getdigits('tblStockDet','lastPrice',(case k.ComNum when 0 then 0 else m.ContractNum/k.ComNum end))*100 as varchar(100))+'%','0%','') descvbCrLf  vbCrLf"/><charts/></ReportDataSource>
