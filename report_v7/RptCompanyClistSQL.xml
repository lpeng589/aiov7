<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="客户往来统计"/><fieldInfo><field fieldname="'startDate1'" AsfieldName="startDate" groupByFlag="0" displayFlag="0" condition="=? or 1=1" conditionJoin="and" orderbyFlag="" display="单据日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@MEM:defaultTime" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≥"/><Display localStr="en" display="Billdate"/><Display localStr="zh_TW" display="单据日期≥"/></Displays><groupNames/></field><field fieldname="'endDate2'" AsfieldName="endDate" groupByFlag="0" displayFlag="0" condition="=? or 1=1" conditionJoin="and" orderbyFlag="" display="单据日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≤"/><Display localStr="en" display="BillDate≤"/><Display localStr="zh_TW" display="單據日期≤"/></Displays><groupNames/></field><field fieldname="tblCompany.[tblCompany_2]" AsfieldName="ComNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="升" display="单位编号" fieldType="2" inputType="0" popUpName="" width="130" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="单位编号"/><Display localStr="en" display="Company No."/><Display localStr="zh_TW" display="單據編號"/></Displays><groupNames/></field><field fieldname="tblCompany.ClientFlag" AsfieldName="ClientFlag" groupByFlag="0" displayFlag="1" condition="(tblCompany.ClientFlag=2 or tblCompany.ClientFlag=3)" conditionJoin="and" orderbyFlag="" display="单位类型" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单位类型"/><Display localStr="en" display="type"/><Display localStr="zh_TW" display="單位類型"/></Displays><groupNames/></field><field fieldname="tblCompany.SCompanyID" AsfieldName="SCompanyID" groupByFlag="0" displayFlag="1" condition="=@Sess:SCompanyID" conditionJoin="and" orderbyFlag="" display="分支机构" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="分支机构"/><Display localStr="en" display="Branch"/><Display localStr="zh_TW" display="分支機搆"/></Displays><groupNames/></field><field fieldname="'Currency'" AsfieldName="Currency" groupByFlag="0" displayFlag="1" condition="=? or 1=1" conditionJoin="and" orderbyFlag="" display="币种" fieldType="2" inputType="2" popUpName="ReportSelectCurrency_v2" width="-1" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="currency" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="币种"/><Display localStr="zh_CN" display="币种"/><Display localStr="en" display="Currency type"/></Displays><groupNames/></field><field fieldname="tblCompany.ClassCode" AsfieldName="CompanyCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="  " display="客户" fieldType="2" inputType="2" popUpName="ReportSelectClient_v2" width="-1" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="客户"/><Display localStr="en" display="Related company code"/><Display localStr="zh_TW" display="往來單位代碼"/></Displays><groupNames/></field><field fieldname="isnull(b.PreReceiveIni,0)" AsfieldName="PreReceiveBegin" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="上期预收" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="上期预收"/><Display localStr="en" display="Deposit received b/f"/><Display localStr="zh_TW" display="上期預收"/></Displays><groupNames/></field><field fieldname="isnull(b.ReceiveIni,0)" AsfieldName="ReceiveBegin" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="上期应收" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="9" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="上期应收"/><Display localStr="en" display="Receivable b/f"/><Display localStr="zh_TW" display="上期應收"/></Displays><groupNames/></field><field fieldname="isnull(b.ReceiveIni,0)-isnull(b.PreReceiveIni,0)" AsfieldName="TotalReceiveBegin" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="上期余额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="10" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="上期余额"/><Display localStr="en" display="Balance"/><Display localStr="zh_TW" display="上期餘額"/></Displays><groupNames/></field><field fieldname="isnull(c.CurrPreReceive,0)" AsfieldName="PreReceiveTotalLend" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="预收金额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="11" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="本期发生" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="预收金额"/><Display localStr="en" display="Deposit received"/><Display localStr="zh_TW" display="預收金額"/></Displays><groupNames><Display localStr="zh_CN" display="本期发生"/><Display localStr="en" display="Current Period"/><Display localStr="zh_TW" display="本期發生"/></groupNames></field><field fieldname="isnull(c.CurrReceive,0)" AsfieldName="ReceiveTotalDebit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="应收金额" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="12" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="本期发生" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="应收金额"/><Display localStr="en" display="Receivable"/><Display localStr="zh_TW" display="應收金额"/></Displays><groupNames><Display localStr="zh_CN" display="本期发生"/><Display localStr="en" display="Current Period"/><Display localStr="zh_TW" display="本期發生"/></groupNames></field><field fieldname="isnull(c.CurrFactReceive,0)" AsfieldName="ReceiveTotalLend" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="实收金额" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="13" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="本期发生" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="实收金额"/><Display localStr="en" display="Receipt"/><Display localStr="zh_TW" display="實收金額"/></Displays><groupNames><Display localStr="zh_CN" display="本期发生"/><Display localStr="en" display="Current Period"/><Display localStr="zh_TW" display="本期發生"/></groupNames></field><field fieldname="isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0)" AsfieldName="PreReceiveBal" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="预收余额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="14" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="预收余额"/><Display localStr="en" display="Deposit received c/f"/><Display localStr="zh_TW" display="預收餘額"/></Displays><groupNames/></field><field fieldname="isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)" AsfieldName="ReceiveBal" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="应收余额" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="15" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="应收余额"/><Display localStr="en" display="Receivable c/f"/><Display localStr="zh_TW" display="應收餘額"/></Displays><groupNames/></field><field fieldname="isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0))" AsfieldName="ReceiveTotalRemain" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="期末余额" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="16" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="期末余额"/><Display localStr="en" display="Balance"/><Display localStr="zh_TW" display="期末餘額"/></Displays><groupNames/></field><field fieldname="isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0))" AsfieldName="TotalRemain" groupByFlag="0" displayFlag="1" condition="&lt;&gt; ?" conditionJoin="and" orderbyFlag="" display="余额" fieldType="1" inputType="5" popUpName="zero" width="0" classCode="1" linkAdd="" order="17" isStat="0" defaultValue="0" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Amount" analysis="0"><Displays><Display localStr="zh_CN" display="余额"/><Display localStr="en" display="totalAmount"/><Display localStr="zh_TW" display="餘額"/></Displays><groupNames/></field><field fieldname="(case when '@Sess:Local'='zh_CN' then '应收明细' when '@Sess:Local'='zh_TW' then '應收明細' when '@Sess:Local'='en' then 'Customer Check Detail' end)" AsfieldName="ReportCompanyCDet" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="操作" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="ReportDataAction.do?reportNumber=@ValueofDB:reportName1&amp;hide_CompanyCode=@ValueofDB:hidCode&amp;tblCompany.ComFullName=@ValueofDB:ComFullName&amp;CompanyCode=@ValueofDB:CompanyCode&amp;Currency=@condition:Currency&amp;startDate=@condition:startDate&amp;endDate=@condition:endDate&amp;TotalReceive1=0&amp;mainNumber=RptCompanyC" order="18" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="操作"/></Displays><groupNames/></field><field fieldname="(case when '@Sess:Local'='zh_CN' then '应收对账' when '@Sess:Local'='zh_TW' then '應收對賬' when '@Sess:Local'='en' then 'Customer Check Detail' end)" AsfieldName="ReportCompanyCln" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="操作" fieldType="2" inputType="0" popUpName="" width="90" classCode="1" linkAdd="ReportDataAction.do?reportNumber=@ValueofDB:reportName&amp;hide_CompanyCode=@ValueofDB:hidCode&amp;tblCompany.ComFullName=@ValueofDB:ComFullName&amp;CompanyCode=@ValueofDB:CompanyCode&amp;Currency=@condition:Currency&amp;startDate=@condition:startDate&amp;endDate=@condition:endDate&amp;ClientFlag=@ValueofDB:ClientFlag&amp;mainNumber=RptCompanyC" order="19" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="操作"/><Display localStr="en" display="operation"/><Display localStr="zh_TW" display="操作"/></Displays><groupNames/></field><field fieldname="tblCompany.isCatalog" AsfieldName="isCatalog" groupByFlag="0" displayFlag="1" condition="=0" conditionJoin="and" orderbyFlag="" display="isCatalog" fieldType="0" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="20" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="isCatalog"/><Display localStr="zh_CN" display="isCatalog"/><Display localStr="en" display="isCatalog"/></Displays><groupNames/></field><field fieldname="tblCompany.classCode" AsfieldName="classCode" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="分类代码" fieldType="2" inputType="100" popUpName="0" width="-1" classCode="1" linkAdd="" order="21" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="分類代碼"/><Display localStr="zh_CN" display="分类代码"/><Display localStr="en" display="Category code"/></Displays><groupNames/></field><field fieldname="(case when tblCompany.ClientFlag=3 then 'ComCheckClientProvider' else 'ComCheckClient' end)" AsfieldName="reportName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="22" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="(case when tblCompany.ClientFlag=3 then 'ReportCompanyCG' else 'ReportCompanyCln' end)" AsfieldName="reportName1" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="23" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="tblCompany.classCode+'#;#'+cast(tblCompany.isCatalog as  varchar(10))+'#;##;#'" AsfieldName="hidCode" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="24" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0)" AsfieldName="Credit" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="信用额度" fieldType="1" inputType="6" popUpName="" width="110" classCode="1" linkAdd="" order="25" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="信用額度"/><Display localStr="zh_CN" display="信用额度"/><Display localStr="en" display="Credit amount"/></Displays><groupNames/></field><field fieldname="(tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))" AsfieldName="HideCredit" groupByFlag="0" displayFlag="0" condition="&lt;(isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0))) and (tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))&gt;0 and ?&lt;&gt;100" conditionJoin="and" orderbyFlag="" display="信用额度" fieldType="2" inputType="5" popUpName="RecvTotalRemainOverCredit" width="0" classCode="1" linkAdd="" order="26" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="信用額度"/><Display localStr="zh_CN" display="信用额度"/><Display localStr="en" display="Credit amount"/></Displays><groupNames/></field><field fieldname="tblCompany.workFlowNodeName" AsfieldName="workFlowNodeName" groupByFlag="0" displayFlag="0" condition="='finish'" conditionJoin="and" orderbyFlag="" display="workFlowNodeName" fieldType="2" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="27" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="workFlowNodeName"/><Display localStr="zh_CN" display="workFlowNodeName"/><Display localStr="en" display="workFlowNodeName"/></Displays><groupNames/></field><field fieldname="tblCompany.statusId" AsfieldName="statusId" groupByFlag="0" displayFlag="0" condition="" conditionJoin="  " orderbyFlag="" display="状态" fieldType="0" inputType="100" popUpName="" width="0" classCode="1" linkAdd="" order="28" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="狀態"/><Display localStr="zh_CN" display="状态"/><Display localStr="en" display="Status"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblCompany.[tblCompany_2] as ComNumber,vbCrLf    tblCompany.ClientFlag as ClientFlag,vbCrLf    tblCompany.SCompanyID as SCompanyID,vbCrLf    'Currency' as Currency,vbCrLf    tblCompany.ClassCode as CompanyCode,vbCrLf    isnull(b.PreReceiveIni,0) as PreReceiveBegin,vbCrLf    isnull(b.ReceiveIni,0) as ReceiveBegin,vbCrLf    isnull(b.ReceiveIni,0)-isnull(b.PreReceiveIni,0) as TotalReceiveBegin,vbCrLf    isnull(c.CurrPreReceive,0) as PreReceiveTotalLend,vbCrLf    isnull(c.CurrReceive,0) as ReceiveTotalDebit,vbCrLf    isnull(c.CurrFactReceive,0) as ReceiveTotalLend,vbCrLf    isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0) as PreReceiveBal,vbCrLf    isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0) as ReceiveBal,vbCrLf    isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0)) as ReceiveTotalRemain,vbCrLf    isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0)) as TotalRemain,vbCrLf    (case when '@Sess:Local'='zh_CN' then '应收明细' when '@Sess:Local'='zh_TW' then '應收明細' when '@Sess:Local'='en' then 'Customer Check Detail' end) as ReportCompanyCDet,vbCrLf    (case when '@Sess:Local'='zh_CN' then '应收对账' when '@Sess:Local'='zh_TW' then '應收對賬' when '@Sess:Local'='en' then 'Customer Check Detail' end) as ReportCompanyCln,vbCrLf    tblCompany.isCatalog as isCatalog,vbCrLf    tblCompany.classCode as classCode,vbCrLf    (case when tblCompany.ClientFlag=3 then 'ComCheckClientProvider' else 'ComCheckClient' end) as reportName,vbCrLf    (case when tblCompany.ClientFlag=3 then 'ReportCompanyCG' else 'ReportCompanyCln' end) as reportName1,vbCrLf    tblCompany.classCode+'#;#'+cast(tblCompany.isCatalog as  varchar(10))+'#;##;#' as hidCode,vbCrLf    tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0) as CreditvbCrLffrom tblCompany vbCrLfleft join(vbCrLf    select a.classCode companyCode,vbCrLf           (case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcPreRecTotalRemain,0)) else sum(isnull(tblCompanyIni.PreReceiveTotalRemain,0)) end) as PreReceiveIni,vbCrLf           (case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcRecTotalRemain,0)) else sum(isnull(tblCompanyIni.ReceiveTotalRemain,0)) end) as ReceiveIni vbCrLf    from tblCompany a vbCrLf    left join tblCompanyIni on tblCompanyIni.id=(select top 1 id from tblCompanyIni k where tblCompanyIni.CompanyCode=k.CompanyCode and BillDate&lt;@condition:startDate and ((case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)!=@conditionv2:Currency then k.Currency else '-99999' end) else '-99999' end)=@conditionv2:Currency or (case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)=@conditionv2:Currency then k.Currency else '-99999' end) else '-99999' end)='' or (case when len(@conditionv2:Currency)=0 then '' else '-99999' end)='') ORDER BY ItemNo desc) vbCrLf           and tblCompanyIni.CompanyCode like a.classCode+'%' vbCrLf    where ((case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)!=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)=@conditionv2:Currency or (case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)='' or (case when len(@conditionv2:Currency)=0 then '' else '-99999' end)='')  vbCrLf    group by a.classCodevbCrLf) as b on b.CompanyCode=tblCompany.classCodevbCrLfleft join (vbCrLf    select a.classCode CompanyCode,(case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcPreRecTotalCredit,0))-sum(isnull(tblCompanyIni.FcPreRecTotalDebit,0)) else sum(isnull(tblCompanyIni.PreReceiveTotalLend,0))-sum(isnull(tblCompanyIni.PreReceiveTotalDebit,0)) end) as CurrPreReceive,vbCrLf          (case when len(@conditionv2:Currency)&gt;0 then sum(isnull(tblCompanyIni.FcRecTotalDebit,0)) else sum(isnull(tblCompanyIni.ReceiveTotalDebit,0)) end) as CurrReceive,(case when len(@conditionv2:Currency)&gt;0 then  sum(isnull(tblCompanyIni.FcRecTotalCredit,0)) else sum(isnull(tblCompanyIni.ReceiveTotalLend,0)) end) as CurrFactReceive vbCrLf    from tblCompany a vbCrLf    left join tblCompanyIni on tblCompanyIni.BillDate&gt;=@condition:startDate and ((len(@condition:endDate)=0 and tblCompanyIni.BillDate&lt;='9999-12-31') or tblCompanyIni.BillDate&lt;=@condition:endDate) and tblCompanyIni.CompanyCode like a.classCode+'%' where ((case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)!=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)=@conditionv2:Currency or (case when len(@conditionv2:Currency)&gt;0 then (case when (select id from tblCurrency where IsBaseCurrency=1)=@conditionv2:Currency then tblCompanyIni.Currency else '-99999' end) else '-99999' end)='' or (case when len(@conditionv2:Currency)=0 then '' else '-99999' end)='') vbCrLf    group by a.classCodevbCrLf) as c on c.CompanyCode=tblCompany.classCode vbCrLfLEFT JOIN(select sum(Credit) as Credit,CompanyCode from tblTempCreditApply noright where workFlowNodeName='finish' group by CompanyCode)tblTempCreditApply ON  tblCompany.classCode = tblTempCreditApply.CompanyCodevbCrLfwhere 1=1 vbCrLf      and ('startDate1' =? or 1=1)vbCrLf      and ('endDate2' =? or 1=1)vbCrLf      and (tblCompany.ClientFlag=2 or tblCompany.ClientFlag=3)vbCrLf      and (tblCompany.SCompanyID =@Sess:SCompanyID)vbCrLf      and ('Currency' =? or 1=1)vbCrLf      and (tblCompany.ClassCode =?)vbCrLf      and (isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0)) &lt;&gt; ?)vbCrLf      and (tblCompany.isCatalog =0)vbCrLf      and ((tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0)) &lt;(isnull(b.ReceiveIni,0)+isnull(c.CurrReceive,0)-isnull(c.CurrFactReceive,0)-(isnull(b.PreReceiveIni,0)+isnull(c.CurrPreReceive,0))) and (tblCompany.Credit+ISNULL(tblTempCreditApply.Credit ,0))&gt;0 and ?&lt;&gt;100)vbCrLf      and (tblCompany.workFlowNodeName ='finish')vbCrLfvbCrLforder by vbCrLf   tblCompany.[tblCompany_2] vbCrLfvbCrLf"/><charts/></ReportDataSource>
