<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="客户投诉"/><fieldInfo><field fieldname="CRMcomplaints.BillNo" AsfieldName="BillNo" groupByFlag="0" displayFlag="1" condition="like'%'+?+'%'" conditionJoin="and" orderbyFlag="降" display="Document No." fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="UserFunctionAction.do?tableName=CRMcomplaints&amp;parentTableName=CRMClientInfo&amp;keyId=@ValueofDB:id&amp;operation=5" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="單據編號"/><Display localStr="zh_CN" display="单据编号"/><Display localStr="en" display="Document No."/></Displays><groupNames/></field><field fieldname="CRMcomplaints.BillDate" AsfieldName="BillDate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="降" display="Document date" fieldType="5" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="單據日期"/><Display localStr="zh_CN" display="单据日期"/><Display localStr="en" display="Document date"/></Displays><groupNames/></field><field fieldname="CRMClientInfo.ClientName" AsfieldName="CompanyName" groupByFlag="0" displayFlag="1" condition="like'%'+?+'%'" conditionJoin="and" orderbyFlag="" display="Customer name" fieldType="18" inputType="2" popUpName="ReportSelectCRMClient" width="200" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="客戶名稱"/><Display localStr="zh_CN" display="客户名称"/><Display localStr="en" display="Customer name"/></Displays><groupNames/></field><field fieldname="CRMcomplaints.ComplaintType" AsfieldName="ComplaintType" groupByFlag="0" displayFlag="1" condition="like'%'+?+'%'" conditionJoin="and" orderbyFlag="" display="Complaint Type" fieldType="2" inputType="1" popUpName="ComplaintType" width="80" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="投訴類型"/><Display localStr="zh_CN" display="投诉类型"/><Display localStr="en" display="Complaint Type"/></Displays><groupNames/></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="0" displayFlag="1" condition="like'%'+?+'%'" conditionJoin="and" orderbyFlag="" display="投訴對象" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="80" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="投诉对象"/><Display localStr="en" display="Staff"/><Display localStr="zh_TW" display="投訴對象"/></Displays><groupNames/></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="投訴部門" fieldType="2" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="投诉部门"/><Display localStr="en" display="Department"/><Display localStr="zh_TW" display="投訴部門"/></Displays><groupNames/></field><field fieldname="CRMcomplaints.ComplaintsViscera" AsfieldName="ComplaintsViscera" groupByFlag="0" displayFlag="1" condition="like'%'+?+'%'" conditionJoin="and" orderbyFlag="" display="Complaints Viscera" fieldType="16" inputType="0" popUpName="" width="200" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="投訴内容"/><Display localStr="zh_CN" display="投诉内容"/><Display localStr="en" display="Complaints Viscera"/></Displays><groupNames/></field><field fieldname="CRMcomplaints.BillDate" AsfieldName="SBillDate" groupByFlag="0" displayFlag="1" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="Document date≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="投诉日期≥"/><Display localStr="en" display="Document date≥"/><Display localStr="zh_TW" display="投訴日期≥"/></Displays><groupNames/></field><field fieldname="CRMcomplaints.BillDate" AsfieldName="EBillDate" groupByFlag="0" displayFlag="1" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="Document date≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="投诉日期≤"/><Display localStr="en" display="Document date≤"/><Display localStr="zh_TW" display="投訴日期≤"/></Displays><groupNames/></field><field fieldname="CRMcomplaints.id" AsfieldName="id" groupByFlag="0" displayFlag="1" condition="(exists(select * from tblEmpDistrict a left join tblEmpDistrictDet b on b.f_ref=a.id where a.EmployeeID='@Sess:UserId' and b.BusinessDistrict=CRMClientInfo.BusinessDistrict) or '@Sess:UserId'='1' or '@MEM:ManageDistrict'='false') and CRMClientInfo.statusId=0 and CRMClientInfo.Status!=1 and (CRMClientInfoEmp.EmployeeID='@Sess:UserId' or '@Sess:UserId'='1')" conditionJoin="and" orderbyFlag="" display="" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="CRMcomplaints.f_brother" AsfieldName="f_brother" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="11" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field></fieldInfo><SQL text="select vbCrLf    CRMcomplaints.BillNo as BillNo,vbCrLf    CRMcomplaints.BillDate as BillDate,vbCrLf    CRMClientInfo.ClientName as CompanyName,vbCrLf    CRMcomplaints.ComplaintType as ComplaintType,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    CRMcomplaints.ComplaintsViscera as ComplaintsViscera,vbCrLf    CRMcomplaints.BillDate as SBillDate,vbCrLf    CRMcomplaints.BillDate as EBillDate,vbCrLf    CRMcomplaints.id as id,vbCrLf    CRMcomplaints.f_brother as f_brothervbCrLffrom CRMcomplaintsvbCrLfleft join tblEmployee on tblEmployee.id=CRMcomplaints.EmployeeIDvbCrLfleft join tblDepartment on tblDepartment.classCode=CRMcomplaints.DepartmentCodevbCrLfleft join CRMClientInfo on CRMClientInfo.id=CRMcomplaints.ClientIdvbCrLfleft join CRMClientInfoEmp on CRMClientInfo.id=CRMClientInfoEmp.f_refvbCrLfwhere 1=1 vbCrLf      and (CRMcomplaints.BillNo like'%'+?+'%')vbCrLf      and (CRMClientInfo.ClientName like'%'+?+'%')vbCrLf      and (CRMcomplaints.ComplaintType like'%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName like'%'+?+'%')vbCrLf      and (CRMcomplaints.ComplaintsViscera like'%'+?+'%')vbCrLf      and (CRMcomplaints.BillDate &gt;=?)vbCrLf      and (CRMcomplaints.BillDate &lt;=?)vbCrLf      and (exists(select * from tblEmpDistrict a left join tblEmpDistrictDet b on b.f_ref=a.id where a.EmployeeID='@Sess:UserId' and b.BusinessDistrict=CRMClientInfo.BusinessDistrict) or '@Sess:UserId'='1' or '@MEM:ManageDistrict'='false') and CRMClientInfo.statusId=0 and CRMClientInfo.Status!=1 and (CRMClientInfoEmp.EmployeeID='@Sess:UserId' or '@Sess:UserId'='1')vbCrLfvbCrLforder by vbCrLf   CRMcomplaints.BillDate desc,vbCrLf   CRMcomplaints.BillNo descvbCrLfvbCrLf  vbCrLf"/><charts/></ReportDataSource>
