<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="当前库存明细"/><fieldInfo><field fieldname="M.seq" AsfieldName="Seq" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="降" display="序列号" fieldType="2" inputType="0" popUpName="" width="150" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="序列号"/></Displays><groupNames/></field><field fieldname="(case when isnull((select sum(TotalQty) from tblstockDet k where k.seq=SI.seq and k.GoodsCode=SI.GoodsCode and lastMarker=1 and k.BillType='tblSalesReturnStock'),0)&gt;0 then '3' when isnull((select sum(TotalQty) from tblstockDet k where k.seq=SI.seq and k.GoodsCode=SI.GoodsCode and lastMarker=1 and k.BillType!='tblSalesReturnStock'),0)&gt;0  then '1' else '2' end)" AsfieldName="OutInStock" groupByFlag="0" displayFlag="1" condition="= ?" conditionJoin="and" orderbyFlag="" display="目前状态" fieldType="2" inputType="1" popUpName="OutInStock" width="80" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="目前状态"/></Displays><groupNames/></field><field fieldname="SI.GoodsCode" AsfieldName="GoodsCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="商品代码" fieldType="2" inputType="2" popUpName="ReportSelectGoods_v2" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="商品代码"/></Displays><groupNames/></field><field fieldname="tblGoods.[tblGoods]" AsfieldName="GoodsNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="升" display="商品编号" fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="商品编号"/></Displays><groupNames/></field><field fieldname="SI.[GOODSPROP]" AsfieldName="BatchNo" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="  " display="批号" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="GoodsField" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="批号"/><Display localStr="en" display="Commodity name"/><Display localStr="zh_TW" display="商品名稱"/></Displays><groupNames/></field><field fieldname="SI.InstoreQty" AsfieldName="qty" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="数量" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="数量"/></Displays><groupNames/></field><field fieldname="SI.instorePrice" AsfieldName="instorePrice" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="成本单价" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="priceIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="成本单价"/></Displays><groupNames/></field><field fieldname="case when SI.BillDate='-1' then '期初' else SI.BillDate end " AsfieldName="SIBillDate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="入库日期" fieldType="5" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库日期"/></Displays><groupNames/></field><field fieldname="SI.BillDate" AsfieldName="SIBillDates" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="入库日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库日期≥"/></Displays><groupNames/></field><field fieldname="SI.BillDate" AsfieldName="SIBillDatee" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="入库日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库日期≤"/></Displays><groupNames/></field><field fieldname="case when SI.Billtype='tblStockdet' then '期初' else SITable.languageId end" AsfieldName="SILanguageId" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="入库类型" fieldType="2" inputType="4" popUpName="" width="80" classCode="1" linkAdd="" order="11" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库类型"/></Displays><groupNames/></field><field fieldname="SI.BillNo" AsfieldName="SIBillNo" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="入库单号" fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="UserFunctionAction.do?tableName=@ValueofDB:SIBillType&amp;keyId=@ValueofDB:SIBillID&amp;operation=5" order="12" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库单号"/></Displays><groupNames/></field><field fieldname="SI.StockCode" AsfieldName="inStockCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="仓库代码" fieldType="2" inputType="2" popUpName="ReportSelectInStock_v2" width="0" classCode="1" linkAdd="" order="13" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="仓库代码"/></Displays><groupNames/></field><field fieldname="tblStock.StockFullName" AsfieldName="SIStockFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="升" display="入库仓库" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="14" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库仓库"/></Displays><groupNames/></field><field fieldname="SICompany.classCode" AsfieldName="CompanyCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="入库往来" fieldType="2" inputType="2" popUpName="ReportSelectProvider_v2" width="0" classCode="1" linkAdd="" order="15" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="入库往来"/></Displays><groupNames/></field><field fieldname="SICompany.ComNumber" AsfieldName="SIComNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="入库往来编号" fieldType="2" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="16" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库往来编号"/></Displays><groupNames/></field><field fieldname="SICompany.ComFullName" AsfieldName="SIComFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="入库往来" fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="" order="17" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Supplier" analysis="0"><Displays><Display localStr="zh_CN" display="入库往来"/></Displays><groupNames/></field><field fieldname="SO.salesPrice" AsfieldName="outstorePrice" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="出库单价" fieldType="1" inputType="0" popUpName="" width="80" classCode="1" linkAdd="" order="18" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="AmountIdentifier" analysis="0"><Displays><Display localStr="zh_CN" display="出库单价"/></Displays><groupNames/></field><field fieldname="SO.BillDate" AsfieldName="SOBillDate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="出库日期" fieldType="5" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="19" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库日期"/></Displays><groupNames/></field><field fieldname="SO.BillDate" AsfieldName="SOBillDates" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="出库日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="20" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库日期≥"/></Displays><groupNames/></field><field fieldname="SO.BillDate" AsfieldName="SOBillDatee" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="出库日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="21" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库日期≤"/></Displays><groupNames/></field><field fieldname="case when SO.Billtype='tblStockdet' then '期初' else SOTable.languageId end" AsfieldName="SOlanguageId" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="出库类型" fieldType="2" inputType="4" popUpName="" width="90" classCode="1" linkAdd="" order="22" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库类型"/></Displays><groupNames/></field><field fieldname="SO.BillNo" AsfieldName="SOBillNo" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="出库单号" fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="UserFunctionAction.do?tableName=@ValueofDB:SOBillType&amp;keyId=@ValueofDB:SOBillID&amp;operation=5" order="23" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库单号"/></Displays><groupNames/></field><field fieldname="outStock.classCode" AsfieldName="outStockCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="出库仓库" fieldType="2" inputType="2" popUpName="ReportSelectOutStock_v2" width="0" classCode="1" linkAdd="" order="24" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库仓库"/></Displays><groupNames/></field><field fieldname="outStock.StockFullName" AsfieldName="SOStockFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="出库仓库" fieldType="2" inputType="0" popUpName="" width="120" classCode="1" linkAdd="" order="25" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库仓库"/></Displays><groupNames/></field><field fieldname="SOCompany.classCode" AsfieldName="OutCompanyCode" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="" display="客户" fieldType="2" inputType="2" popUpName="ReportSelectOutCom_v2" width="0" classCode="1" linkAdd="" order="26" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="客户"/></Displays><groupNames/></field><field fieldname="SOCompany.ComNumber" AsfieldName="SOComNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="客户编号" fieldType="2" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="27" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="客户编号"/></Displays><groupNames/></field><field fieldname="SOCompany.ComFullName" AsfieldName="SOComFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="客户" fieldType="2" inputType="0" popUpName="" width="200" classCode="1" linkAdd="" order="28" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="Customer" analysis="0"><Displays><Display localStr="zh_CN" display="客户"/></Displays><groupNames/></field><field fieldname="sourcecom.ComNumber" AsfieldName="sourcecomNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="货源编号" fieldType="2" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="29" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="货源编号"/></Displays><groupNames/></field><field fieldname="sourcecom.ComFullName" AsfieldName="SourceComFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="货源" fieldType="2" inputType="6" popUpName="ReportSelectSupplier" width="100" classCode="1" linkAdd="" order="30" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="货源"/></Displays><groupNames/></field><field fieldname="SI.BillID" AsfieldName="SIBillID" groupByFlag="0" displayFlag="1" condition="" conditionJoin="  " orderbyFlag="" display="入库单据ID" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="31" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库单据ID"/></Displays><groupNames/></field><field fieldname="SI.BillType" AsfieldName="SIBillType" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="入库单据类型" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="32" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="入库单据类型"/><Display localStr="zh_TW" display="单据类型"/></Displays><groupNames/></field><field fieldname="SO.BillID" AsfieldName="SOBillID" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="出库单据ID" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="33" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库单据ID"/></Displays><groupNames/></field><field fieldname="SO.BillType" AsfieldName="SOBillType" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="出库单据类型" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="34" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="出库单据类型"/></Displays><groupNames/></field><field fieldname="(select modelName from tblModules where linkAddress='/ReportDataAction.do?reportNumber=ReportSeqGoods' and tblName='ReportSeqGoods')" AsfieldName="Link" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="序列号跟踪" fieldType="2" inputType="4" popUpName="" width="80" classCode="1" linkAdd="ReportDataAction.do?reportNumber=ReportSeqGoods&amp;GoodsCode=@ValueofDB:GoodsCode&amp;GoodsNumber=@ValueofDB:GoodsNumber&amp;GoodsFullName=@ValueofDB:GoodsFullName&amp;GoodsSpec=@ValueofDB:GoodsSpec&amp;Seq=@ValueofDB:Seq&amp;OutInStock=@ValueofDB:OutInStock&amp;StockFullName=@ValueofDB:SIStockFullName&amp;ComFullName=@ValueofDB:SIComFullName" order="35" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="序列号跟踪"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    M.seq as Seq,vbCrLf    (case when isnull((select sum(TotalQty) from tblstockDet k where k.seq=SI.seq and k.GoodsCode=SI.GoodsCode and lastMarker=1 and k.BillType='tblSalesReturnStock'),0)&gt;0 then '3' when isnull((select sum(TotalQty) from tblstockDet k where k.seq=SI.seq and k.GoodsCode=SI.GoodsCode and lastMarker=1 and k.BillType!='tblSalesReturnStock'),0)&gt;0  then '1' else '2' end) as OutInStock,vbCrLf    SI.GoodsCode as GoodsCode,vbCrLf    tblGoods.[tblGoods] as GoodsNumber,vbCrLf    SI.[GOODSPROP] as BatchNo,vbCrLf    SI.InstoreQty as qty,vbCrLf    SI.instorePrice as instorePrice,vbCrLf    case when SI.BillDate='-1' then '期初' else SI.BillDate end  as SIBillDate,vbCrLf    case when SI.Billtype='tblStockdet' then '期初' else SITable.languageId end as SILanguageId,vbCrLf    SI.BillNo as SIBillNo,vbCrLf    SI.StockCode as inStockCode,vbCrLf    tblStock.StockFullName as SIStockFullName,vbCrLf    SICompany.classCode as CompanyCode,vbCrLf    SICompany.ComNumber as SIComNumber,vbCrLf    SICompany.ComFullName as SIComFullName,vbCrLf    SO.salesPrice as outstorePrice,vbCrLf    SO.BillDate as SOBillDate,vbCrLf    case when SO.Billtype='tblStockdet' then '期初' else SOTable.languageId end as SOlanguageId,vbCrLf    SO.BillNo as SOBillNo,vbCrLf    outStock.classCode as outStockCode,vbCrLf    outStock.StockFullName as SOStockFullName,vbCrLf    SOCompany.classCode as OutCompanyCode,vbCrLf    SOCompany.ComNumber as SOComNumber,vbCrLf    SOCompany.ComFullName as SOComFullName,vbCrLf    sourcecom.ComNumber as sourcecomNumber,vbCrLf    sourcecom.ComFullName as SourceComFullName,vbCrLf    SI.BillID as SIBillID,vbCrLf    SI.BillType as SIBillType,vbCrLf    SO.BillID as SOBillID,vbCrLf    SO.BillType as SOBillType,vbCrLf    (select modelName from tblModules where linkAddress='/ReportDataAction.do?reportNumber=ReportSeqGoods' and tblName='ReportSeqGoods') as LinkvbCrLffrom (select distinct GoodsCode,Seq from tblStockDet where Seq !='' and instoreQty &gt; 0 ) as M vbCrLf join tblStockDet as SI on SI.Seq=M.Seq and SI.GoodsCode=M.GoodsCode and SI.id=(select top 1 NI.id from tblStockDet NI  where NI.Seq=SI.Seq and NI.GoodsCode=SI.GoodsCode and NI.instoreQty != 0 ORDER BY NI.BillDate,NI.createTime,NI.ItemOrder)vbCrLf left join tblStockDet SO on SO.Seq=M.Seq and SO.GoodsCode=M.GoodsCode and SO.id=(select top 1 Nu.id from tblStockDet Nu  where Nu.Seq=SO.Seq and Nu.GoodsCode=SO.GoodsCode and Nu.outstoreQty != 0 and Nu.billType &lt;&gt;'tblAllot' and Nu.billType &lt;&gt;'tblAllotChange' ORDER BY Nu.BillDate desc,Nu.createTime desc,Nu.ItemOrder desc)vbCrLf join tblGoods on tblGoods.classCode=M.GoodsCodevbCrLf join tblStock on tblStock.classCode=SI.StockCodevbCrLf left join (select classCode,StockFullName from tblStock where 0=0) outStock on outStock.classCode=SO.StockCodevbCrLf left join (select * from tblCompany  WHERE 0=0)SICompany on SICompany.classCode=SI.CompanyCodevbCrLf left join (select * from tblCompany  WHERE 0=0)SOCompany on SOCompany.classCode=SO.CompanyCodevbCrLf left join (select * from tblCompany  WHERE 0=0)sourcecom ON sourcecom.classCode=SI.CompanyCodevbCrLf left join tblDBTableInfo SITable on SITable.tableName=SI.BillTypevbCrLf left join tblDBTableInfo SOTable on SOTable.tableName=SO.BillTypevbCrLf {SI.GOODSPROP}vbCrLfwhere 1=1 vbCrLf      and (M.seq like '%'+?+'%')vbCrLf      and ((case when isnull((select sum(TotalQty) from tblstockDet k where k.seq=SI.seq and k.GoodsCode=SI.GoodsCode and lastMarker=1 and k.BillType='tblSalesReturnStock'),0)&gt;0 then '3' when isnull((select sum(TotalQty) from tblstockDet k where k.seq=SI.seq and k.GoodsCode=SI.GoodsCode and lastMarker=1 and k.BillType!='tblSalesReturnStock'),0)&gt;0  then '1' else '2' end) = ?)vbCrLf      and (SI.GoodsCode =?)vbCrLf      and (SI.[GOODSPROP] =?)vbCrLf      and (SI.BillDate &gt;=?)vbCrLf      and (SI.BillDate &lt;=?)vbCrLf      and (SI.BillNo like '%'+?+'%')vbCrLf      and (SI.StockCode =?)vbCrLf      and (SICompany.classCode =?)vbCrLf      and (SO.BillDate &gt;=?)vbCrLf      and (SO.BillDate &lt;=?)vbCrLf      and (SO.BillNo like '%'+?+'%')vbCrLf      and (outStock.classCode =?)vbCrLf      and (SOCompany.classCode =?)vbCrLfvbCrLforder by vbCrLf   M.seq desc,vbCrLf   tblGoods.[tblGoods] ,vbCrLf   tblStock.StockFullName vbCrLfvbCrLf"/><charts/></ReportDataSource>
