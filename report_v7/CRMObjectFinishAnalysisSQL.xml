<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName="目标完成分析"/><fieldInfo><field fieldname="tblEmployeeGoal.year" AsfieldName="year" groupByFlag="0" displayFlag="0" condition="=?" conditionJoin="and" orderbyFlag="" display="年度" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="@Sess:NowYear" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="年度"/><Display localStr="zh_CN" display="年度"/><Display localStr="en" display="Year"/></Displays><groupNames/></field><field fieldname="tblEmployeeGoalDet.month" AsfieldName="StartMonth" groupByFlag="0" displayFlag="0" condition="&gt;=?" conditionJoin="and" orderbyFlag="" display="开始月份≥" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="@Sess:NowMonth" fieldSysType="" fixColName="1" isNull="1" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="开始月份≥"/><Display localStr="en" display="Start Month≥"/><Display localStr="zh_TW" display="开始月份≥"/></Displays><groupNames/></field><field fieldname="tblEmployeeGoalDet.month" AsfieldName="EndMonth" groupByFlag="0" displayFlag="0" condition="&lt;=?" conditionJoin="and" orderbyFlag="" display="结束月份≤" fieldType="0" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="结束月份≤"/><Display localStr="en" display="EndMonth≤"/><Display localStr="zh_TW" display="結束月份≤"/></Displays><groupNames/></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="80" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department full name"/><Display localStr="zh_TW" display="部門"/></Displays><groupNames/></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="1" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="80" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="职员"/><Display localStr="en" display="Full name of Employee"/><Display localStr="zh_TW" display="職員"/></Displays><groupNames/></field><field fieldname="tblEmployeeGoal.goalType" AsfieldName="goalType" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="类型" fieldType="2" inputType="1" popUpName="goalType" width="90" classCode="1" linkAdd="" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="類型"/><Display localStr="zh_CN" display="类型"/><Display localStr="en" display="Type"/></Displays><groupNames/></field><field fieldname="sum(tblEmployeeGoalDet.Goal)" AsfieldName="Goal" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="业绩目标" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="7" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="业绩目标"/><Display localStr="en" display="Goal"/><Display localStr="zh_TW" display="業績目標"/></Displays><groupNames/></field><field fieldname="sum(tblEmployeeGoalDet.complete)" AsfieldName="complete" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="实际完成" fieldType="1" inputType="0" popUpName="" width="110" classCode="1" linkAdd="" order="8" isStat="1" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="实际完成"/><Display localStr="en" display="Complete total"/><Display localStr="zh_TW" display="實際完成"/></Displays><groupNames/></field><field fieldname="sum(tblEmployeeGoalDet.complete)/(case sum(tblEmployeeGoalDet.Goal) when 0 then 1 else sum(tblEmployeeGoalDet.Goal) end)" AsfieldName="completeRate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="完成比例" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="完成比例"/><Display localStr="en" display="Complete Rate"/><Display localStr="zh_TW" display="完成比例"/></Displays><groupNames/></field><field fieldname="k.AvgRate" AsfieldName="AvgCompleteRate" groupByFlag="1" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="平均比例" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="1" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="平均比例"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    tblEmployeeGoal.goalType as goalType,vbCrLf    sum(tblEmployeeGoalDet.Goal) as Goal,vbCrLf    sum(tblEmployeeGoalDet.complete) as complete,vbCrLf    sum(tblEmployeeGoalDet.complete)/(case sum(tblEmployeeGoalDet.Goal) when 0 then 1 else sum(tblEmployeeGoalDet.Goal) end) as completeRate,vbCrLf    k.AvgRate as AvgCompleteRatevbCrLffrom tblEmployeeGoalvbCrLfleft join tblEmployeeGoalDet on tblEmployeeGoal.id=tblEmployeeGoalDet.f_refvbCrLfleft join tblDepartment on tblEmployeeGoal.DepartmentCode=tblDepartment.classCodevbCrLfleft join tblEmployee on tblEmployee.id=tblEmployeeGoal.EmployeeIDvbCrLfleft join (select sum(m.complete)/(case sum(m.Goal) when 0 then 1 else sum(m.Goal) end) as AvgRate from tblEmployeeGoal n vbCrLf          left join tblEmployeeGoalDet m on m.f_ref=n.id left join tblEmployee p on p.id=n.EmployeeID vbCrLf          left join tblDepartment q on n.DepartmentCode=q.classCode where n.year=@condition:year and m.month &gt;= @condition:StartMonth vbCrLf          and m.month &lt;= (case isnull(@condition:EndMonth,'') when '' then 12 else @condition:EndMonth end)vbCrLf          and p.EmpFullName like '%'+@condition:EmpFullName+'%' and q.DeptFullName like '%'+@condition:DeptFullName+'%') k on 1=1vbCrLfwhere 1=1 vbCrLf      and (tblEmployeeGoal.year =?)vbCrLf      and (tblEmployeeGoalDet.month &gt;=?)vbCrLf      and (tblEmployeeGoalDet.month &lt;=?)vbCrLf      and (tblDepartment.DeptFullName like '%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLfgroup by vbCrLf   tblDepartment.DeptFullName,vbCrLf   tblEmployee.EmpFullName,vbCrLf   tblEmployeeGoal.goalType,vbCrLf   k.AvgRatevbCrLfvbCrLf  vbCrLf"/><charts/></ReportDataSource>
