<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="c8a29524_1405060935433310011" reportName="tblAccMainDet"/><fieldInfo><field fieldname="tblAccDetail.BillDate" AsfieldName="BillDateS" groupByFlag="0" displayFlag="1" condition="&gt;=?" conditionJoin="and" orderbyFlag="  " display="单据日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≥"/></Displays><groupNames/></field><field fieldname="tblAccDetail.BillDate" AsfieldName="BillDateE" groupByFlag="0" displayFlag="1" condition="&lt;=?" conditionJoin="and" orderbyFlag="  " display="单据日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期≤"/></Displays><groupNames/></field><field fieldname="tblAccDetail.classCode" AsfieldName="AccCode" groupByFlag="0" displayFlag="0" condition="=?" conditionJoin="and" orderbyFlag="升" display="classCode" fieldType="2" inputType="2" popUpName="ReportSelectAccCodeC_v2" width="0" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_TW" display="classCode"/><Display localStr="zh_CN" display="classCode"/><Display localStr="en" display="classCode"/></Displays><groupNames/></field><field fieldname="tblAccDetail.BillDate" AsfieldName="BillDateO" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="升" display="单据日期" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期"/></Displays><groupNames/></field><field fieldname="case when tblAccDetail.BillDate='-1' then '期初' else tblAccDetail.BillDate end" AsfieldName="BillDate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="  " display="单据日期" fieldType="5" inputType="0" popUpName="" width="90" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="单据日期"/></Displays><groupNames/></field><field fieldname="tblAccDetail.CredTypeID" AsfieldName="CredTypeID" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="凭证字" fieldType="2" inputType="0" popUpName="" width="40" classCode="1" linkAdd="VoucherManageAction.do?operation=5&amp;tableName=tblAccMain&amp;id=@ValueofDB:AccMainID&amp;isEspecial=1 " order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="凭证字"/></Displays><groupNames/></field><field fieldname="case when tblAccDetail.RefBillNo='settleAcc' then '月结' else tblAccDetail.RefBillNo end" AsfieldName="RefBillNo" groupByFlag="0" displayFlag="1" condition="=?" conditionJoin="and" orderbyFlag="降" display="关联单号" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="关联单号"/></Displays><groupNames/></field><field fieldname="tblAccDetail.AccFullName" AsfieldName="AccFullName" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="科目全称" fieldType="2" inputType="4" popUpName="" width="200" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="科目全称"/></Displays><groupNames/></field><field fieldname="tblAccDetail.AccCode" AsfieldName="AccNumber" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="会计科目" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="会计科目"/></Displays><groupNames/></field><field fieldname="tblAccDetail.JdFlag" AsfieldName="JdFlag" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="余额方向" fieldType="0" inputType="1" popUpName="DebitCredit" width="50" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="余额方向"/></Displays><groupNames/></field><field fieldname="tblAccDetail.DebitAmount" AsfieldName="DebitAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="借方金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="11" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="借方金额"/></Displays><groupNames/></field><field fieldname="tblAccDetail.LendAmount" AsfieldName="LendAmount" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="贷方金额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="12" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="贷方金额"/></Displays><groupNames/></field><field fieldname="tblAccDetail.AccBalance" AsfieldName="AccBalance" groupByFlag="0" displayFlag="1" condition="" conditionJoin="and" orderbyFlag="" display="余额" fieldType="1" inputType="0" popUpName="" width="100" classCode="1" linkAdd="" order="13" isStat="1" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="余额"/></Displays><groupNames/></field><field fieldname="tblAccDetail.AccMainID" AsfieldName="AccMainID" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="" inputType="" popUpName="" width="0" classCode="1" linkAdd="" order="14" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays/><groupNames/></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="0" displayFlag="0" condition="=?" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="15" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL="" repeatNotShow="0" zeroDisplay="0" seriesCol="" seriesNums="" crossField="" groupName="" fieldIdentity="" analysis="0"><Displays><Display localStr="zh_CN" display="部门"/></Displays><groupNames/></field></fieldInfo><SQL text="select vbCrLf    tblAccDetail.BillDate as BillDateS,vbCrLf    tblAccDetail.BillDate as BillDateE,vbCrLf    tblAccDetail.BillDate as BillDateO,vbCrLf    case when tblAccDetail.BillDate='-1' then '期初' else tblAccDetail.BillDate end as BillDate,vbCrLf    tblAccDetail.CredTypeID as CredTypeID,vbCrLf    case when tblAccDetail.RefBillNo='settleAcc' then '月结' else tblAccDetail.RefBillNo end as RefBillNo,vbCrLf    tblAccDetail.AccFullName as AccFullName,vbCrLf    tblAccDetail.AccCode as AccNumber,vbCrLf    tblAccDetail.JdFlag as JdFlag,vbCrLf    tblAccDetail.DebitAmount as DebitAmount,vbCrLf    tblAccDetail.LendAmount as LendAmount,vbCrLf    tblAccDetail.AccBalance as AccBalance,vbCrLf    tblAccDetail.AccMainID as AccMainIDvbCrLffrom (select tblAccMain.DepartmentCode,tblAccTypeInfo.classCode,tblAccMain.BillDate,CredTypeID+'_'+cast(OrderNo as varchar(10)) as CredTypeID,tblAccMain.RefBillNo,tblAccTypeInfo.AccFullName,tblAccDetail.AccCode,tblAccDetail.DebitAmount,tblAccDetail.LendAmount,DebitAmount-LendAmount  as AccBalance,tblAccMain.id as AccMainID,tblAccTypeInfo.jdFlag from tblAccMain left join tblAccDetail on tblAccMain.id=tblAccDetail.f_refvbCrLf left join tblAccTypeInfo on tblAccDetail.AccCode=tblAccTypeInfo.AccNumber where tblAccMain.workFlowNodeName='finish'vbCrLf union allvbCrLf select '',b.classCode,'-1','','',b.AccFullName,subCode,0,0,case b.jdFlag when '1' then CurrYIniBalaBase else -CurrYIniBalaBase end as AccBalance,'' as AccMainID,b.jdFlag from tblAccBalance a,tblAccTypeInfo b where a.period=-1 and a.subCode=b.AccNumber and b.isCatalog=0 and b.isCalculateParent=0 and a.CurrYIniBalaBase!=0) as tblAccDetailvbCrLfleft join tblDepartment on tblAccDetail.DepartmentCode=tblDepartment.classCodevbCrLfwhere 1=1 vbCrLf      and (tblAccDetail.BillDate &gt;=?)vbCrLf      and (tblAccDetail.BillDate &lt;=?)vbCrLf      and (tblAccDetail.classCode =?)vbCrLf      and (case when tblAccDetail.RefBillNo='settleAcc' then '月结' else tblAccDetail.RefBillNo end =?)vbCrLf      and (tblDepartment.DeptFullName =?)vbCrLfvbCrLforder by vbCrLf   tblAccDetail.classCode ,vbCrLf   tblAccDetail.BillDate ,vbCrLf   case when tblAccDetail.RefBillNo='settleAcc' then '月结' else tblAccDetail.RefBillNo end descvbCrLfvbCrLf"/><charts/></ReportDataSource>
