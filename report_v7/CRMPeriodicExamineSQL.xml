<?xml version="1.0" encoding="UTF-8" ?>
<ReportDataSource><Report reporteId="" reportName=""/><fieldInfo><field fieldname="CRMPeriodicExamine.BillDate" AsfieldName="BillDate1" groupByFlag="0" displayFlag="0" condition="&gt;= ?" conditionJoin="and" orderbyFlag="" display="检测日期≥" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="1" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_CN" display="检测日期≥"/><Display localStr="en" display="Examine Date≥"/><Display localStr="zh_TW" display="檢測日期≥"/></Displays></field><field fieldname="CRMPeriodicExamine.BillDate" AsfieldName="BillDate2" groupByFlag="0" displayFlag="0" condition="&lt;= ?" conditionJoin="and" orderbyFlag="" display="检测日期≤" fieldType="5" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="2" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_CN" display="检测日期≤"/><Display localStr="en" display="Examine Date≤"/><Display localStr="zh_TW" display="檢測日期≤"/></Displays></field><field fieldname="CRMPeriodicExamine.BillDate" AsfieldName="BillDate" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="降" display="检测日期" fieldType="5" inputType="0" popUpName="" width="70" classCode="1" linkAdd="" order="3" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_TW" display="檢測日期"/><Display localStr="zh_CN" display="检测日期"/><Display localStr="en" display="Examine Date"/></Displays></field><field fieldname="CRMPeriodicExamine.BillNo" AsfieldName="BillNo" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="降" display="检测单号" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="UserFunctionAction.do?tableName=CRMPeriodicExamine&amp;parentTableName=CRMClientInfo&amp;keyId=@ValueofDB:id&amp;operation=5" order="4" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_TW" display="檢測單號"/><Display localStr="zh_CN" display="检测单号"/><Display localStr="en" display="Bill No"/></Displays></field><field fieldname="CRMClientInfo.ClientName" AsfieldName="ClientName" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="客户名称" fieldType="18" inputType="2" popUpName="ReportSelectCRMClient" width="200" classCode="1" linkAdd="" order="5" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_TW" display="客戶名稱"/><Display localStr="zh_CN" display="客户名称"/><Display localStr="en" display="Client Name"/></Displays></field><field fieldname="CRMPeriodicExamine.ContractNo" AsfieldName="ContractNo" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="合同编号" fieldType="2" inputType="0" popUpName="" width="100" classCode="1" linkAdd="UserFunctionAction.do?tableName=CRMSaleContract&amp;parentTableName=CRMClientInfo&amp;src=menu&amp;keyId=@ValueofDB:cid&amp;operation=5" order="6" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_TW" display="合同編號"/><Display localStr="zh_CN" display="合同编号"/><Display localStr="en" display="Conctract No"/></Displays></field><field fieldname="CRMPeriodicExamine.ExamineStage" AsfieldName="ExamineStage" groupByFlag="0" displayFlag="1" condition="= ?" conditionJoin="and" orderbyFlag="" display="检测阶段" fieldType="2" inputType="1" popUpName="ExamineStage" width="100" classCode="1" linkAdd="" order="7" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_TW" display="檢測階段"/><Display localStr="zh_CN" display="检测阶段"/><Display localStr="en" display="Examine Stage"/></Displays></field><field fieldname="tblDepartment.DeptFullName" AsfieldName="DeptFullName" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="部门" fieldType="2" inputType="2" popUpName="ReportSelectDepartment" width="80" classCode="1" linkAdd="" order="8" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_CN" display="部门"/><Display localStr="en" display="Department"/><Display localStr="zh_TW" display="部門"/></Displays></field><field fieldname="tblEmployee.EmpFullName" AsfieldName="EmpFullName" groupByFlag="0" displayFlag="1" condition="like '%'+?+'%'" conditionJoin="and" orderbyFlag="" display="职员" fieldType="2" inputType="2" popUpName="ReportSelectEmployee" width="80" classCode="1" linkAdd="" order="9" isStat="0" defaultValue="" fieldSysType="" fixColName="1" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_CN" display="职员"/><Display localStr="en" display="Employee"/><Display localStr="zh_TW" display="職員"/></Displays></field><field fieldname="CRMPeriodicExamine.f_brother" AsfieldName="f_brother" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="10" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays/></field><field fieldname="CRMPeriodicExamine.id" AsfieldName="id" groupByFlag="0" displayFlag="1" condition="(exists(select * from tblEmpDistrict a left join tblEmpDistrictDet b on b.f_ref=a.id where a.EmployeeID='@Sess:UserId' and b.BusinessDistrict=CRMClientInfo.BusinessDistrict) or '@Sess:UserId'='1' or '@MEM:ManageDistrict'='false') and CRMClientInfo.statusId=0 and CRMClientInfo.Status!=1 and (CRMClientInfoEmp.EmployeeID='@Sess:UserId' or '@Sess:UserId'='1')" conditionJoin="and" orderbyFlag="" display="" fieldType="2" inputType="0" popUpName="" width="0" classCode="1" linkAdd="" order="11" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays/></field><field fieldname="CRMPeriodicExamine.RefBillID" AsfieldName="cid" groupByFlag="0" displayFlag="1" condition="" conditionJoin="" orderbyFlag="" display="关联合同ID" fieldType="2" inputType="3" popUpName="" width="0" classCode="1" linkAdd="" order="12" isStat="0" defaultValue="" fieldSysType="" fixColName="0" isNull="0" planarField="0" subSQL=""><Displays><Display localStr="zh_TW" display="關聯合同ID"/><Display localStr="zh_CN" display="关联合同ID"/><Display localStr="en" display="Relation Contract ID"/></Displays></field></fieldInfo><SQL text="select vbCrLf    CRMPeriodicExamine.BillDate as BillDate,vbCrLf    CRMPeriodicExamine.BillNo as BillNo,vbCrLf    CRMClientInfo.ClientName as ClientName,vbCrLf    CRMPeriodicExamine.ContractNo as ContractNo,vbCrLf    CRMPeriodicExamine.ExamineStage as ExamineStage,vbCrLf    tblDepartment.DeptFullName as DeptFullName,vbCrLf    tblEmployee.EmpFullName as EmpFullName,vbCrLf    CRMPeriodicExamine.f_brother as f_brother,vbCrLf    CRMPeriodicExamine.id as id,vbCrLf    CRMPeriodicExamine.RefBillID as cidvbCrLffrom CRMPeriodicExaminevbCrLfleft join tblEmployee on tblEmployee.id=CRMPeriodicExamine.EmployeeIDvbCrLfleft join tblDepartment on tblDepartment.classCode=tblEmployee.DepartmentCodevbCrLfleft join CRMClientInfo on CRMPeriodicExamine.f_brother=CRMClientInfo.idvbCrLfleft join CRMClientInfoEmp on CRMClientInfo.id=CRMClientInfoEmp.f_refvbCrLfwhere 1=1 vbCrLf      and (CRMPeriodicExamine.BillDate &gt;= ?)vbCrLf      and (CRMPeriodicExamine.BillDate &lt;= ?)vbCrLf      and (CRMPeriodicExamine.BillNo like '%'+?+'%')vbCrLf      and (CRMClientInfo.ClientName like '%'+?+'%')vbCrLf      and (CRMPeriodicExamine.ContractNo like '%'+?+'%')vbCrLf      and (CRMPeriodicExamine.ExamineStage = ?)vbCrLf      and (tblDepartment.DeptFullName like '%'+?+'%')vbCrLf      and (tblEmployee.EmpFullName like '%'+?+'%')vbCrLf      and (exists(select * from tblEmpDistrict a left join tblEmpDistrictDet b on b.f_ref=a.id where a.EmployeeID='@Sess:UserId' and b.BusinessDistrict=CRMClientInfo.BusinessDistrict) or '@Sess:UserId'='1' or '@MEM:ManageDistrict'='false') and CRMClientInfo.statusId=0 and CRMClientInfo.Status!=1 and (CRMClientInfoEmp.EmployeeID='@Sess:UserId' or '@Sess:UserId'='1')vbCrLfvbCrLforder by vbCrLf   CRMPeriodicExamine.BillDate desc,vbCrLf   CRMPeriodicExamine.BillNo descvbCrLf"/></ReportDataSource>
