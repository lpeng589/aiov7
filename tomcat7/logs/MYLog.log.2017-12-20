[INFO ] 2017-12-20 08:36:07,514 Line:206 系统开始启动，最大内存：1792;目前总内存：249;目前空闲内存：154
 [INFO ] 2017-12-20 08:36:07,621 Line:284 ===========Tomcat Port=8888
 [INFO ] 2017-12-20 08:36:11,676 Line:2660 ---------------------------------first read dog =======-----------
 [DEBUG] 2017-12-20 08:36:11,846 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canJxc=1 
 [DEBUG] 2017-12-20 08:36:11,867 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canOa=1 
 [DEBUG] 2017-12-20 08:36:11,870 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canCrm=1 
 [DEBUG] 2017-12-20 08:36:11,873 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canHr=1 
 [DEBUG] 2017-12-20 08:36:11,881 Line:594 select AccPeriod,AccMonth,AccYear,scompanyId,statusId,isBegin from tblAccPeriod where statusId=1 or isBegin=1
 [DEBUG] 2017-12-20 08:36:11,892 Line:626 ------Init initAccPeriod record:1
 [DEBUG] 2017-12-20 08:36:12,895 Line:1061 ------Init Enumeration record:390
 [DEBUG] 2017-12-20 08:36:12,923 Line:1091 ------Init WorkProfession record:58
 [DEBUG] 2017-12-20 08:36:12,960 Line:1121 ------Init District record:3984
 [DEBUG] 2017-12-20 08:36:12,973 Line:1152 ------Init deptMap record:1
 [DEBUG] 2017-12-20 08:36:13,943 Line:1832 ------Init ModuleList record:
 [DEBUG] 2017-12-20 08:36:13,943 Line:2855 --------Init ModuleList Successful---------------
 [DEBUG] 2017-12-20 08:36:14,472 Line:297  select * from tblDBTableInfo order by TableName 
 [DEBUG] 2017-12-20 08:36:14,556 Line:370 select * from tblDBFieldInfo order by tableId,listOrder
 [DEBUG] 2017-12-20 08:36:15,367 Line:538 ------Init TableInfo record:634
 [DEBUG] 2017-12-20 08:36:15,414 Line:651  select cataName,disName,module,tableName,nameField,codeField from tblScopeCataData order by orderby 
 [DEBUG] 2017-12-20 08:36:15,425 Line:682 ------Init TableInfo record:4
 [DEBUG] 2017-12-20 08:36:15,444 Line:775 ------Init initModuleField record:0
 [DEBUG] 2017-12-20 08:36:15,468 Line:702  select tableName,sentence from tblPopDisSentence where statusId=0 order by tableName 
 [DEBUG] 2017-12-20 08:36:15,478 Line:721 ------Init TableInfo record:26
 [DEBUG] 2017-12-20 08:36:15,534 Line:891 ------Init PropInfo record:7
 [DEBUG] 2017-12-20 08:36:19,110 Line:2947 --------Init Config File ---------------
 [ERROR] 2017-12-20 08:36:19,423 Line:48 java.io.FileNotFoundException: D:\Project\aio\tomcat7\bin\..\..\fileServer_v7\wokeflow\ffd4bcdd_1701241708235230006.xml (系统找不到指定的文件。)
 [DEBUG] 2017-12-20 08:36:19,438 Line:1873 ------Init RefreshTime 
 [DEBUG] 2017-12-20 08:36:19,485 Line:2994 --------Init SMS Start ---------------
 [INFO ] 2017-12-20 08:36:19,866 Line:3011 -------System init Secussful Set Normal status--------------
 [DEBUG] 2017-12-20 08:36:19,866 Line:3855 --------Init Dog Successful---------------
 [INFO ] 2017-12-20 08:36:20,965 Line:89 SAFE 数据库第一个备份任务启动，时间2017-12-20 00:00:00
 [INFO ] 2017-12-20 08:36:20,965 Line:144 SAFE 备份任务开始执行，时间2017-12-20 08:36:20
 [INFO ] 2017-12-20 08:36:20,966 Line:137 SAFE 碎片任务启动，时间2017-12-24 00:00:00
 [INFO ] 2017-12-20 08:36:25,692 Line:148 SAFE 备份任务执行成功，时间2017-12-20 08:36:25
 [DEBUG] 2017-12-20 08:37:01,215 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 08:37:01,215 Line:3003 MobileAjax 操作人:;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 08:37:01,216 Line:243 AIOApi op=getSessEmp&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:01,250 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 08:37:10,070 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 08:37:10,070 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 08:37:10,071 Line:243 AIOApi op=LOGIN&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:10,118 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 08:37:10,170 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 08:37:10,184 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 08:37:10,313 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 08:37:10,737 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 08:37:10,739 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 08:37:10,740 Line:243 AIOApi op=getSessEmp&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:10,758 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 08:37:10,773 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 08:37:10,774 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 08:37:10,774 Line:243 AIOApi op=getEnum&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:10,785 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 08:37:19,066 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 08:37:19,067 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 08:37:19,068 Line:243 AIOApi op=report&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:19,068 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 08:37:19,069 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 08:37:19,069 Line:243 AIOApi op=popup&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:19,097 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 08:37:19,111 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 08:37:19,552 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 08:37:19,573 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 08:37:19,574 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 08:37:19,575 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 08:37:19,576 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 08:37:19,577 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 08:37:19,578 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 08:37:19,578 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 08:37:19,579 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 08:37:19,579 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 08:37:19,579 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 08:37:19,580 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 08:37:19,581 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 08:37:19,582 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 08:37:19,582 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 08:37:19,582 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 08:37:19,583 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 08:37:19,583 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 08:37:19,671 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 08:37:19,671 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 08:37:19,671 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:37:19,671 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:37:19,672 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 08:37:19,672 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:37:19,672 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 08:37:19,672 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 08:37:19,674 Line:689 通过SQL读原始数据：101
 [DEBUG] 2017-12-20 08:37:19,676 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 08:37:19,714 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 08:37:20,199 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 08:37:20,578 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 08:37:20,579 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 08:37:20,580 Line:243 AIOApi op=report&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:37:20,598 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 08:37:20,598 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 08:37:20,599 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 08:37:20,599 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 08:37:20,600 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 08:37:20,600 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 08:37:20,600 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 08:37:20,601 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 08:37:20,601 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 08:37:20,601 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 08:37:20,602 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 08:37:20,602 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 08:37:20,602 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 08:37:20,603 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 08:37:20,603 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 08:37:20,603 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 08:37:20,604 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 08:37:20,604 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 08:37:20,634 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 08:37:20,635 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 08:37:20,635 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:37:20,635 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:37:20,636 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 08:37:20,637 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:37:20,637 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 08:37:20,638 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 08:37:20,639 Line:689 通过SQL读原始数据：41
 [DEBUG] 2017-12-20 08:37:20,641 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 08:37:20,666 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 08:47:46,647 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 08:47:46,648 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 08:47:46,648 Line:243 AIOApi op=popup&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:47:46,649 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 08:47:46,670 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 08:47:48,154 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&tableName=tblSalesOrder
 [DEBUG] 2017-12-20 08:47:48,157 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];tableName=[tblSalesOrder,];pageNo=[1,];pageSize=[10,];src=[menu,];statusId=[,];BillNo=[,];BillDate1=[2009-12-31T16:00:00.000Z,];BillDate2=[2017-12-20T16:00:00.000Z,];workFlowNodeName=[,];
 [DEBUG] 2017-12-20 08:47:48,157 Line:243 AIOApi op=report&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:47:48,254 Line:549 ReportDataMgt.getReportData SQL=select keyId,createBy,deptCodeR,employeeId,deptCodeRE,BillDate,BillNo,ComFullName,ComNumber,DeptFullName,EmpFullName,ReceiveDate,TotalTaxAmount,CurTotalTaxAmount,SaleAmount,AccAmount,BackAmount,AccName,AlrAccAmt,sysName,id,statusId,Qty,OutQty,NotOut,Remark,CompanyCode,JAmount,JAmountz,InvoiceType,workFlowNodeName,workFlowNode,checkPersons,lastNodeID from ( select tblSalesOrder.id as keyId,tblSalesOrder.createBy as createBy,(select isnull(DepartmentCode,'') from tblEmployee where tblEmployee.id=tblSalesOrder.createBy) as deptCodeR,tblSalesOrder.employeeId as employeeId,tblSalesOrder.departmentCode as deptCodeRE, tblSalesOrder.workFlowNode as workFlowNode,tblSalesOrder.workFlowNodeName as workFlowNodeName,tblSalesOrder.checkPersons as checkPersons,(select lastNodeId from OAMyWorkFlow where OAMyWorkFlow.keyID=tblSalesOrder.id and OAMyWorkFlow.tableName='tblSalesOrder' and '1' = OAMyWorkFlow.lastCheckPerson and tblSalesOrder.workFlowNode!='-1' ) as lastNodeID,       tblSalesOrder.BillDate as BillDate,     tblSalesOrder.BillNo as BillNo,     tblCompany.ComFullName as ComFullName,     tblCompany.ComNumber as ComNumber,     tblDepartment.DeptFullName as DeptFullName,     tblEmployee1.EmpFullName as EmpFullName,     tblSalesOrder.ReceiveDate as ReceiveDate,     tblSalesOrder.TotalTaxAmount as TotalTaxAmount,     tblSalesOrder.CurTotalAmount as CurTotalTaxAmount,     isnull((select SUM(a.AfterChangeAmt) from tblSalesOutStockDet a,tblSalesOutStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0)-isnull((select SUM(a.TaxAmount) from tblSalesReturnStockDet a,tblSalesReturnStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0) as SaleAmount,     (select isnull(sum(a.TotalAlrAccAmt),0) from tblsalesoutstock a where a.SalesOrderID=tblSalesOrder.id and a.workFlowNodeName='finish') as AccAmount,     tblSalesOrder.BackAmount as BackAmount,     tblAccTypeInfo.AccName as AccName,     tblSalesOrder.AlrAccAmt as AlrAccAmt,     tblEmployee2.EmpFullName as sysName,     tblSalesOrder.id as id,     tblSalesOrder.statusId as statusId,     (select isnull(sum(Qty),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as Qty,     (select isnull(sum(isnull(case when OutQty<=0 then 0 else OutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as OutQty,     (select isnull(sum(isnull(case when NotOutQty<=0 then 0 else NotOutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as NotOut,     tblSalesOrder.Remark as Remark,     tblSalesOrder.CompanyCode as CompanyCode,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmount,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmountz,     tblSalesOrder.InvoiceType as InvoiceType   ,ROW_NUMBER() over(order by     tblSalesOrder.BillDate desc,    tblSalesOrder.BillNo desc) as row_id  from tblSalesOrder   left join tblCompany on tblCompany.classCode=tblSalesOrder.CompanyCode  left join tblDepartment on tblDepartment.classCode=tblSalesOrder.DepartmentCode  left join tblEmployee tblEmployee1 on tblEmployee1.id=tblSalesOrder.EmployeeID   left join tblEmployee tblEmployee2 on tblEmployee2.id=tblSalesOrder.createBy   left join tblAccTypeInfo on tblAccTypeInfo.AccNumber=tblSalesOrder.Account where 1=1 and isNull(tblSalesOrder.workFlowNodeName,'')!='print'        and (tblSalesOrder.BillDate >= ?)       and (tblSalesOrder.BillDate <= ?)                                                                    )  a  where row_id between 1 and 11 order by row_id
 [DEBUG] 2017-12-20 08:47:48,256 Line:582 ReportDataMgt.getReportData 参数1:2009-12-31T16:00:00.000Z
 [DEBUG] 2017-12-20 08:47:48,257 Line:582 ReportDataMgt.getReportData 参数2:2017-12-20T16:00:00.000Z
 [DEBUG] 2017-12-20 08:47:48,360 Line:689 通过SQL读原始数据：104
 [DEBUG] 2017-12-20 08:47:48,362 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 08:47:48,374 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["BillDate1","2009-12-31T16:00:00.000Z"],["BillDate2","2017-12-20T16:00:00.000Z"],["BillNo",""],["ComFullNamen",""],["ComName",""],["DeptFullName",""],["EmpFullName",""],["sysName",""],["statusId",""],["JAmount",""],["workFlowNodeName",""]],"cols":[["单据日期","70","date","","BillDate"],["单据编号","100","stringcall","","BillNo"],["客户全称","200","string","","ComFullName"],["客户编号","100","string","","ComNumber"],["部门","75","string","","DeptFullName"],["经手人","50","s等等！
 [DEBUG] 2017-12-20 08:47:49,909 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&tableName=tblSalesOrder
 [DEBUG] 2017-12-20 08:47:49,913 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];tableName=[tblSalesOrder,];pageNo=[2,];pageSize=[10,];src=[menu,];statusId=[,];BillNo=[,];BillDate1=[2009-12-31T16:00:00.000Z,];BillDate2=[2017-12-20T16:00:00.000Z,];workFlowNodeName=[,];
 [DEBUG] 2017-12-20 08:47:49,915 Line:243 AIOApi op=report&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:47:49,945 Line:549 ReportDataMgt.getReportData SQL=select keyId,createBy,deptCodeR,employeeId,deptCodeRE,BillDate,BillNo,ComFullName,ComNumber,DeptFullName,EmpFullName,ReceiveDate,TotalTaxAmount,CurTotalTaxAmount,SaleAmount,AccAmount,BackAmount,AccName,AlrAccAmt,sysName,id,statusId,Qty,OutQty,NotOut,Remark,CompanyCode,JAmount,JAmountz,InvoiceType,workFlowNodeName,workFlowNode,checkPersons,lastNodeID from ( select tblSalesOrder.id as keyId,tblSalesOrder.createBy as createBy,(select isnull(DepartmentCode,'') from tblEmployee where tblEmployee.id=tblSalesOrder.createBy) as deptCodeR,tblSalesOrder.employeeId as employeeId,tblSalesOrder.departmentCode as deptCodeRE, tblSalesOrder.workFlowNode as workFlowNode,tblSalesOrder.workFlowNodeName as workFlowNodeName,tblSalesOrder.checkPersons as checkPersons,(select lastNodeId from OAMyWorkFlow where OAMyWorkFlow.keyID=tblSalesOrder.id and OAMyWorkFlow.tableName='tblSalesOrder' and '1' = OAMyWorkFlow.lastCheckPerson and tblSalesOrder.workFlowNode!='-1' ) as lastNodeID,       tblSalesOrder.BillDate as BillDate,     tblSalesOrder.BillNo as BillNo,     tblCompany.ComFullName as ComFullName,     tblCompany.ComNumber as ComNumber,     tblDepartment.DeptFullName as DeptFullName,     tblEmployee1.EmpFullName as EmpFullName,     tblSalesOrder.ReceiveDate as ReceiveDate,     tblSalesOrder.TotalTaxAmount as TotalTaxAmount,     tblSalesOrder.CurTotalAmount as CurTotalTaxAmount,     isnull((select SUM(a.AfterChangeAmt) from tblSalesOutStockDet a,tblSalesOutStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0)-isnull((select SUM(a.TaxAmount) from tblSalesReturnStockDet a,tblSalesReturnStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0) as SaleAmount,     (select isnull(sum(a.TotalAlrAccAmt),0) from tblsalesoutstock a where a.SalesOrderID=tblSalesOrder.id and a.workFlowNodeName='finish') as AccAmount,     tblSalesOrder.BackAmount as BackAmount,     tblAccTypeInfo.AccName as AccName,     tblSalesOrder.AlrAccAmt as AlrAccAmt,     tblEmployee2.EmpFullName as sysName,     tblSalesOrder.id as id,     tblSalesOrder.statusId as statusId,     (select isnull(sum(Qty),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as Qty,     (select isnull(sum(isnull(case when OutQty<=0 then 0 else OutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as OutQty,     (select isnull(sum(isnull(case when NotOutQty<=0 then 0 else NotOutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as NotOut,     tblSalesOrder.Remark as Remark,     tblSalesOrder.CompanyCode as CompanyCode,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmount,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmountz,     tblSalesOrder.InvoiceType as InvoiceType   ,ROW_NUMBER() over(order by     tblSalesOrder.BillDate desc,    tblSalesOrder.BillNo desc) as row_id  from tblSalesOrder   left join tblCompany on tblCompany.classCode=tblSalesOrder.CompanyCode  left join tblDepartment on tblDepartment.classCode=tblSalesOrder.DepartmentCode  left join tblEmployee tblEmployee1 on tblEmployee1.id=tblSalesOrder.EmployeeID   left join tblEmployee tblEmployee2 on tblEmployee2.id=tblSalesOrder.createBy   left join tblAccTypeInfo on tblAccTypeInfo.AccNumber=tblSalesOrder.Account where 1=1 and isNull(tblSalesOrder.workFlowNodeName,'')!='print'        and (tblSalesOrder.BillDate >= ?)       and (tblSalesOrder.BillDate <= ?)                                                                    )  a  where row_id between 11 and 21 order by row_id
 [DEBUG] 2017-12-20 08:47:49,946 Line:582 ReportDataMgt.getReportData 参数1:2009-12-31T16:00:00.000Z
 [DEBUG] 2017-12-20 08:47:49,946 Line:582 ReportDataMgt.getReportData 参数2:2017-12-20T16:00:00.000Z
 [DEBUG] 2017-12-20 08:47:49,973 Line:689 通过SQL读原始数据：27
 [DEBUG] 2017-12-20 08:47:49,988 Line:1391 整理数据：15
 [DEBUG] 2017-12-20 08:47:49,991 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["BillDate1","2009-12-31T16:00:00.000Z"],["BillDate2","2017-12-20T16:00:00.000Z"],["BillNo",""],["ComFullNamen",""],["ComName",""],["DeptFullName",""],["EmpFullName",""],["sysName",""],["statusId",""],["JAmount",""],["workFlowNodeName",""]],"cols":[["单据日期","70","date","","BillDate"],["单据编号","100","stringcall","","BillNo"],["客户全称","200","string","","ComFullName"],["客户编号","100","string","","ComNumber"],["部门","75","string","","DeptFullName"],["经手人","50","s等等！
 [DEBUG] 2017-12-20 08:54:51,899 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 08:54:51,900 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 08:54:51,900 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 08:54:51,900 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 08:54:51,901 Line:243 AIOApi op=popup&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:54:51,901 Line:243 AIOApi op=report&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:54:51,901 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 08:54:51,913 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 08:54:51,946 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 08:54:51,947 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 08:54:51,948 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 08:54:51,949 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 08:54:51,949 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 08:54:51,950 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 08:54:51,950 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 08:54:51,951 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 08:54:51,952 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 08:54:51,953 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 08:54:51,954 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 08:54:51,954 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 08:54:51,954 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 08:54:51,955 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 08:54:51,955 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 08:54:51,955 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 08:54:51,956 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 08:54:51,956 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 08:54:52,070 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 08:54:52,070 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 08:54:52,071 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:54:52,071 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:54:52,071 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 08:54:52,071 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:54:52,071 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 08:54:52,072 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 08:54:52,072 Line:689 通过SQL读原始数据：125
 [DEBUG] 2017-12-20 08:54:52,078 Line:1391 整理数据：3
 [DEBUG] 2017-12-20 08:54:52,088 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 08:54:53,405 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 08:54:53,409 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 08:54:53,411 Line:243 AIOApi op=report&sessionid=91E57622B3B4980982C0D567D0E1D483
 [DEBUG] 2017-12-20 08:54:53,443 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 08:54:53,444 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 08:54:53,445 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 08:54:53,445 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 08:54:53,446 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 08:54:53,446 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 08:54:53,448 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 08:54:53,448 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 08:54:53,448 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 08:54:53,448 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 08:54:53,448 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 08:54:53,448 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 08:54:53,450 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 08:54:53,450 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 08:54:53,450 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 08:54:53,450 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 08:54:53,450 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 08:54:53,450 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 08:54:53,471 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 08:54:53,472 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 08:54:53,472 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:54:53,472 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:54:53,472 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 08:54:53,473 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 08:54:53,474 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 08:54:53,474 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 08:54:53,477 Line:689 通过SQL读原始数据：33
 [DEBUG] 2017-12-20 08:54:53,479 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 08:54:53,489 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:07:41,302 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 09:16:10,225 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:16:10,228 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 09:16:10,228 Line:243 AIOApi op=report&sessionid=89ED2AB844CB0C053E797F37C85A87E4
 [DEBUG] 2017-12-20 09:16:10,228 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:16:10,230 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 09:16:10,230 Line:3003 MobileAjax 操作人:;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:16:10,230 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:10,231 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 09:16:11,727 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:16:11,729 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:16:11,730 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:11,731 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 09:16:15,446 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 09:16:15,446 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 09:16:15,447 Line:243 AIOApi op=LOGIN&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:15,478 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 09:16:15,504 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 09:16:15,517 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 09:16:15,559 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 09:16:16,035 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 09:16:16,036 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 09:16:16,037 Line:243 AIOApi op=getSessEmp&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:16,039 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 09:16:16,062 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 09:16:16,063 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 09:16:16,063 Line:243 AIOApi op=getEnum&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:16,065 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 09:16:18,149 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:16:18,150 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 09:16:18,150 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:18,151 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:16:18,152 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:16:18,152 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:18,152 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 09:16:18,161 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 09:16:18,199 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:16:18,199 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:16:18,199 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:16:18,199 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:16:18,200 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:16:18,200 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:16:18,200 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 09:16:18,200 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:16:18,201 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:16:18,201 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:16:18,201 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:16:18,201 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:16:18,202 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:16:18,202 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:16:18,202 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:16:18,202 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:16:18,202 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:16:18,202 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:16:18,305 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:16:18,305 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:16:18,305 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:16:18,305 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:16:18,306 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:16:18,306 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:16:18,306 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:16:18,306 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:16:18,306 Line:689 通过SQL读原始数据：107
 [DEBUG] 2017-12-20 09:16:18,307 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:16:18,318 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:16:19,670 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:16:19,672 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:16:19,673 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:16:19,704 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:16:19,705 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:16:19,705 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:16:19,706 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:16:19,706 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:16:19,706 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:16:19,706 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:16:19,707 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:16:19,707 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:16:19,708 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:16:19,708 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:16:19,709 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:16:19,709 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:16:19,709 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:16:19,710 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:16:19,710 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:16:19,710 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:16:19,711 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:16:19,745 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:16:19,746 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:16:19,746 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:16:19,746 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:16:19,747 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:16:19,747 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:16:19,748 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:16:19,748 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:16:19,749 Line:689 通过SQL读原始数据：44
 [DEBUG] 2017-12-20 09:16:19,751 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 09:16:19,766 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:19:42,782 Line:5227 GlobalsTool.js 生成js 时间76:/js/gen/login.vjs_zh_CN.js
 [DEBUG] 2017-12-20 09:19:42,853 Line:88 CommonServlet.service 请求地址：/CommonServlet?operation=qrcodeDownload
 [DEBUG] 2017-12-20 09:19:42,855 Line:99 CommonServlet.service 操作人:;请求数据：operation=[qrcodeDownload,];
 [DEBUG] 2017-12-20 09:19:43,290 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=valpwd&time=1513732783258
 [DEBUG] 2017-12-20 09:19:43,313 Line:163 UtilServlet.service 操作人:;请求数据：operation=[valpwd,];time=[1513732783258,];
 [DEBUG] 2017-12-20 09:19:43,517 Line:135 BaseAction.execute 请求地址：/loginAction.do?operation=15
 [DEBUG] 2017-12-20 09:19:43,518 Line:146 BaseAction.execute 操作人:;请求数据：operation=[15,];
 [DEBUG] 2017-12-20 09:19:45,368 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=getUserInfo&name=admin&time=1513732785367
 [DEBUG] 2017-12-20 09:19:45,368 Line:163 UtilServlet.service 操作人:;请求数据：operation=[getUserInfo,];name=[admin,];time=[1513732785367,];
 [DEBUG] 2017-12-20 09:19:45,382 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=sunCompany&name=admin&time=1513732785381
 [DEBUG] 2017-12-20 09:19:45,382 Line:163 UtilServlet.service 操作人:;请求数据：operation=[sunCompany,];name=[admin,];time=[1513732785381,];
 [DEBUG] 2017-12-20 09:19:45,461 Line:135 BaseAction.execute 请求地址：/loginAction.do
 [DEBUG] 2017-12-20 09:19:45,462 Line:146 BaseAction.execute 操作人:;请求数据：org.apache.struts.taglib.html.TOKEN=[,];NOTTOKEN=[true,];operation=[10,];ukId=[,];strM1=[,];strM2=[,];clientKey=[,];random=[,];screenWidth=[1263,];sunCompany=[1,];style=[style1,];system=[new,];loc=[zh_CN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 09:19:45,507 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 09:19:45,516 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 09:19:45,592 Line:135 BaseAction.execute 请求地址：/AIO.do
 [DEBUG] 2017-12-20 09:19:45,593 Line:146 BaseAction.execute 操作人:admin;请求数据：
 [DEBUG] 2017-12-20 09:19:45,607 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 09:19:45,800 Line:5227 GlobalsTool.js 生成js 时间41:/js/gen/body2.vjs_zh_CN.js
 [DEBUG] 2017-12-20 09:19:46,178 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=1&loadMenu=true
 [DEBUG] 2017-12-20 09:19:46,178 Line:135 BaseAction.execute 请求地址：/newMenu.do?keyId=28141812_0811271603291400086&name=%E6%88%91%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8F%B0&operation=0&winCurIndex=0
 [DEBUG] 2017-12-20 09:19:46,178 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[1,];loadMenu=[true,];
 [DEBUG] 2017-12-20 09:19:46,178 Line:146 BaseAction.execute 操作人:admin;请求数据：keyId=[28141812_0811271603291400086,];name=[???????・??????°,];operation=[0,];winCurIndex=[0,];
 [DEBUG] 2017-12-20 09:19:46,179 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 09:19:46,195 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=2&loadMenu=true
 [DEBUG] 2017-12-20 09:19:46,196 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[2,];loadMenu=[true,];
 [DEBUG] 2017-12-20 09:19:46,196 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 09:19:46,207 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=3&loadMenu=true
 [DEBUG] 2017-12-20 09:19:46,208 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[3,];loadMenu=[true,];
 [DEBUG] 2017-12-20 09:19:46,209 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 09:19:46,219 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=0&loadMenu=true
 [DEBUG] 2017-12-20 09:19:46,219 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[0,];loadMenu=[true,];
 [DEBUG] 2017-12-20 09:19:46,219 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 09:20:50,360 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=1
 [DEBUG] 2017-12-20 09:20:50,362 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[1,];
 [DEBUG] 2017-12-20 09:20:50,363 Line:215 ---------->SET Page 1 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:20:50,517 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 09:20:50,517 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=1&checkTab=Y
 [DEBUG] 2017-12-20 09:20:50,518 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 09:20:50,518 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[1,];checkTab=[Y,];
 [DEBUG] 2017-12-20 09:20:50,518 Line:215 ---------->SET Page 1 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:20:50,518 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 09:20:50,766 Line:5227 GlobalsTool.js 生成js 时间53:/js/gen/validate.vjs_zh_CN.js
 [DEBUG] 2017-12-20 09:20:50,784 Line:5227 GlobalsTool.js 生成js 时间17:/js/gen/report.vjs_zh_CN.js
 [DEBUG] 2017-12-20 09:20:53,247 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 09:20:53,249 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[1,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 09:20:53,264 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:20:53,265 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:20:53,265 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:20:53,265 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:20:53,265 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:20:53,265 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:20:53,265 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:20:53,266 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:20:53,266 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:20:53,266 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:20:53,266 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:20:53,266 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:20:53,266 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:20:53,267 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:20:53,267 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:20:53,267 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:20:53,267 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:20:53,267 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:20:53,340 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:20:53,340 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:20:53,340 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:20:53,341 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:20:53,341 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:20:53,341 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:20:53,342 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:20:53,343 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:20:53,343 Line:689 通过SQL读原始数据：79
 [DEBUG] 2017-12-20 09:20:53,344 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:20:58,387 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv
 [DEBUG] 2017-12-20 09:20:58,388 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[22,];src=[menu,menu,];reportNumber=[tblVirtualStock,tblVirtualStock,];reportName=[è??????????????è??,è??????????????è??,];displayName=[classCode,classCode,];LinkType=[@URL:,@URL:,];selectName=[ReportSelectGoods_v2,ReportSelectGoods_v2,];MOID=[fc26a1c0_0911091930102960206,fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,query,];popupWin=[Popdiv,];
 [DEBUG] 2017-12-20 09:20:58,411 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 09:20:58,412 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 09:20:58,413 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 09:20:58,414 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv&checkTab=Y
 [DEBUG] 2017-12-20 09:20:58,415 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[22,];src=[menu,menu,];reportNumber=[tblVirtualStock,tblVirtualStock,];reportName=[è??????????????è??,è??????????????è??,];displayName=[classCode,classCode,];LinkType=[@URL:,@URL:,];selectName=[ReportSelectGoods_v2,ReportSelectGoods_v2,];MOID=[fc26a1c0_0911091930102960206,fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,query,];popupWin=[Popdiv,];checkTab=[Y,];
 [DEBUG] 2017-12-20 09:20:58,451 Line:3434 DynDBManager.popSelect selectName=ReportSelectGoods_v2; sql=select * from (select tblGoods.classCode f1 ,tblGoods.isCatalog f2 ,tblGoods.GoodsNumber f3 ,tblGoods.GoodsFullName f4 ,tblGoods.GoodsSpec f5 ,tblGoods.BaseUnit f6 ,tblGoods.GoodsFullNamePYM f7 
,tblGoods.isCatalog as childCount,ROW_NUMBER() over( order by tblGoods.GoodsNumber,tblGoods.GoodsFullName) as row_id from tblGoods
      where 1=1  and tblGoods.workFlowNodeName='finish' and tblGoods.classCode like '_____') a where  row_id between 1 and 100 order by row_id 
 [DEBUG] 2017-12-20 09:20:58,549 Line:5227 GlobalsTool.js 生成js 时间20:/js/gen/Main.vjs_zh_CN.js
 [DEBUG] 2017-12-20 09:20:58,574 Line:5227 GlobalsTool.js 生成js 时间24:/js/gen/popupPage.vjs_zh_CN.js
 [DEBUG] 2017-12-20 09:21:01,496 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do
 [DEBUG] 2017-12-20 09:21:01,509 Line:146 BaseAction.execute 操作人:admin;请求数据：root=[,];isRoot=[,];operation=[22,];tableName=[,];parentTableName=[,];fieldName=[,];popDataType=[,];parentCode=[00003,];selectName=[ReportSelectGoods_v2,];popupType=[,];displayName=[,];reportNumber=[tblVirtualStock,];reportName=[è??????????????è??,];backType=[,];isQuote=[,];MOID=[fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,];iniPropField=[,];keyIdType=[saveType,];queryChannel=[,];strAction=[/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv&checkTab=Y,];nextClass=[next,];popPop=[,];noOp=[,];popupWin=[Popdiv,];isMain=[,];topId=[,];toDetail=[,];checkTab=[Y,];queryField=[,];keySearch=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];tblGoods.GoodsFullNamePYM=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 09:21:01,517 Line:3434 DynDBManager.popSelect selectName=ReportSelectGoods_v2; sql=select * from (select tblGoods.classCode f1 ,tblGoods.isCatalog f2 ,tblGoods.GoodsNumber f3 ,tblGoods.GoodsFullName f4 ,tblGoods.GoodsSpec f5 ,tblGoods.BaseUnit f6 ,tblGoods.GoodsFullNamePYM f7 
,tblGoods.isCatalog as childCount,ROW_NUMBER() over( order by tblGoods.GoodsNumber,tblGoods.GoodsFullName) as row_id from tblGoods
      where 1=1  and tblGoods.workFlowNodeName='finish' and tblGoods.classCode like '00003_____') a where  row_id between 1 and 100 order by row_id 
 [DEBUG] 2017-12-20 09:21:03,825 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 09:21:03,826 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[1,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:{call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[0000300001,];hide_GoodsCode=[0000300001#;#0#;#bl0001#;#叉烧包#;##;##;#,];tblGoods.GoodsNumber=[bl0001,];tblGoods.GoodsFullName=[叉烧包,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 09:21:03,840 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:21:03,840 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:21:03,841 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:21:03,841 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:21:03,841 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:21:03,841 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:21:03,841 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:21:03,842 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:21:03,842 Line:582 ReportDataMgt.getReportData 参数8:0000300001;0
 [DEBUG] 2017-12-20 09:21:03,842 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:21:03,844 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:21:03,866 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:21:03,866 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:21:03,866 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0000300001'))
 [DEBUG] 2017-12-20 09:21:03,867 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:21:03,867 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:21:03,867 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:21:03,867 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:21:03,867 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0000300001')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:21:03,868 Line:689 通过SQL读原始数据：28
 [DEBUG] 2017-12-20 09:21:03,869 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:22:57,432 Line:2992 MobileAjax 请求地址：/MobileAjax?op=detail
 [DEBUG] 2017-12-20 09:22:57,433 Line:3003 MobileAjax 操作人:admin;请求数据：op=[detail,];tableName=[tblSalesOrder,];
 [DEBUG] 2017-12-20 09:22:57,433 Line:243 AIOApi op=detail&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:22:57,599 Line:1525  select * from  tblSalesOrderDet where f_ref = 'null' order by detOrderNo
 [DEBUG] 2017-12-20 09:22:57,609 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"ERROR","msg":"记录不存在"}
 [DEBUG] 2017-12-20 09:22:59,330 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&tableName=tblSalesOrder
 [DEBUG] 2017-12-20 09:22:59,331 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];tableName=[tblSalesOrder,];pageNo=[1,];pageSize=[10,];src=[menu,];statusId=[,];BillNo=[,];BillDate1=[2009-12-31T16:00:00.000Z,];BillDate2=[2017-12-20T16:00:00.000Z,];workFlowNodeName=[,];
 [DEBUG] 2017-12-20 09:22:59,331 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:22:59,369 Line:549 ReportDataMgt.getReportData SQL=select keyId,createBy,deptCodeR,employeeId,deptCodeRE,BillDate,BillNo,ComFullName,ComNumber,DeptFullName,EmpFullName,ReceiveDate,TotalTaxAmount,CurTotalTaxAmount,SaleAmount,AccAmount,BackAmount,AccName,AlrAccAmt,sysName,id,statusId,Qty,OutQty,NotOut,Remark,CompanyCode,JAmount,JAmountz,InvoiceType,workFlowNodeName,workFlowNode,checkPersons,lastNodeID from ( select tblSalesOrder.id as keyId,tblSalesOrder.createBy as createBy,(select isnull(DepartmentCode,'') from tblEmployee where tblEmployee.id=tblSalesOrder.createBy) as deptCodeR,tblSalesOrder.employeeId as employeeId,tblSalesOrder.departmentCode as deptCodeRE, tblSalesOrder.workFlowNode as workFlowNode,tblSalesOrder.workFlowNodeName as workFlowNodeName,tblSalesOrder.checkPersons as checkPersons,(select lastNodeId from OAMyWorkFlow where OAMyWorkFlow.keyID=tblSalesOrder.id and OAMyWorkFlow.tableName='tblSalesOrder' and '1' = OAMyWorkFlow.lastCheckPerson and tblSalesOrder.workFlowNode!='-1' ) as lastNodeID,       tblSalesOrder.BillDate as BillDate,     tblSalesOrder.BillNo as BillNo,     tblCompany.ComFullName as ComFullName,     tblCompany.ComNumber as ComNumber,     tblDepartment.DeptFullName as DeptFullName,     tblEmployee1.EmpFullName as EmpFullName,     tblSalesOrder.ReceiveDate as ReceiveDate,     tblSalesOrder.TotalTaxAmount as TotalTaxAmount,     tblSalesOrder.CurTotalAmount as CurTotalTaxAmount,     isnull((select SUM(a.AfterChangeAmt) from tblSalesOutStockDet a,tblSalesOutStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0)-isnull((select SUM(a.TaxAmount) from tblSalesReturnStockDet a,tblSalesReturnStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0) as SaleAmount,     (select isnull(sum(a.TotalAlrAccAmt),0) from tblsalesoutstock a where a.SalesOrderID=tblSalesOrder.id and a.workFlowNodeName='finish') as AccAmount,     tblSalesOrder.BackAmount as BackAmount,     tblAccTypeInfo.AccName as AccName,     tblSalesOrder.AlrAccAmt as AlrAccAmt,     tblEmployee2.EmpFullName as sysName,     tblSalesOrder.id as id,     tblSalesOrder.statusId as statusId,     (select isnull(sum(Qty),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as Qty,     (select isnull(sum(isnull(case when OutQty<=0 then 0 else OutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as OutQty,     (select isnull(sum(isnull(case when NotOutQty<=0 then 0 else NotOutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as NotOut,     tblSalesOrder.Remark as Remark,     tblSalesOrder.CompanyCode as CompanyCode,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmount,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmountz,     tblSalesOrder.InvoiceType as InvoiceType   ,ROW_NUMBER() over(order by     tblSalesOrder.BillDate desc,    tblSalesOrder.BillNo desc) as row_id  from tblSalesOrder   left join tblCompany on tblCompany.classCode=tblSalesOrder.CompanyCode  left join tblDepartment on tblDepartment.classCode=tblSalesOrder.DepartmentCode  left join tblEmployee tblEmployee1 on tblEmployee1.id=tblSalesOrder.EmployeeID   left join tblEmployee tblEmployee2 on tblEmployee2.id=tblSalesOrder.createBy   left join tblAccTypeInfo on tblAccTypeInfo.AccNumber=tblSalesOrder.Account where 1=1 and isNull(tblSalesOrder.workFlowNodeName,'')!='print'        and (tblSalesOrder.BillDate >= ?)       and (tblSalesOrder.BillDate <= ?)                                                                    )  a  where row_id between 1 and 11 order by row_id
 [DEBUG] 2017-12-20 09:22:59,370 Line:582 ReportDataMgt.getReportData 参数1:2009-12-31T16:00:00.000Z
 [DEBUG] 2017-12-20 09:22:59,370 Line:582 ReportDataMgt.getReportData 参数2:2017-12-20T16:00:00.000Z
 [DEBUG] 2017-12-20 09:22:59,444 Line:689 通过SQL读原始数据：74
 [DEBUG] 2017-12-20 09:22:59,447 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 09:22:59,452 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["BillDate1","2009-12-31T16:00:00.000Z"],["BillDate2","2017-12-20T16:00:00.000Z"],["BillNo",""],["ComFullNamen",""],["ComName",""],["DeptFullName",""],["EmpFullName",""],["sysName",""],["statusId",""],["JAmount",""],["workFlowNodeName",""]],"cols":[["单据日期","70","date","","BillDate"],["单据编号","100","stringcall","","BillNo"],["客户全称","200","string","","ComFullName"],["客户编号","100","string","","ComNumber"],["部门","75","string","","DeptFullName"],["经手人","50","s等等！
 [DEBUG] 2017-12-20 09:22:59,786 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:22:59,787 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:22:59,787 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:22:59,788 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 09:22:59,802 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 09:23:01,295 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&tableName=tblSalesOrder
 [DEBUG] 2017-12-20 09:23:01,297 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];tableName=[tblSalesOrder,];pageNo=[1,];pageSize=[10,];src=[menu,];statusId=[,];BillNo=[,];BillDate1=[2009-12-31T16:00:00.000Z,];BillDate2=[2017-12-20T16:00:00.000Z,];workFlowNodeName=[,];
 [DEBUG] 2017-12-20 09:23:01,298 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:23:01,324 Line:549 ReportDataMgt.getReportData SQL=select keyId,createBy,deptCodeR,employeeId,deptCodeRE,BillDate,BillNo,ComFullName,ComNumber,DeptFullName,EmpFullName,ReceiveDate,TotalTaxAmount,CurTotalTaxAmount,SaleAmount,AccAmount,BackAmount,AccName,AlrAccAmt,sysName,id,statusId,Qty,OutQty,NotOut,Remark,CompanyCode,JAmount,JAmountz,InvoiceType,workFlowNodeName,workFlowNode,checkPersons,lastNodeID from ( select tblSalesOrder.id as keyId,tblSalesOrder.createBy as createBy,(select isnull(DepartmentCode,'') from tblEmployee where tblEmployee.id=tblSalesOrder.createBy) as deptCodeR,tblSalesOrder.employeeId as employeeId,tblSalesOrder.departmentCode as deptCodeRE, tblSalesOrder.workFlowNode as workFlowNode,tblSalesOrder.workFlowNodeName as workFlowNodeName,tblSalesOrder.checkPersons as checkPersons,(select lastNodeId from OAMyWorkFlow where OAMyWorkFlow.keyID=tblSalesOrder.id and OAMyWorkFlow.tableName='tblSalesOrder' and '1' = OAMyWorkFlow.lastCheckPerson and tblSalesOrder.workFlowNode!='-1' ) as lastNodeID,       tblSalesOrder.BillDate as BillDate,     tblSalesOrder.BillNo as BillNo,     tblCompany.ComFullName as ComFullName,     tblCompany.ComNumber as ComNumber,     tblDepartment.DeptFullName as DeptFullName,     tblEmployee1.EmpFullName as EmpFullName,     tblSalesOrder.ReceiveDate as ReceiveDate,     tblSalesOrder.TotalTaxAmount as TotalTaxAmount,     tblSalesOrder.CurTotalAmount as CurTotalTaxAmount,     isnull((select SUM(a.AfterChangeAmt) from tblSalesOutStockDet a,tblSalesOutStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0)-isnull((select SUM(a.TaxAmount) from tblSalesReturnStockDet a,tblSalesReturnStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0) as SaleAmount,     (select isnull(sum(a.TotalAlrAccAmt),0) from tblsalesoutstock a where a.SalesOrderID=tblSalesOrder.id and a.workFlowNodeName='finish') as AccAmount,     tblSalesOrder.BackAmount as BackAmount,     tblAccTypeInfo.AccName as AccName,     tblSalesOrder.AlrAccAmt as AlrAccAmt,     tblEmployee2.EmpFullName as sysName,     tblSalesOrder.id as id,     tblSalesOrder.statusId as statusId,     (select isnull(sum(Qty),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as Qty,     (select isnull(sum(isnull(case when OutQty<=0 then 0 else OutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as OutQty,     (select isnull(sum(isnull(case when NotOutQty<=0 then 0 else NotOutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as NotOut,     tblSalesOrder.Remark as Remark,     tblSalesOrder.CompanyCode as CompanyCode,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmount,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmountz,     tblSalesOrder.InvoiceType as InvoiceType   ,ROW_NUMBER() over(order by     tblSalesOrder.BillDate desc,    tblSalesOrder.BillNo desc) as row_id  from tblSalesOrder   left join tblCompany on tblCompany.classCode=tblSalesOrder.CompanyCode  left join tblDepartment on tblDepartment.classCode=tblSalesOrder.DepartmentCode  left join tblEmployee tblEmployee1 on tblEmployee1.id=tblSalesOrder.EmployeeID   left join tblEmployee tblEmployee2 on tblEmployee2.id=tblSalesOrder.createBy   left join tblAccTypeInfo on tblAccTypeInfo.AccNumber=tblSalesOrder.Account where 1=1 and isNull(tblSalesOrder.workFlowNodeName,'')!='print'        and (tblSalesOrder.BillDate >= ?)       and (tblSalesOrder.BillDate <= ?)                                                                    )  a  where row_id between 1 and 11 order by row_id
 [DEBUG] 2017-12-20 09:23:01,325 Line:582 ReportDataMgt.getReportData 参数1:2009-12-31T16:00:00.000Z
 [DEBUG] 2017-12-20 09:23:01,326 Line:582 ReportDataMgt.getReportData 参数2:2017-12-20T16:00:00.000Z
 [DEBUG] 2017-12-20 09:23:01,331 Line:689 通过SQL读原始数据：6
 [DEBUG] 2017-12-20 09:23:01,334 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 09:23:01,340 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["BillDate1","2009-12-31T16:00:00.000Z"],["BillDate2","2017-12-20T16:00:00.000Z"],["BillNo",""],["ComFullNamen",""],["ComName",""],["DeptFullName",""],["EmpFullName",""],["sysName",""],["statusId",""],["JAmount",""],["workFlowNodeName",""]],"cols":[["单据日期","70","date","","BillDate"],["单据编号","100","stringcall","","BillNo"],["客户全称","200","string","","ComFullName"],["客户编号","100","string","","ComNumber"],["部门","75","string","","DeptFullName"],["经手人","50","s等等！
 [DEBUG] 2017-12-20 09:23:02,870 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&tableName=tblSalesOrder
 [DEBUG] 2017-12-20 09:23:02,872 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];tableName=[tblSalesOrder,];pageNo=[2,];pageSize=[10,];src=[menu,];statusId=[,];BillNo=[,];BillDate1=[2009-12-31T16:00:00.000Z,];BillDate2=[2017-12-20T16:00:00.000Z,];workFlowNodeName=[,];
 [DEBUG] 2017-12-20 09:23:02,873 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:23:02,903 Line:549 ReportDataMgt.getReportData SQL=select keyId,createBy,deptCodeR,employeeId,deptCodeRE,BillDate,BillNo,ComFullName,ComNumber,DeptFullName,EmpFullName,ReceiveDate,TotalTaxAmount,CurTotalTaxAmount,SaleAmount,AccAmount,BackAmount,AccName,AlrAccAmt,sysName,id,statusId,Qty,OutQty,NotOut,Remark,CompanyCode,JAmount,JAmountz,InvoiceType,workFlowNodeName,workFlowNode,checkPersons,lastNodeID from ( select tblSalesOrder.id as keyId,tblSalesOrder.createBy as createBy,(select isnull(DepartmentCode,'') from tblEmployee where tblEmployee.id=tblSalesOrder.createBy) as deptCodeR,tblSalesOrder.employeeId as employeeId,tblSalesOrder.departmentCode as deptCodeRE, tblSalesOrder.workFlowNode as workFlowNode,tblSalesOrder.workFlowNodeName as workFlowNodeName,tblSalesOrder.checkPersons as checkPersons,(select lastNodeId from OAMyWorkFlow where OAMyWorkFlow.keyID=tblSalesOrder.id and OAMyWorkFlow.tableName='tblSalesOrder' and '1' = OAMyWorkFlow.lastCheckPerson and tblSalesOrder.workFlowNode!='-1' ) as lastNodeID,       tblSalesOrder.BillDate as BillDate,     tblSalesOrder.BillNo as BillNo,     tblCompany.ComFullName as ComFullName,     tblCompany.ComNumber as ComNumber,     tblDepartment.DeptFullName as DeptFullName,     tblEmployee1.EmpFullName as EmpFullName,     tblSalesOrder.ReceiveDate as ReceiveDate,     tblSalesOrder.TotalTaxAmount as TotalTaxAmount,     tblSalesOrder.CurTotalAmount as CurTotalTaxAmount,     isnull((select SUM(a.AfterChangeAmt) from tblSalesOutStockDet a,tblSalesOutStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0)-isnull((select SUM(a.TaxAmount) from tblSalesReturnStockDet a,tblSalesReturnStock b where a.SalesOrderID=tblSalesOrder.id and a.f_ref=b.id and b.workFlowNodeName='finish'),0) as SaleAmount,     (select isnull(sum(a.TotalAlrAccAmt),0) from tblsalesoutstock a where a.SalesOrderID=tblSalesOrder.id and a.workFlowNodeName='finish') as AccAmount,     tblSalesOrder.BackAmount as BackAmount,     tblAccTypeInfo.AccName as AccName,     tblSalesOrder.AlrAccAmt as AlrAccAmt,     tblEmployee2.EmpFullName as sysName,     tblSalesOrder.id as id,     tblSalesOrder.statusId as statusId,     (select isnull(sum(Qty),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as Qty,     (select isnull(sum(isnull(case when OutQty<=0 then 0 else OutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as OutQty,     (select isnull(sum(isnull(case when NotOutQty<=0 then 0 else NotOutQty end,0)),0) from tblsalesOrderDet where tblsalesOrderDet.f_ref=tblSalesOrder.id) as NotOut,     tblSalesOrder.Remark as Remark,     tblSalesOrder.CompanyCode as CompanyCode,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmount,     abs(isnull(tblSalesOrder.TotalTaxAmount,0)-isnull(tblSalesOrder.BackAmount,0)) as JAmountz,     tblSalesOrder.InvoiceType as InvoiceType   ,ROW_NUMBER() over(order by     tblSalesOrder.BillDate desc,    tblSalesOrder.BillNo desc) as row_id  from tblSalesOrder   left join tblCompany on tblCompany.classCode=tblSalesOrder.CompanyCode  left join tblDepartment on tblDepartment.classCode=tblSalesOrder.DepartmentCode  left join tblEmployee tblEmployee1 on tblEmployee1.id=tblSalesOrder.EmployeeID   left join tblEmployee tblEmployee2 on tblEmployee2.id=tblSalesOrder.createBy   left join tblAccTypeInfo on tblAccTypeInfo.AccNumber=tblSalesOrder.Account where 1=1 and isNull(tblSalesOrder.workFlowNodeName,'')!='print'        and (tblSalesOrder.BillDate >= ?)       and (tblSalesOrder.BillDate <= ?)                                                                    )  a  where row_id between 11 and 21 order by row_id
 [DEBUG] 2017-12-20 09:23:02,903 Line:582 ReportDataMgt.getReportData 参数1:2009-12-31T16:00:00.000Z
 [DEBUG] 2017-12-20 09:23:02,904 Line:582 ReportDataMgt.getReportData 参数2:2017-12-20T16:00:00.000Z
 [DEBUG] 2017-12-20 09:23:02,932 Line:689 通过SQL读原始数据：29
 [DEBUG] 2017-12-20 09:23:02,949 Line:1391 整理数据：17
 [DEBUG] 2017-12-20 09:23:02,951 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["BillDate1","2009-12-31T16:00:00.000Z"],["BillDate2","2017-12-20T16:00:00.000Z"],["BillNo",""],["ComFullNamen",""],["ComName",""],["DeptFullName",""],["EmpFullName",""],["sysName",""],["statusId",""],["JAmount",""],["workFlowNodeName",""]],"cols":[["单据日期","70","date","","BillDate"],["单据编号","100","stringcall","","BillNo"],["客户全称","200","string","","ComFullName"],["客户编号","100","string","","ComNumber"],["部门","75","string","","DeptFullName"],["经手人","50","s等等！
 [DEBUG] 2017-12-20 09:23:28,348 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:23:28,350 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 09:23:28,350 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:23:28,350 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:23:28,351 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:23:28,351 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:23:28,352 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 09:23:28,366 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 09:23:28,399 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:23:28,400 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:23:28,401 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:23:28,401 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:23:28,401 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:23:28,401 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:23:28,402 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:23:28,403 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:23:28,403 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:23:28,403 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:23:28,403 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:23:28,404 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:23:28,510 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:23:28,510 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:23:28,511 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:23:28,511 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:23:28,511 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:23:28,511 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:23:28,511 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:23:28,511 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:23:28,512 Line:689 通过SQL读原始数据：112
 [DEBUG] 2017-12-20 09:23:28,512 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:23:28,518 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:23:29,864 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:23:29,866 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:23:29,866 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:23:29,945 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:23:29,946 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:23:29,946 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:23:29,946 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:23:29,947 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:23:29,947 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:23:29,947 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:23:29,948 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:23:29,948 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:23:29,948 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:23:29,948 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:23:29,949 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:23:29,949 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:23:29,949 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:23:29,950 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:23:29,950 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:23:29,950 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:23:29,951 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:23:30,029 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:23:30,029 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:23:30,029 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:23:30,029 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:23:30,031 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:23:30,031 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:23:30,031 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:23:30,031 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:23:30,032 Line:689 通过SQL读原始数据：86
 [DEBUG] 2017-12-20 09:23:30,033 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:23:30,053 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:38:01,810 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 09:39:05,223 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:39:05,224 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:39:05,225 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 09:39:05,225 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:39:05,225 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:39:05,225 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:39:05,226 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 09:39:05,241 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 09:39:05,260 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:39:05,261 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:39:05,261 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:39:05,261 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:39:05,261 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:39:05,261 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:39:05,261 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:39:05,262 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:39:05,263 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:39:05,263 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:39:05,263 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:39:05,263 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:39:05,363 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:39:05,364 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:39:05,364 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:39:05,364 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:39:05,364 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:39:05,364 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:39:05,365 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:39:05,365 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:39:05,365 Line:689 通过SQL读原始数据：105
 [DEBUG] 2017-12-20 09:39:05,366 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:39:05,371 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:39:06,732 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:39:06,734 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:39:06,734 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:39:06,757 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:39:06,759 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:39:06,760 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:39:06,760 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:39:06,760 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:39:06,761 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:39:06,761 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:39:06,762 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:39:06,762 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:39:06,763 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:39:06,763 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:39:06,764 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:39:06,764 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:39:06,765 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:39:06,765 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:39:06,765 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:39:06,766 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:39:06,766 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:39:06,783 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:39:06,784 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:39:06,784 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:39:06,784 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:39:06,784 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:39:06,784 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:39:06,784 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:39:06,785 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:39:06,785 Line:689 通过SQL读原始数据：26
 [DEBUG] 2017-12-20 09:39:06,786 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:39:06,793 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:41:27,209 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:41:27,210 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:41:27,210 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:41:27,243 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:41:27,243 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:41:27,244 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:41:27,244 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:41:27,244 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:41:27,244 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:41:27,244 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:41:27,244 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:41:27,244 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:41:27,245 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:41:27,246 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:41:27,383 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:41:27,383 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:41:27,383 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:27,383 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:27,383 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:41:27,384 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:27,384 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:41:27,384 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:41:27,385 Line:689 通过SQL读原始数据：142
 [DEBUG] 2017-12-20 09:41:27,385 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:41:27,394 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:41:31,483 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 09:41:31,484 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 09:41:31,485 Line:243 AIOApi op=getSessEmp&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:41:31,486 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 09:41:31,511 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 09:41:31,512 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 09:41:31,512 Line:243 AIOApi op=getEnum&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:41:31,513 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 09:41:36,787 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:41:36,787 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:41:36,788 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:41:36,788 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 09:41:36,788 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:41:36,788 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:41:36,789 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 09:41:36,797 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:41:36,798 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:41:36,798 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:41:36,798 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:41:36,798 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:41:36,799 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:41:36,799 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 09:41:36,799 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:41:36,799 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:41:36,799 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:41:36,799 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:41:36,800 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:41:36,800 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:41:36,800 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:41:36,800 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:41:36,800 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:41:36,800 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:41:36,801 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:41:36,801 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 09:41:36,821 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:41:36,822 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:41:36,822 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:36,822 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:36,822 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:41:36,822 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:36,822 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:41:36,823 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:41:36,823 Line:689 通过SQL读原始数据：25
 [DEBUG] 2017-12-20 09:41:36,823 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:41:36,829 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:41:38,300 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:41:38,302 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:41:38,303 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:41:38,331 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:41:38,332 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:41:38,333 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:41:38,333 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:41:38,334 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:41:38,334 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:41:38,335 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:41:38,336 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:41:38,337 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:41:38,338 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:41:38,339 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:41:38,339 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:41:38,340 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:41:38,341 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:41:38,341 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:41:38,342 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:41:38,343 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:41:38,343 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:41:38,348 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:41:38,349 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:41:38,350 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:38,350 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:38,351 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:41:38,351 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:41:38,352 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:41:38,353 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:41:38,355 Line:689 通过SQL读原始数据：23
 [DEBUG] 2017-12-20 09:41:38,358 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 09:41:38,382 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:51:37,076 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:51:37,077 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 09:51:37,078 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:51:37,078 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 09:51:37,079 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 09:51:37,079 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:51:37,080 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 09:51:37,093 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 09:51:37,121 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:51:37,122 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:51:37,122 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 09:51:37,123 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:51:37,124 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:51:37,124 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:51:37,125 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 09:51:37,126 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:51:37,126 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:51:37,126 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:51:37,126 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:51:37,126 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:51:37,126 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:51:37,127 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:51:37,127 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:51:37,127 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:51:37,127 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:51:37,127 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:51:37,272 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:51:37,275 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:51:37,276 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:51:37,277 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:51:37,277 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:51:37,286 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:51:37,287 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:51:37,287 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:51:37,288 Line:689 通过SQL读原始数据：166
 [DEBUG] 2017-12-20 09:51:37,290 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 09:51:37,301 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:51:38,588 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:51:38,590 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 09:51:38,591 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:51:38,614 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:51:38,615 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:51:38,616 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:51:38,616 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:51:38,617 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:51:38,617 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:51:38,617 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:51:38,618 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:51:38,618 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:51:38,618 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:51:38,618 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:51:38,618 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:51:38,619 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:51:38,619 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:51:38,619 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:51:38,619 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:51:38,620 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:51:38,620 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:51:38,650 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:51:38,651 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:51:38,651 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:51:38,651 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:51:38,651 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:51:38,651 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:51:38,651 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:51:38,652 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:51:38,652 Line:689 通过SQL读原始数据：37
 [DEBUG] 2017-12-20 09:51:38,653 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:51:38,666 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:54:09,086 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:09,087 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[0,];
 [DEBUG] 2017-12-20 09:54:09,087 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:09,118 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:09,120 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:09,121 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:09,122 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:09,122 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:09,122 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:09,123 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:09,123 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:09,123 Line:582 ReportDataMgt.getReportData 参数8:0
 [DEBUG] 2017-12-20 09:54:09,123 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:09,123 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:09,123 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:09,124 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:09,124 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:09,124 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:09,124 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:09,124 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:09,124 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:09,234 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:09,236 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[00,];
 [DEBUG] 2017-12-20 09:54:09,236 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:09,243 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:09,243 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:09,244 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0'))
 [DEBUG] 2017-12-20 09:54:09,244 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,244 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:09,244 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,244 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:09,244 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:09,245 Line:689 通过SQL读原始数据：125
 [DEBUG] 2017-12-20 09:54:09,245 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:09,246 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","0"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账等等！
 [DEBUG] 2017-12-20 09:54:09,248 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:09,249 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:09,249 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:09,250 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:09,250 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:09,250 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:09,250 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:09,250 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数8:00
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:09,251 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:09,252 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:09,252 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:09,252 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:09,273 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:09,274 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:09,274 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('00'))
 [DEBUG] 2017-12-20 09:54:09,274 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,274 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:09,274 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,275 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:09,275 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('00')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:09,275 Line:689 通过SQL读原始数据：26
 [DEBUG] 2017-12-20 09:54:09,275 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:09,276 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","00"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过等等！
 [DEBUG] 2017-12-20 09:54:09,421 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:09,423 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[000,];
 [DEBUG] 2017-12-20 09:54:09,424 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:09,446 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:09,447 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:09,447 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:09,447 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:09,447 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:09,447 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:09,447 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数8:000
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:09,448 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:09,449 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:09,449 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:09,449 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:09,449 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('000'))
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:09,466 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('000')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:09,466 Line:689 通过SQL读原始数据：20
 [DEBUG] 2017-12-20 09:54:09,466 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:09,468 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","000"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未等等！
 [DEBUG] 2017-12-20 09:54:09,587 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:09,588 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[0000,];
 [DEBUG] 2017-12-20 09:54:09,589 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:09,615 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:09,616 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:09,616 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:09,617 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:09,618 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:09,618 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:09,619 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:09,620 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:09,621 Line:582 ReportDataMgt.getReportData 参数8:0000
 [DEBUG] 2017-12-20 09:54:09,622 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:09,623 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:09,623 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:09,623 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:09,624 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:09,624 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:09,625 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:09,625 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:09,625 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:09,642 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:09,643 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:09,643 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0000'))
 [DEBUG] 2017-12-20 09:54:09,643 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,643 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:09,643 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:09,644 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:09,644 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0000')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:09,644 Line:689 通过SQL读原始数据：28
 [DEBUG] 2017-12-20 09:54:09,644 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:09,645 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","0000"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库等等！
 [DEBUG] 2017-12-20 09:54:10,725 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:10,727 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[00003,];
 [DEBUG] 2017-12-20 09:54:10,728 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:10,747 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:10,748 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:10,748 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:10,749 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:10,749 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:10,749 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:10,750 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:10,750 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:10,750 Line:582 ReportDataMgt.getReportData 参数8:00003
 [DEBUG] 2017-12-20 09:54:10,751 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:10,751 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:10,752 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:10,752 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:10,753 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:10,754 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:10,755 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:10,755 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:10,756 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:10,791 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:10,791 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:10,792 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('00003'))
 [DEBUG] 2017-12-20 09:54:10,792 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:10,792 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:10,792 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:10,793 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:10,793 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('00003')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:10,793 Line:689 通过SQL读原始数据：45
 [DEBUG] 2017-12-20 09:54:10,794 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 09:54:10,798 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","00003"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入等等！
 [DEBUG] 2017-12-20 09:54:13,475 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:13,476 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[000030,];
 [DEBUG] 2017-12-20 09:54:13,476 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:13,484 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:13,485 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:13,485 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:13,485 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:13,486 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:13,486 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:13,486 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:13,486 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:13,486 Line:582 ReportDataMgt.getReportData 参数8:000030
 [DEBUG] 2017-12-20 09:54:13,487 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:13,487 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:13,487 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:13,487 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:13,487 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:13,488 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:13,488 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:13,488 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:13,488 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:13,506 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:13,506 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:13,506 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('000030'))
 [DEBUG] 2017-12-20 09:54:13,506 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:13,507 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:13,507 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:13,507 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:13,507 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('000030')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:13,507 Line:689 通过SQL读原始数据：22
 [DEBUG] 2017-12-20 09:54:13,507 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:13,509 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","000030"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["等等！
 [DEBUG] 2017-12-20 09:54:13,675 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:13,676 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[0000300,];
 [DEBUG] 2017-12-20 09:54:13,676 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:13,688 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:13,689 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:13,689 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:13,689 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:13,690 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:13,690 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:13,690 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:13,690 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:13,690 Line:582 ReportDataMgt.getReportData 参数8:0000300
 [DEBUG] 2017-12-20 09:54:13,690 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:13,690 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:13,691 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:13,707 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:13,707 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:13,707 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0000300'))
 [DEBUG] 2017-12-20 09:54:13,707 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:13,708 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:13,708 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:13,708 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:13,708 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0000300')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:13,708 Line:689 通过SQL读原始数据：19
 [DEBUG] 2017-12-20 09:54:13,708 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:13,709 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","0000300"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],[等等！
 [DEBUG] 2017-12-20 09:54:13,878 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:13,879 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[00003000,];
 [DEBUG] 2017-12-20 09:54:13,880 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:13,892 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:13,892 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:13,892 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:13,892 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:13,893 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:13,893 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:13,893 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:13,893 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:13,893 Line:582 ReportDataMgt.getReportData 参数8:00003000
 [DEBUG] 2017-12-20 09:54:13,893 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:13,893 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:13,894 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:13,909 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:13,910 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:13,910 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('00003000'))
 [DEBUG] 2017-12-20 09:54:13,910 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:13,910 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:13,910 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:13,910 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:13,911 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('00003000')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:13,911 Line:689 通过SQL读原始数据：19
 [DEBUG] 2017-12-20 09:54:13,911 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:13,912 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","00003000"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],等等！
 [DEBUG] 2017-12-20 09:54:14,067 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:14,072 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[000030000,];
 [DEBUG] 2017-12-20 09:54:14,073 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:14,099 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:14,100 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:14,100 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:14,100 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:14,100 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:14,100 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:14,100 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:14,100 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:14,101 Line:582 ReportDataMgt.getReportData 参数8:000030000
 [DEBUG] 2017-12-20 09:54:14,101 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:14,102 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:14,102 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:14,103 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:14,103 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:14,103 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:14,104 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:14,104 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:14,105 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:14,122 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:14,122 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:14,125 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('000030000'))
 [DEBUG] 2017-12-20 09:54:14,126 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:14,126 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:14,126 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:14,126 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:14,127 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('000030000')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:14,127 Line:689 通过SQL读原始数据：28
 [DEBUG] 2017-12-20 09:54:14,127 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:14,129 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","000030000"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"]等等！
 [DEBUG] 2017-12-20 09:54:14,902 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:54:14,903 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[0000300001,];
 [DEBUG] 2017-12-20 09:54:14,903 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:54:14,934 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:54:14,936 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:54:14,937 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:54:14,938 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:54:14,938 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:54:14,938 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:54:14,938 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:54:14,938 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:54:14,939 Line:582 ReportDataMgt.getReportData 参数8:0000300001
 [DEBUG] 2017-12-20 09:54:14,939 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:54:14,939 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:54:14,939 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:54:14,939 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:54:14,939 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:54:14,940 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:54:14,940 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:54:14,940 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:54:14,940 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:54:15,028 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0000300001'))
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:54:15,029 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0000300001')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:54:15,030 Line:689 通过SQL读原始数据：95
 [DEBUG] 2017-12-20 09:54:15,030 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:54:15,033 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","0000300001"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"等等！
 [DEBUG] 2017-12-20 09:55:28,107 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 09:55:28,107 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];GoodsCode=[,];
 [DEBUG] 2017-12-20 09:55:28,107 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 09:55:28,129 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 09:55:28,129 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 09:55:28,129 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 09:55:28,130 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 09:55:28,130 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 09:55:28,130 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 09:55:28,130 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 09:55:28,130 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 09:55:28,130 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 09:55:28,130 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 09:55:28,131 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 09:55:28,173 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 09:55:28,174 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 09:55:28,175 Line:689 通过SQL读原始数据：46
 [DEBUG] 2017-12-20 09:55:28,175 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 09:55:28,180 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall","","lastQty"],["入库未过账"等等！
 [DEBUG] 2017-12-20 09:55:35,762 Line:135 BaseAction.execute 请求地址：/AdvanceAction.do?src=menu&winCurIndex=2
 [DEBUG] 2017-12-20 09:55:35,763 Line:146 BaseAction.execute 操作人:admin;请求数据：src=[menu,];winCurIndex=[2,];
 [DEBUG] 2017-12-20 09:55:35,763 Line:215 ---------->SET Page 2 DEFAULT URL = /AdvanceAction.do
 [DEBUG] 2017-12-20 09:55:36,714 Line:135 BaseAction.execute 请求地址：/AdvanceAction.do?optype=index
 [DEBUG] 2017-12-20 09:55:36,714 Line:146 BaseAction.execute 操作人:admin;请求数据：optype=[index,];
 [DEBUG] 2017-12-20 09:55:38,025 Line:135 BaseAction.execute 请求地址：/CustomQueryAction.do?src=menu&winCurIndex=3
 [DEBUG] 2017-12-20 09:55:38,025 Line:146 BaseAction.execute 操作人:admin;请求数据：src=[menu,];winCurIndex=[3,];
 [DEBUG] 2017-12-20 09:55:38,025 Line:215 ---------->SET Page 3 DEFAULT URL = /CustomQueryAction.do
 [DEBUG] 2017-12-20 09:55:40,860 Line:135 BaseAction.execute 请求地址：/ReportSetQueryAction.do?src=menu&winCurIndex=4
 [DEBUG] 2017-12-20 09:55:40,860 Line:146 BaseAction.execute 操作人:admin;请求数据：src=[menu,];winCurIndex=[4,];
 [DEBUG] 2017-12-20 09:55:40,861 Line:215 ---------->SET Page 4 DEFAULT URL = /ReportSetQueryAction.do
 [DEBUG] 2017-12-20 09:55:47,877 Line:135 BaseAction.execute 请求地址：/ReportSetQueryAction.do
 [DEBUG] 2017-12-20 09:55:47,878 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];org.apache.struts.taglib.html.TOKEN=[,];winCurIndex=[4,4,];styleType=[,];reportNames=[虚拟库存查询,];statusIds=[0,];reportType=[,];reportModule=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 09:55:51,336 Line:135 BaseAction.execute 请求地址：/ReportSetAction.do?operation=7&keyId=fc26a1c0_0911091911043430204&winCurIndex=4&reportNames=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2
 [DEBUG] 2017-12-20 09:55:51,337 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[7,];keyId=[fc26a1c0_0911091911043430204,];winCurIndex=[4,];reportNames=[è??????????????è??,];
 [DEBUG] 2017-12-20 09:55:55,383 Line:135 BaseAction.execute 请求地址：/ReportSetQueryAction.do?winCurIndex=4&reportNames=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2
 [DEBUG] 2017-12-20 09:55:55,384 Line:146 BaseAction.execute 操作人:admin;请求数据：winCurIndex=[4,];reportNames=[è??????????????è??,];
 [DEBUG] 2017-12-20 10:03:13,050 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:03:13,050 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[100,];src=[menu,];DataType=[tblGoods,];parentCode=[00003,];
 [DEBUG] 2017-12-20 10:03:13,051 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:13,051 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 10:03:13,052 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 10:03:13,052 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:13,053 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 10:03:13,078 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 10:03:13,122 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 10:03:13,123 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:03:13,123 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:03:13,123 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:03:13,123 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:03:13,123 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:03:13,123 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:03:13,124 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:03:13,125 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:03:13,125 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:03:13,125 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:03:13,125 Line:582 ReportDataMgt.getReportData 参数17:
 [ERROR] 2017-12-20 10:03:13,129 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 过程或函数 'report_VirtualStock' 需要参数 '@GoodsFullName'，但未提供该参数。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:197)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1493)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:390)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:340)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4575)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:179)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:154)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:283)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:584)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.mobile.AIOApi.report(AIOApi.java:2296)
	at com.menyi.aio.web.mobile.AIOApi.service(AIOApi.java:261)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:314)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:03:13,141 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"ERROR","msg":"Error Canst id\u003d -1002"}
 [DEBUG] 2017-12-20 10:03:14,568 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:03:14,570 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:03:14,571 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:14,601 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 10:03:14,603 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:03:14,604 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:03:14,604 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:03:14,605 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:03:14,606 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:03:14,606 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:03:14,607 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:03:14,608 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:03:14,608 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:03:14,609 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:03:14,610 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:03:14,610 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:03:14,611 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:03:14,611 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:03:14,612 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:03:14,613 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:03:14,613 Line:582 ReportDataMgt.getReportData 参数17:
 [ERROR] 2017-12-20 10:03:14,620 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 过程或函数 'report_VirtualStock' 需要参数 '@GoodsFullName'，但未提供该参数。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:197)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1493)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:390)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:340)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4575)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:179)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:154)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:283)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:584)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.mobile.AIOApi.report(AIOApi.java:2296)
	at com.menyi.aio.web.mobile.AIOApi.service(AIOApi.java:261)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:314)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:03:14,624 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"ERROR","msg":"Error Canst id\u003d -1002"}
 [DEBUG] 2017-12-20 10:03:26,397 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 10:03:26,397 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 10:03:26,398 Line:243 AIOApi op=getSessEmp&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:26,398 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 10:03:26,418 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 10:03:26,419 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 10:03:26,419 Line:243 AIOApi op=getEnum&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:26,421 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 10:03:28,491 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 10:03:28,493 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 10:03:28,493 Line:243 AIOApi op=getSessEmp&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:28,494 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 10:03:28,510 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 10:03:28,511 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 10:03:28,511 Line:243 AIOApi op=getEnum&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:03:28,512 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 10:03:54,769 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=getTablList&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9697C45513436F726F11A9149AA833C7396
 [DEBUG] 2017-12-20 10:03:54,832 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=getSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9697C45513436F726F11A9149AA833C7396
 [DEBUG] 2017-12-20 10:03:55,612 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=getSysType&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9697C45513436F726F10A1BB597E5395919&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9697C45513436F726F10A1BB597E5395919
 [DEBUG] 2017-12-20 10:04:37,691 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9696D6A24C45E81C0D07686458C02F7B7F6
 [DEBUG] 2017-12-20 10:04:50,943 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:04:50,943 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[1,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:{call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}@ParamList:@Param:@Param:0000300001;0@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[0000300001,];hide_GoodsCode=[0000300001#;#0#;#bl0001#;#叉烧包#;##;##;#,];tblGoods.GoodsNumber=[bl0001,];tblGoods.GoodsFullName=[叉烧包,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:04:50,998 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@GoodsNumber=?,@GoodsFullName=?,@GoodsSpec=?,@BaseUnit=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 10:04:50,998 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:04:50,998 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:04:50,998 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:04:50,999 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:04:50,999 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:04:50,999 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:04:50,999 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:04:50,999 Line:582 ReportDataMgt.getReportData 参数8:0000300001;0
 [DEBUG] 2017-12-20 10:04:51,000 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:04:51,000 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:04:51,000 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:04:51,000 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:04:51,001 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:04:51,001 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:04:51,001 Line:582 ReportDataMgt.getReportData 参数15:
 [DEBUG] 2017-12-20 10:04:51,002 Line:582 ReportDataMgt.getReportData 参数16:
 [DEBUG] 2017-12-20 10:04:51,002 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:04:51,003 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:04:51,003 Line:582 ReportDataMgt.getReportData 参数19:0
 [DEBUG] 2017-12-20 10:04:51,003 Line:582 ReportDataMgt.getReportData 参数20:tblGoods
 [DEBUG] 2017-12-20 10:04:51,004 Line:582 ReportDataMgt.getReportData 参数21:
 [ERROR] 2017-12-20 10:04:51,007 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 为过程或函数 report_VirtualStock 指定了过多的参数。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:197)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1493)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:390)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:340)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4575)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:179)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:154)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:283)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:584)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.report.ReportDataAction.showData(ReportDataAction.java:435)
	at com.menyi.aio.web.report.ReportDataAction.exe(ReportDataAction.java:98)
	at com.menyi.web.util.BaseAction.execute(BaseAction.java:264)
	at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
	at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
	at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:304)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:646)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:05:04,363 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC96989FDFBBDB446BCC31A9149AA833C7396
 [DEBUG] 2017-12-20 10:05:12,165 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=5
 [DEBUG] 2017-12-20 10:05:12,165 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[5,];
 [DEBUG] 2017-12-20 10:05:12,165 Line:215 ---------->SET Page 5 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:05:12,196 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:05:12,196 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:05:12,197 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:05:12,198 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=5&checkTab=Y
 [DEBUG] 2017-12-20 10:05:12,198 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[5,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:05:12,199 Line:215 ---------->SET Page 5 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:05:14,106 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:05:14,107 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[5,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:05:14,121 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?)}
 [DEBUG] 2017-12-20 10:05:14,122 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:05:14,122 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:05:14,122 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:05:14,122 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:05:14,122 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:05:14,123 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:05:14,123 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:05:14,123 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:05:14,124 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:05:14,124 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:05:14,125 Line:582 ReportDataMgt.getReportData 参数17:
 [ERROR] 2017-12-20 10:05:14,127 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 过程或函数 'report_VirtualStock' 需要参数 '@GoodsFullName'，但未提供该参数。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:197)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1493)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:390)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:340)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4575)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:179)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:154)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:283)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:584)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.report.ReportDataAction.showData(ReportDataAction.java:435)
	at com.menyi.aio.web.report.ReportDataAction.exe(ReportDataAction.java:98)
	at com.menyi.web.util.BaseAction.execute(BaseAction.java:264)
	at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
	at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
	at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:304)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:646)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:06:44,590 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC969F064D0B4038ABC9F1A9149AA833C7396
 [DEBUG] 2017-12-20 10:06:54,282 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=6
 [DEBUG] 2017-12-20 10:06:54,283 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[6,];
 [DEBUG] 2017-12-20 10:06:54,283 Line:215 ---------->SET Page 6 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:06:54,339 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:06:54,340 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:06:54,340 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:06:54,341 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=6&checkTab=Y
 [DEBUG] 2017-12-20 10:06:54,341 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[6,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:06:54,341 Line:215 ---------->SET Page 6 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:06:55,624 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:06:55,625 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[6,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];GoodsFullName2=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:06:55,638 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:06:55,638 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:06:55,639 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:06:55,639 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:06:55,639 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:06:55,639 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:06:55,639 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:06:55,639 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:06:55,640 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:06:55,641 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:06:55,641 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:06:55,641 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:06:55,641 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:06:55,714 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:06:55,714 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:06:55,714 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:06:55,715 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:06:55,715 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:06:55,715 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:06:55,715 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:06:55,715 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [ERROR] 2017-12-20 10:06:55,716 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 列名 GoodsFullName2 无效。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(SQLServerException.java:171)
	at com.microsoft.sqlserver.jdbc.SQLServerResultSet.findColumn(SQLServerResultSet.java:625)
	at com.microsoft.sqlserver.jdbc.SQLServerResultSet.getString(SQLServerResultSet.java:2300)
	at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getString(DelegatingResultSet.java:263)
	at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getString(DelegatingResultSet.java:263)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:600)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.report.ReportDataAction.showData(ReportDataAction.java:435)
	at com.menyi.aio.web.report.ReportDataAction.exe(ReportDataAction.java:98)
	at com.menyi.web.util.BaseAction.execute(BaseAction.java:264)
	at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
	at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
	at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:304)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:646)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:08:10,373 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9691947C5FE21A3C5578AD219FA989EC390
 [DEBUG] 2017-12-20 10:08:18,532 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=7
 [DEBUG] 2017-12-20 10:08:18,532 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[7,];
 [DEBUG] 2017-12-20 10:08:18,532 Line:215 ---------->SET Page 7 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:08:18,584 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:08:18,585 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:08:18,585 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=7&checkTab=Y
 [DEBUG] 2017-12-20 10:08:18,585 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:08:18,586 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[7,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:08:18,586 Line:215 ---------->SET Page 7 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:08:21,438 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:08:21,439 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[7,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];GoodsFullName2=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:08:21,451 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:08:21,451 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:08:21,451 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:08:21,451 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:08:21,452 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:08:21,452 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:08:21,452 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:08:21,452 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:08:21,452 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:08:21,452 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:08:21,452 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:08:21,453 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:08:21,453 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:08:21,453 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:08:21,453 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:08:21,453 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:08:21,453 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:08:21,454 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:08:21,454 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:08:21,522 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 10:08:21,529 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:08:21,529 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:08:21,529 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:08:21,529 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:08:21,529 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:08:21,530 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:08:21,530 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:08:21,530 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [ERROR] 2017-12-20 10:08:21,530 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 列名 GoodsFullName2 无效。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(SQLServerException.java:171)
	at com.microsoft.sqlserver.jdbc.SQLServerResultSet.findColumn(SQLServerResultSet.java:625)
	at com.microsoft.sqlserver.jdbc.SQLServerResultSet.getString(SQLServerResultSet.java:2300)
	at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getString(DelegatingResultSet.java:263)
	at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getString(DelegatingResultSet.java:263)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:600)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.report.ReportDataAction.showData(ReportDataAction.java:435)
	at com.menyi.aio.web.report.ReportDataAction.exe(ReportDataAction.java:98)
	at com.menyi.web.util.BaseAction.execute(BaseAction.java:264)
	at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
	at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
	at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:304)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:646)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:08:28,004 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&winCurIndex=7&checkTab=Y
 [DEBUG] 2017-12-20 10:08:28,005 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];winCurIndex=[7,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:08:28,012 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:08:28,013 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:08:28,013 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:08:28,013 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:08:28,013 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:08:28,013 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:08:28,014 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:08:28,015 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:08:28,015 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:08:28,015 Line:582 ReportDataMgt.getReportData 参数15:
 [DEBUG] 2017-12-20 10:08:28,015 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:08:28,015 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:08:28,015 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:08:28,033 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:08:28,034 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:08:28,034 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:08:28,034 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:08:28,034 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:08:28,034 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:08:28,034 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:08:28,035 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1
 [ERROR] 2017-12-20 10:08:28,035 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 列名 GoodsFullName2 无效。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDriverError(SQLServerException.java:171)
	at com.microsoft.sqlserver.jdbc.SQLServerResultSet.findColumn(SQLServerResultSet.java:625)
	at com.microsoft.sqlserver.jdbc.SQLServerResultSet.getString(SQLServerResultSet.java:2300)
	at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getString(DelegatingResultSet.java:263)
	at org.apache.tomcat.dbcp.dbcp.DelegatingResultSet.getString(DelegatingResultSet.java:263)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:600)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.report.ReportDataAction.showData(ReportDataAction.java:435)
	at com.menyi.aio.web.report.ReportDataAction.exe(ReportDataAction.java:98)
	at com.menyi.web.util.BaseAction.execute(BaseAction.java:264)
	at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
	at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
	at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:304)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
	at org.apache.struts.action.ActionServlet.doGet(ActionServlet.java:449)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:620)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:316)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:09:15,382 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9690CDECAD1ABB4F70B0A1BB597E5395919
 [DEBUG] 2017-12-20 10:09:21,603 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=8
 [DEBUG] 2017-12-20 10:09:21,604 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[8,];
 [DEBUG] 2017-12-20 10:09:21,604 Line:215 ---------->SET Page 8 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:09:21,654 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:09:21,654 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:09:21,655 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:09:21,656 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=8&checkTab=Y
 [DEBUG] 2017-12-20 10:09:21,656 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[8,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:09:21,657 Line:215 ---------->SET Page 8 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:09:22,693 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:09:22,694 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[8,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];GoodsFullName2=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:09:22,706 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:09:22,707 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:09:22,707 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:09:22,707 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:09:22,707 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:09:22,708 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:09:22,708 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:09:22,708 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:09:22,708 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:09:22,708 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:09:22,708 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:09:22,708 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:09:22,709 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:09:22,709 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:09:22,709 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:09:22,709 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:09:22,709 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:09:22,710 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:09:22,710 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:09:22,753 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:09:22,754 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:09:22,754 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:09:22,754 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:09:22,754 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:09:22,754 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:09:22,755 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:09:22,755 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:09:22,755 Line:689 通过SQL读原始数据：48
 [DEBUG] 2017-12-20 10:09:22,756 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:09:26,578 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv
 [DEBUG] 2017-12-20 10:09:26,578 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[22,];src=[menu,menu,];reportNumber=[tblVirtualStock,tblVirtualStock,];reportName=[è??????????????è??,è??????????????è??,];displayName=[classCode,classCode,];LinkType=[@URL:,@URL:,];selectName=[ReportSelectGoods_v2,ReportSelectGoods_v2,];MOID=[fc26a1c0_0911091930102960206,fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,query,];popupWin=[Popdiv,];
 [DEBUG] 2017-12-20 10:09:26,604 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:09:26,605 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv&checkTab=Y
 [DEBUG] 2017-12-20 10:09:26,605 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:09:26,606 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[22,];src=[menu,menu,];reportNumber=[tblVirtualStock,tblVirtualStock,];reportName=[è??????????????è??,è??????????????è??,];displayName=[classCode,classCode,];LinkType=[@URL:,@URL:,];selectName=[ReportSelectGoods_v2,ReportSelectGoods_v2,];MOID=[fc26a1c0_0911091930102960206,fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,query,];popupWin=[Popdiv,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:09:26,606 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:09:26,636 Line:3434 DynDBManager.popSelect selectName=ReportSelectGoods_v2; sql=select * from (select tblGoods.classCode f1 ,tblGoods.isCatalog f2 ,tblGoods.GoodsNumber f3 ,tblGoods.GoodsFullName f4 ,tblGoods.GoodsSpec f5 ,tblGoods.BaseUnit f6 ,tblGoods.GoodsFullNamePYM f7 
,tblGoods.isCatalog as childCount,ROW_NUMBER() over( order by tblGoods.GoodsNumber,tblGoods.GoodsFullName) as row_id from tblGoods
      where 1=1  and tblGoods.workFlowNodeName='finish' and tblGoods.classCode like '_____') a where  row_id between 1 and 100 order by row_id 
 [DEBUG] 2017-12-20 10:09:28,774 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do
 [DEBUG] 2017-12-20 10:09:28,775 Line:146 BaseAction.execute 操作人:admin;请求数据：root=[,];isRoot=[,];operation=[22,];tableName=[,];parentTableName=[,];fieldName=[,];popDataType=[,];parentCode=[00003,];selectName=[ReportSelectGoods_v2,];popupType=[,];displayName=[,];reportNumber=[tblVirtualStock,];reportName=[è??????????????è??,];backType=[,];isQuote=[,];MOID=[fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,];iniPropField=[,];keyIdType=[saveType,];queryChannel=[,];strAction=[/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv&checkTab=Y,];nextClass=[next,];popPop=[,];noOp=[,];popupWin=[Popdiv,];isMain=[,];topId=[,];toDetail=[,];checkTab=[Y,];queryField=[,];keySearch=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];tblGoods.GoodsFullNamePYM=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:09:28,780 Line:3434 DynDBManager.popSelect selectName=ReportSelectGoods_v2; sql=select * from (select tblGoods.classCode f1 ,tblGoods.isCatalog f2 ,tblGoods.GoodsNumber f3 ,tblGoods.GoodsFullName f4 ,tblGoods.GoodsSpec f5 ,tblGoods.BaseUnit f6 ,tblGoods.GoodsFullNamePYM f7 
,tblGoods.isCatalog as childCount,ROW_NUMBER() over( order by tblGoods.GoodsNumber,tblGoods.GoodsFullName) as row_id from tblGoods
      where 1=1  and tblGoods.workFlowNodeName='finish' and tblGoods.classCode like '00003_____') a where  row_id between 1 and 100 order by row_id 
 [DEBUG] 2017-12-20 10:09:31,292 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:09:31,292 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[8,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:{call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[0000300001,];hide_GoodsCode=[0000300001#;#0#;#bl0001#;#叉烧包#;##;##;#,];tblGoods.GoodsNumber=[bl0001,];tblGoods.GoodsFullName=[叉烧包,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];GoodsFullName2=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:09:31,305 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:09:31,305 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:09:31,306 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:09:31,306 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:09:31,306 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:09:31,306 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:09:31,306 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:09:31,306 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:09:31,306 Line:582 ReportDataMgt.getReportData 参数8:0000300001;0
 [DEBUG] 2017-12-20 10:09:31,307 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:09:31,307 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:09:31,307 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:09:31,307 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:09:31,307 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:09:31,307 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:09:31,308 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:09:31,308 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:09:31,308 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:09:31,308 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:09:31,324 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:09:31,324 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:09:31,325 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0000300001'))
 [DEBUG] 2017-12-20 10:09:31,325 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:09:31,325 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:09:31,325 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:09:31,325 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:09:31,325 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0000300001')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:09:31,326 Line:689 通过SQL读原始数据：21
 [DEBUG] 2017-12-20 10:09:31,326 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:11:51,811 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 10:11:51,812 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 10:11:51,812 Line:243 AIOApi op=getSessEmp&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:11:51,813 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 10:11:51,831 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 10:11:51,831 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 10:11:51,831 Line:243 AIOApi op=getEnum&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:11:51,832 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 10:11:57,879 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 10:11:57,880 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 10:11:57,880 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:11:57,881 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 10:11:57,901 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 10:11:59,395 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:11:59,396 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:11:59,397 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:11:59,519 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:11:59,520 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:11:59,520 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:11:59,520 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:11:59,520 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:11:59,520 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:11:59,521 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:11:59,522 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:11:59,522 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:11:59,522 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:11:59,522 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:11:59,522 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:11:59,522 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:11:59,686 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:11:59,686 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:11:59,686 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:11:59,686 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:11:59,687 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:11:59,687 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:11:59,687 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:11:59,687 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:11:59,687 Line:689 通过SQL读原始数据：167
 [DEBUG] 2017-12-20 10:11:59,688 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:11:59,701 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["GoodsFullName2",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatcall",等等！
 [DEBUG] 2017-12-20 10:16:02,331 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9696E294968E0782A9E5622FDE4212056BC
 [DEBUG] 2017-12-20 10:17:08,988 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 10:17:08,989 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 10:17:08,989 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:17:08,990 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 10:17:09,012 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 10:17:10,487 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:17:10,488 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:17:10,488 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:17:10,531 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:17:10,532 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:17:10,533 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:17:10,534 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:17:10,534 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:17:10,534 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:17:10,534 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:17:10,535 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:17:10,535 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:17:10,535 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:17:10,535 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:17:10,535 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:17:10,536 Line:582 ReportDataMgt.getReportData 参数18:
 [ERROR] 2017-12-20 10:17:10,540 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 过程或函数 'report_VirtualStock' 需要参数 '@mobileGoodsFullName'，但未提供该参数。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:197)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1493)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:390)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:340)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4575)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:179)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:154)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:283)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:584)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.mobile.AIOApi.report(AIOApi.java:2296)
	at com.menyi.aio.web.mobile.AIOApi.service(AIOApi.java:261)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:314)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:17:10,541 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"ERROR","msg":"Error Canst id\u003d -1002"}
 [DEBUG] 2017-12-20 10:17:17,265 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:17:17,265 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[8,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:{call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}@ParamList:@Param:@Param:0000300001;0@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[0000300001,];hide_GoodsCode=[0000300001#;#0#;#bl0001#;#叉烧包#;##;##;#,];tblGoods.GoodsNumber=[bl0001,];tblGoods.GoodsFullName=[叉烧包,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];GoodsFullName2=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:17:17,297 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@GoodsFullName2=?)}
 [DEBUG] 2017-12-20 10:17:17,298 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:17:17,298 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:17:17,298 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:17:17,298 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:17:17,299 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:17:17,299 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:17:17,299 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:17:17,299 Line:582 ReportDataMgt.getReportData 参数8:0000300001;0
 [DEBUG] 2017-12-20 10:17:17,299 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:17:17,299 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:17:17,299 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:17:17,300 Line:582 ReportDataMgt.getReportData 参数18:
 [ERROR] 2017-12-20 10:17:17,302 Line:1394 ReportDataMgt.getReportData() Error:
 com.microsoft.sqlserver.jdbc.SQLServerException: 过程或函数 'report_VirtualStock' 需要参数 '@mobileGoodsFullName'，但未提供该参数。
	at com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerException.java:197)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.getNextResult(SQLServerStatement.java:1493)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.doExecutePreparedStatement(SQLServerPreparedStatement.java:390)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement$PrepStmtExecCmd.doExecute(SQLServerPreparedStatement.java:340)
	at com.microsoft.sqlserver.jdbc.TDSCommand.execute(IOBuffer.java:4575)
	at com.microsoft.sqlserver.jdbc.SQLServerConnection.executeCommand(SQLServerConnection.java:1400)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeCommand(SQLServerStatement.java:179)
	at com.microsoft.sqlserver.jdbc.SQLServerStatement.executeStatement(SQLServerStatement.java:154)
	at com.microsoft.sqlserver.jdbc.SQLServerPreparedStatement.executeQuery(SQLServerPreparedStatement.java:283)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at org.apache.tomcat.dbcp.dbcp.DelegatingPreparedStatement.executeQuery(DelegatingPreparedStatement.java:96)
	at com.menyi.aio.web.report.ReportDataMgt$12$1.execute(ReportDataMgt.java:584)
	at org.hibernate.impl.SessionImpl.doWork(SessionImpl.java:1850)
	at com.menyi.aio.web.report.ReportDataMgt$12.exec(ReportDataMgt.java:553)
	at com.dbfactory.hibernate.DBUtil.execute(DBUtil.java:364)
	at com.menyi.aio.web.report.ReportDataMgt.getReportData(ReportDataMgt.java:551)
	at com.menyi.aio.web.report.ReportDataMgt.getDisplayData(ReportDataMgt.java:1692)
	at com.menyi.aio.web.userFunction.ReportData.showData(ReportData.java:1608)
	at com.menyi.aio.web.report.ReportDataAction.showData(ReportDataAction.java:435)
	at com.menyi.aio.web.report.ReportDataAction.exe(ReportDataAction.java:98)
	at com.menyi.web.util.BaseAction.execute(BaseAction.java:264)
	at org.apache.struts.chain.commands.servlet.ExecuteAction.execute(ExecuteAction.java:58)
	at org.apache.struts.chain.commands.AbstractExecuteAction.execute(AbstractExecuteAction.java:67)
	at org.apache.struts.chain.commands.ActionCommandBase.execute(ActionCommandBase.java:51)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.commons.chain.generic.LookupCommand.execute(LookupCommand.java:304)
	at org.apache.commons.chain.impl.ChainBase.execute(ChainBase.java:190)
	at org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:283)
	at org.apache.struts.action.ActionServlet.process(ActionServlet.java:1913)
	at org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:646)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:727)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:303)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at com.menyi.web.util.BaseFilter.doFilter(BaseFilter.java:172)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:241)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:208)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:220)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:122)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:504)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:170)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:103)
	at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:950)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:116)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:421)
	at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1074)
	at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:611)
	at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:314)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
[DEBUG] 2017-12-20 10:17:39,019 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9694C7CA4DA56997EAF17BB8C487E591A94
 [DEBUG] 2017-12-20 10:18:18,751 Line:133 ReportServlet.service 请求地址：/ReportServlet?operation=saveSQLFile&fileName=tblVirtualStockSQL.xml&SESSION=86BF682459193E5A784B29199D8A08D6BF3DA7A71ED41C900384906D93A9D426EE34CC2737FBC9693DFD99E39D1AE02417BB8C487E591A94
 [DEBUG] 2017-12-20 10:18:27,466 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=9
 [DEBUG] 2017-12-20 10:18:27,466 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[9,];
 [DEBUG] 2017-12-20 10:18:27,466 Line:215 ---------->SET Page 9 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:18:27,532 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:18:27,533 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:18:27,534 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:18:27,535 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=9&checkTab=Y
 [DEBUG] 2017-12-20 10:18:27,535 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[9,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:18:27,536 Line:215 ---------->SET Page 9 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:18:29,611 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:18:29,612 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[9,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];mobileGoodsFullName=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:18:29,625 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:18:29,625 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:18:29,625 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:18:29,625 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:18:29,626 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:18:29,626 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:18:29,626 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:18:29,626 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:18:29,626 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:18:29,626 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:18:29,627 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:18:29,627 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:18:29,635 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:18:29,635 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:18:29,635 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:18:29,635 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:18:29,636 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:18:29,636 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:18:29,636 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:18:29,715 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:18:29,715 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:18:29,716 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:29,716 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:29,716 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:18:29,716 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:29,717 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:18:29,717 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:18:29,717 Line:689 通过SQL读原始数据：92
 [DEBUG] 2017-12-20 10:18:29,718 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:18:33,627 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv
 [DEBUG] 2017-12-20 10:18:33,628 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[22,];src=[menu,menu,];reportNumber=[tblVirtualStock,tblVirtualStock,];reportName=[è??????????????è??,è??????????????è??,];displayName=[classCode,classCode,];LinkType=[@URL:,@URL:,];selectName=[ReportSelectGoods_v2,ReportSelectGoods_v2,];MOID=[fc26a1c0_0911091930102960206,fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,query,];popupWin=[Popdiv,];
 [DEBUG] 2017-12-20 10:18:33,654 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv&checkTab=Y
 [DEBUG] 2017-12-20 10:18:33,654 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 10:18:33,655 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[22,];src=[menu,menu,];reportNumber=[tblVirtualStock,tblVirtualStock,];reportName=[è??????????????è??,è??????????????è??,];displayName=[classCode,classCode,];LinkType=[@URL:,@URL:,];selectName=[ReportSelectGoods_v2,ReportSelectGoods_v2,];MOID=[fc26a1c0_0911091930102960206,fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,query,];popupWin=[Popdiv,];checkTab=[Y,];
 [DEBUG] 2017-12-20 10:18:33,656 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 10:18:33,657 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 10:18:33,664 Line:3434 DynDBManager.popSelect selectName=ReportSelectGoods_v2; sql=select * from (select tblGoods.classCode f1 ,tblGoods.isCatalog f2 ,tblGoods.GoodsNumber f3 ,tblGoods.GoodsFullName f4 ,tblGoods.GoodsSpec f5 ,tblGoods.BaseUnit f6 ,tblGoods.GoodsFullNamePYM f7 
,tblGoods.isCatalog as childCount,ROW_NUMBER() over( order by tblGoods.GoodsNumber,tblGoods.GoodsFullName) as row_id from tblGoods
      where 1=1  and tblGoods.workFlowNodeName='finish' and tblGoods.classCode like '_____') a where  row_id between 1 and 100 order by row_id 
 [DEBUG] 2017-12-20 10:18:35,974 Line:135 BaseAction.execute 请求地址：/UserFunctionAction.do
 [DEBUG] 2017-12-20 10:18:35,975 Line:146 BaseAction.execute 操作人:admin;请求数据：root=[,];isRoot=[,];operation=[22,];tableName=[,];parentTableName=[,];fieldName=[,];popDataType=[,];parentCode=[00003,];selectName=[ReportSelectGoods_v2,];popupType=[,];displayName=[,];reportNumber=[tblVirtualStock,];reportName=[è??????????????è??,];backType=[,];isQuote=[,];MOID=[fc26a1c0_0911091930102960206,];MOOP=[query/UserFunctionAction.do?operation=22,];iniPropField=[,];keyIdType=[saveType,];queryChannel=[,];strAction=[/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query/UserFunctionAction.do?operation=22&src=menu&reportNumber=tblVirtualStock&reportName=%E8%99%9A%E6%8B%9F%E5%BA%93%E5%AD%98%E6%9F%A5%E8%AF%A2&displayName=classCode&LinkType=@URL:&selectName=ReportSelectGoods_v2&MOID=fc26a1c0_0911091930102960206&MOOP=query&popupWin=Popdiv&checkTab=Y,];nextClass=[next,];popPop=[,];noOp=[,];popupWin=[Popdiv,];isMain=[,];topId=[,];toDetail=[,];checkTab=[Y,];queryField=[,];keySearch=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];tblGoods.GoodsFullNamePYM=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:18:35,980 Line:3434 DynDBManager.popSelect selectName=ReportSelectGoods_v2; sql=select * from (select tblGoods.classCode f1 ,tblGoods.isCatalog f2 ,tblGoods.GoodsNumber f3 ,tblGoods.GoodsFullName f4 ,tblGoods.GoodsSpec f5 ,tblGoods.BaseUnit f6 ,tblGoods.GoodsFullNamePYM f7 
,tblGoods.isCatalog as childCount,ROW_NUMBER() over( order by tblGoods.GoodsNumber,tblGoods.GoodsFullName) as row_id from tblGoods
      where 1=1  and tblGoods.workFlowNodeName='finish' and tblGoods.classCode like '00003_____') a where  row_id between 1 and 100 order by row_id 
 [DEBUG] 2017-12-20 10:18:37,735 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 10:18:37,735 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[9,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:{call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[false,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[0000300001,];hide_GoodsCode=[0000300001#;#0#;#bl0001#;#叉烧包#;##;##;#,];tblGoods.GoodsNumber=[bl0001,];tblGoods.GoodsFullName=[叉烧包,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];mobileGoodsFullName=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 10:18:37,766 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:18:37,766 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:18:37,766 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 10:18:37,767 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:18:37,767 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:18:37,767 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:18:37,767 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:18:37,767 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:18:37,767 Line:582 ReportDataMgt.getReportData 参数8:0000300001;0
 [DEBUG] 2017-12-20 10:18:37,767 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:18:37,768 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:18:37,768 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:18:37,768 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:18:37,768 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:18:37,768 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:18:37,768 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:18:37,769 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:18:37,769 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:18:37,769 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:18:37,805 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:18:37,805 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:18:37,805 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('0000300001'))
 [DEBUG] 2017-12-20 10:18:37,805 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:37,806 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:18:37,806 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:37,806 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:18:37,806 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('0000300001')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:18:37,806 Line:689 通过SQL读原始数据：40
 [DEBUG] 2017-12-20 10:18:37,807 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:18:41,458 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 10:18:41,459 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 10:18:41,459 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:18:41,460 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 10:18:41,477 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 10:18:42,979 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:18:42,980 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:18:42,981 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:18:43,034 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:18:43,034 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:18:43,035 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:18:43,035 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:18:43,035 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:18:43,035 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:18:43,035 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:18:43,035 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:18:43,035 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:18:43,035 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:18:43,036 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:18:43,037 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:18:43,037 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:18:43,076 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:18:43,077 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:18:43,079 Line:689 通过SQL读原始数据：45
 [DEBUG] 2017-12-20 10:18:43,079 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:18:43,084 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 10:18:51,866 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:18:51,869 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:18:51,870 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:18:51,897 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:18:51,898 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:18:51,898 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:18:51,899 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:18:51,899 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:18:51,899 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:18:51,900 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:18:51,900 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:18:51,900 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:18:51,900 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:18:51,901 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:18:51,901 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:18:51,901 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:18:51,901 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:18:51,902 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:18:51,902 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:18:51,902 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:18:51,902 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:18:51,902 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:18:51,904 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:18:51,904 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:18:51,905 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:51,905 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:51,905 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:18:51,905 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:18:51,905 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:18:51,905 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:18:51,906 Line:689 通过SQL读原始数据：8
 [DEBUG] 2017-12-20 10:18:51,907 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:18:51,914 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 10:19:12,398 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:19:12,401 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:19:12,402 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:19:12,418 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:19:12,419 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:19:12,420 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:19:12,420 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:19:12,420 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:19:12,421 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:19:12,421 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:19:12,422 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:19:12,422 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:19:12,422 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:19:12,422 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:19:12,423 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:19:12,424 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:19:12,424 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:19:12,424 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:19:12,425 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:19:12,425 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:19:12,425 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:19:12,425 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:19:12,427 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:19:12,427 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:19:12,427 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:12,428 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:12,428 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:19:12,428 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:12,428 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:19:12,428 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:19:12,429 Line:689 通过SQL读原始数据：10
 [DEBUG] 2017-12-20 10:19:12,429 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:19:12,433 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 10:19:45,500 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 10:19:45,502 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 10:19:45,502 Line:243 AIOApi op=popup&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:19:45,504 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 10:19:45,530 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 10:19:47,009 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:19:47,011 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:19:47,012 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:19:47,074 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:19:47,075 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:19:47,075 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:19:47,075 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:19:47,076 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:19:47,077 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:19:47,079 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:19:47,080 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:19:47,080 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:19:47,081 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:19:47,081 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:19:47,082 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:19:47,082 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:19:47,083 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:19:47,083 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:19:47,083 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:19:47,084 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:19:47,084 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:19:47,084 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:19:47,129 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:19:47,130 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:19:47,130 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:47,130 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:47,130 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:19:47,130 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:47,130 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:19:47,131 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:19:47,131 Line:689 通过SQL读原始数据：57
 [DEBUG] 2017-12-20 10:19:47,131 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:19:47,136 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 10:19:50,786 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:19:50,787 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[玉米,];
 [DEBUG] 2017-12-20 10:19:50,787 Line:243 AIOApi op=report&sessionid=F531E1ECE8663274CB25A827FA62F172
 [DEBUG] 2017-12-20 10:19:50,797 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:19:50,798 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:19:50,798 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:19:50,798 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:19:50,798 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:19:50,798 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:19:50,798 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:19:50,799 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:19:50,800 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:19:50,800 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:19:50,800 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:19:50,800 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:19:50,800 Line:582 ReportDataMgt.getReportData 参数18:玉米
 [DEBUG] 2017-12-20 10:19:50,802 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:19:50,802 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:19:50,803 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:50,803 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:50,803 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:19:50,804 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:19:50,804 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:19:50,804 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:19:50,804 Line:689 通过SQL读原始数据：6
 [DEBUG] 2017-12-20 10:19:50,805 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:19:50,810 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","玉米"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floa等等！
 [DEBUG] 2017-12-20 10:38:40,739 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 10:42:24,897 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:24,900 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[玉,];
 [DEBUG] 2017-12-20 10:42:24,902 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:24,903 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 10:42:25,016 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:25,017 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];
 [DEBUG] 2017-12-20 10:42:25,017 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:25,018 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 10:42:28,616 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 10:42:28,617 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 10:42:28,617 Line:243 AIOApi op=LOGIN&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:28,676 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 10:42:28,728 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 10:42:28,746 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 10:42:28,802 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 10:42:29,290 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 10:42:29,290 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 10:42:29,291 Line:243 AIOApi op=getSessEmp&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:29,292 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 10:42:29,329 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 10:42:29,329 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 10:42:29,330 Line:243 AIOApi op=getEnum&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:29,331 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 10:42:31,098 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 10:42:31,099 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 10:42:31,099 Line:243 AIOApi op=popup&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:31,100 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 10:42:31,113 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 10:42:32,605 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:32,606 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 10:42:32,606 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:32,656 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:32,656 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:32,656 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:32,656 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:32,656 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:32,657 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:32,657 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:32,657 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:32,657 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:32,657 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:32,657 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:32,657 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:32,658 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:32,658 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:32,658 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:32,658 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:32,658 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:32,659 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:32,659 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:42:32,732 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:32,732 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:32,732 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:32,732 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:32,733 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:32,733 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:32,733 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:32,733 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:32,733 Line:689 通过SQL读原始数据：77
 [DEBUG] 2017-12-20 10:42:32,734 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:42:32,739 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 10:42:35,530 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:35,533 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[b,];
 [DEBUG] 2017-12-20 10:42:35,534 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:35,574 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:35,575 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:35,576 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:35,576 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:35,577 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:35,579 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:35,580 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:35,580 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:35,581 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:35,581 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:35,581 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:35,582 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:35,582 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:35,582 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:35,583 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:35,583 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:35,583 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:35,584 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:35,584 Line:582 ReportDataMgt.getReportData 参数18:b
 [DEBUG] 2017-12-20 10:42:35,586 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:35,586 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:35,586 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:35,586 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:35,586 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:35,586 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:35,587 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:35,587 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:35,587 Line:689 通过SQL读原始数据：12
 [DEBUG] 2017-12-20 10:42:35,587 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:42:35,594 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","b"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","float等等！
 [DEBUG] 2017-12-20 10:42:35,721 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:35,722 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[bs,];
 [DEBUG] 2017-12-20 10:42:35,722 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:35,733 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:35,734 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:35,734 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:35,734 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:35,734 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:35,734 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:35,734 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:35,735 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:35,735 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:35,735 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:35,735 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:35,735 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:35,736 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:35,736 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:35,736 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:35,736 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:35,736 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:35,737 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:35,737 Line:582 ReportDataMgt.getReportData 参数18:bs
 [DEBUG] 2017-12-20 10:42:35,739 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:35,739 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:35,740 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:35,740 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:35,740 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:35,741 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:35,742 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:35,742 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:35,743 Line:689 通过SQL读原始数据：9
 [DEBUG] 2017-12-20 10:42:35,745 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 10:42:35,753 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","bs"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floa等等！
 [DEBUG] 2017-12-20 10:42:38,392 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:38,394 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[bs0,];
 [DEBUG] 2017-12-20 10:42:38,394 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:38,406 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:38,408 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:38,409 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:38,409 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:38,409 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:38,410 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:38,410 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:38,410 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:38,411 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:38,411 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:38,411 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:38,411 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:38,411 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:38,412 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:38,413 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:38,413 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:38,413 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:38,413 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:38,413 Line:582 ReportDataMgt.getReportData 参数18:bs0
 [DEBUG] 2017-12-20 10:42:38,415 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:38,415 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:38,415 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,416 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,416 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:38,416 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,416 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:38,416 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:38,417 Line:689 通过SQL读原始数据：9
 [DEBUG] 2017-12-20 10:42:38,417 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:42:38,422 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","bs0"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","flo等等！
 [DEBUG] 2017-12-20 10:42:38,532 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:38,533 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[bs00,];
 [DEBUG] 2017-12-20 10:42:38,533 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:38,547 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:38,548 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:38,548 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:38,548 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:38,548 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:38,548 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:38,549 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:38,550 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:38,550 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:38,550 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:38,550 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:38,550 Line:582 ReportDataMgt.getReportData 参数18:bs00
 [DEBUG] 2017-12-20 10:42:38,552 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:38,553 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:38,553 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,553 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,553 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:38,553 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,554 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:38,554 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:38,554 Line:689 通过SQL读原始数据：6
 [DEBUG] 2017-12-20 10:42:38,554 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:42:38,561 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","bs00"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","fl等等！
 [DEBUG] 2017-12-20 10:42:38,734 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:38,736 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[bs000,];
 [DEBUG] 2017-12-20 10:42:38,736 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:38,759 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:38,760 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:38,760 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:38,760 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:38,760 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:38,760 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:38,760 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:38,761 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:38,762 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:38,762 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:38,762 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:38,762 Line:582 ReportDataMgt.getReportData 参数18:bs000
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:38,764 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:38,765 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:38,765 Line:689 通过SQL读原始数据：5
 [DEBUG] 2017-12-20 10:42:38,765 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:42:38,770 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","bs000"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 10:42:39,895 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:39,896 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[bs0001,];
 [DEBUG] 2017-12-20 10:42:39,897 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:39,918 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:39,919 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:39,919 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:39,920 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:39,920 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:39,921 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:39,921 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:39,922 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:39,922 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:39,922 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:39,923 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:39,923 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:39,924 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:39,924 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:39,925 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:39,925 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:39,925 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:39,926 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:39,926 Line:582 ReportDataMgt.getReportData 参数18:bs0001
 [DEBUG] 2017-12-20 10:42:39,931 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:39,931 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:39,931 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:39,932 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:39,932 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:39,932 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:39,932 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:39,932 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:39,933 Line:689 通过SQL读原始数据：14
 [DEBUG] 2017-12-20 10:42:39,933 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:42:39,936 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName","bs0001"]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","等等！
 [DEBUG] 2017-12-20 10:42:45,208 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 10:42:45,209 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];
 [DEBUG] 2017-12-20 10:42:45,210 Line:243 AIOApi op=report&sessionid=D285E4D0905E005C21F58ADE7743B736
 [DEBUG] 2017-12-20 10:42:45,222 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 10:42:45,224 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 10:42:45,224 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 10:42:45,225 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 10:42:45,225 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 10:42:45,225 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 10:42:45,225 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 10:42:45,226 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 10:42:45,226 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 10:42:45,226 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 10:42:45,226 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 10:42:45,227 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 10:42:45,227 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 10:42:45,227 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 10:42:45,227 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 10:42:45,227 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 10:42:45,228 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 10:42:45,228 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 10:42:45,228 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 10:42:45,234 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 10:42:45,234 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 10:42:45,234 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:45,235 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:45,235 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 10:42:45,235 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 10:42:45,235 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 10:42:45,236 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 10:42:45,236 Line:689 通过SQL读原始数据：12
 [DEBUG] 2017-12-20 10:42:45,236 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 10:42:45,244 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 11:09:00,707 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 11:26:46,379 Line:88 CommonServlet.service 请求地址：/CommonServlet?operation=qrcodeDownload
 [DEBUG] 2017-12-20 11:26:46,380 Line:99 CommonServlet.service 操作人:admin;请求数据：operation=[qrcodeDownload,];
 [DEBUG] 2017-12-20 11:26:46,635 Line:135 BaseAction.execute 请求地址：/loginAction.do?operation=15
 [DEBUG] 2017-12-20 11:26:46,636 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[15,];
 [DEBUG] 2017-12-20 11:26:46,741 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=valpwd&time=1513740406655
 [DEBUG] 2017-12-20 11:26:46,742 Line:163 UtilServlet.service 操作人:admin;请求数据：operation=[valpwd,];time=[1513740406655,];
 [DEBUG] 2017-12-20 11:39:19,909 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 12:09:38,633 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 12:39:57,277 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 13:28:23,995 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 13:28:45,805 Line:135 BaseAction.execute 请求地址：/AIO.do
 [DEBUG] 2017-12-20 13:28:45,806 Line:146 BaseAction.execute 操作人:admin;请求数据：
 [DEBUG] 2017-12-20 13:28:45,807 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:45,988 Line:135 BaseAction.execute 请求地址：/newMenu.do?keyId=28141812_0811271603291400086&name=%E6%88%91%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8F%B0&operation=0&winCurIndex=0
 [DEBUG] 2017-12-20 13:28:45,989 Line:146 BaseAction.execute 操作人:admin;请求数据：keyId=[28141812_0811271603291400086,];name=[???????・??????°,];operation=[0,];winCurIndex=[0,];
 [DEBUG] 2017-12-20 13:28:46,000 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=1&loadMenu=true
 [DEBUG] 2017-12-20 13:28:46,000 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[1,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:46,001 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:46,010 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=2&loadMenu=true
 [DEBUG] 2017-12-20 13:28:46,010 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[2,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:46,011 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:46,018 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=3&loadMenu=true
 [DEBUG] 2017-12-20 13:28:46,019 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[3,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:46,019 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:46,024 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=0&loadMenu=true
 [DEBUG] 2017-12-20 13:28:46,025 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[0,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:46,025 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:51,804 Line:135 BaseAction.execute 请求地址：/AIO.do
 [DEBUG] 2017-12-20 13:28:51,804 Line:146 BaseAction.execute 操作人:admin;请求数据：
 [DEBUG] 2017-12-20 13:28:51,805 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:51,891 Line:135 BaseAction.execute 请求地址：/newMenu.do?keyId=28141812_0811271603291400086&name=%E6%88%91%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8F%B0&operation=0&winCurIndex=0
 [DEBUG] 2017-12-20 13:28:51,891 Line:146 BaseAction.execute 操作人:admin;请求数据：keyId=[28141812_0811271603291400086,];name=[???????・??????°,];operation=[0,];winCurIndex=[0,];
 [DEBUG] 2017-12-20 13:28:51,904 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=1&loadMenu=true
 [DEBUG] 2017-12-20 13:28:51,904 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[1,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:51,905 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:51,916 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=2&loadMenu=true
 [DEBUG] 2017-12-20 13:28:51,916 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[2,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:51,916 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:51,921 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=3&loadMenu=true
 [DEBUG] 2017-12-20 13:28:51,921 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[3,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:51,923 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:28:51,928 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=0&loadMenu=true
 [DEBUG] 2017-12-20 13:28:51,928 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[0,];loadMenu=[true,];
 [DEBUG] 2017-12-20 13:28:51,929 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 13:58:44,265 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 14:29:04,257 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 14:59:24,323 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 15:20:58,058 Line:88 CommonServlet.service 请求地址：/CommonServlet?operation=qrcodeDownload
 [DEBUG] 2017-12-20 15:20:58,059 Line:99 CommonServlet.service 操作人:;请求数据：operation=[qrcodeDownload,];
 [DEBUG] 2017-12-20 15:20:58,152 Line:135 BaseAction.execute 请求地址：/loginAction.do?operation=15
 [DEBUG] 2017-12-20 15:20:58,152 Line:146 BaseAction.execute 操作人:;请求数据：operation=[15,];
 [DEBUG] 2017-12-20 15:20:58,271 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=valpwd&time=1513754458258
 [DEBUG] 2017-12-20 15:20:58,272 Line:163 UtilServlet.service 操作人:;请求数据：operation=[valpwd,];time=[1513754458258,];
 [DEBUG] 2017-12-20 15:21:00,115 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=getUserInfo&name=admin&time=1513754460113
 [DEBUG] 2017-12-20 15:21:00,115 Line:163 UtilServlet.service 操作人:;请求数据：operation=[getUserInfo,];name=[admin,];time=[1513754460113,];
 [DEBUG] 2017-12-20 15:21:00,124 Line:152 UtilServlet.service 请求地址：/UtilServlet?operation=sunCompany&name=admin&time=1513754460122
 [DEBUG] 2017-12-20 15:21:00,124 Line:163 UtilServlet.service 操作人:;请求数据：operation=[sunCompany,];name=[admin,];time=[1513754460122,];
 [DEBUG] 2017-12-20 15:21:00,131 Line:135 BaseAction.execute 请求地址：/loginAction.do
 [DEBUG] 2017-12-20 15:21:00,131 Line:146 BaseAction.execute 操作人:;请求数据：org.apache.struts.taglib.html.TOKEN=[,];NOTTOKEN=[true,];operation=[10,];ukId=[,];strM1=[,];strM2=[,];clientKey=[,];random=[,];screenWidth=[1263,];sunCompany=[1,];style=[style1,];system=[new,];loc=[zh_CN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 15:21:00,171 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 15:21:00,180 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 15:21:00,236 Line:135 BaseAction.execute 请求地址：/AIO.do
 [DEBUG] 2017-12-20 15:21:00,236 Line:146 BaseAction.execute 操作人:admin;请求数据：
 [DEBUG] 2017-12-20 15:21:00,237 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 15:21:00,431 Line:135 BaseAction.execute 请求地址：/newMenu.do?keyId=28141812_0811271603291400086&name=%E6%88%91%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8F%B0&operation=0&winCurIndex=0
 [DEBUG] 2017-12-20 15:21:00,431 Line:146 BaseAction.execute 操作人:admin;请求数据：keyId=[28141812_0811271603291400086,];name=[???????・??????°,];operation=[0,];winCurIndex=[0,];
 [DEBUG] 2017-12-20 15:21:00,448 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=1&loadMenu=true
 [DEBUG] 2017-12-20 15:21:00,448 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[1,];loadMenu=[true,];
 [DEBUG] 2017-12-20 15:21:00,449 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 15:21:00,460 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=2&loadMenu=true
 [DEBUG] 2017-12-20 15:21:00,460 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[2,];loadMenu=[true,];
 [DEBUG] 2017-12-20 15:21:00,461 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 15:21:00,468 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=3&loadMenu=true
 [DEBUG] 2017-12-20 15:21:00,468 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[3,];loadMenu=[true,];
 [DEBUG] 2017-12-20 15:21:00,469 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 15:21:00,477 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=0&loadMenu=true
 [DEBUG] 2017-12-20 15:21:00,478 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[0,];loadMenu=[true,];
 [DEBUG] 2017-12-20 15:21:00,478 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 15:21:22,108 Line:135 BaseAction.execute 请求地址：/UpgradeAction.do?type=5&src=menu&winCurIndex=1
 [DEBUG] 2017-12-20 15:21:22,108 Line:146 BaseAction.execute 操作人:admin;请求数据：type=[5,];src=[menu,];winCurIndex=[1,];
 [DEBUG] 2017-12-20 15:21:22,109 Line:215 ---------->SET Page 1 DEFAULT URL = /UpgradeAction.do?type=5
 [DEBUG] 2017-12-20 15:21:23,228 Line:88 CommonServlet.service 请求地址：/CommonServlet?operation=checkVersion&t=1513754483000
 [DEBUG] 2017-12-20 15:21:23,229 Line:99 CommonServlet.service 操作人:admin;请求数据：operation=[checkVersion,];t=[1513754483000,];
 [DEBUG] 2017-12-20 15:29:43,694 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 16:00:03,992 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 16:04:01,235 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:04:01,235 Line:3003 MobileAjax 操作人:;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:04:01,235 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:01,236 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 16:04:03,149 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:04:03,149 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:04:03,150 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:03,150 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 16:04:07,385 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 16:04:07,386 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 16:04:07,387 Line:243 AIOApi op=LOGIN&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:07,422 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:04:07,458 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 16:04:07,471 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 16:04:07,510 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 16:04:07,977 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 16:04:07,978 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 16:04:07,978 Line:243 AIOApi op=getSessEmp&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:07,979 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 16:04:08,007 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 16:04:08,007 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 16:04:08,007 Line:243 AIOApi op=getEnum&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:08,009 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 16:04:10,035 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:04:10,036 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:04:10,037 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:10,039 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:04:10,067 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:04:11,549 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:04:11,550 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:04:11,551 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:11,629 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:04:11,630 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:04:11,631 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:04:11,631 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:04:11,632 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:04:11,632 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:04:11,632 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:04:11,633 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:04:11,633 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:04:11,634 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:04:11,634 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:04:11,635 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:04:11,635 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:04:11,636 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:04:11,637 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:04:11,637 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:04:11,638 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:04:11,639 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:04:11,639 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:04:11,729 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:04:11,729 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:04:11,729 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:04:11,730 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:04:11,730 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:04:11,730 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:04:11,730 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:04:11,730 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:04:11,730 Line:689 通过SQL读原始数据：100
 [DEBUG] 2017-12-20 16:04:11,731 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:04:11,736 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:04:21,130 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:04:21,131 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];GoodsCode=[,];
 [DEBUG] 2017-12-20 16:04:21,131 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:04:21,139 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:04:21,140 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:04:21,140 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:04:21,140 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:04:21,140 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:04:21,140 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:04:21,141 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:04:21,141 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:04:21,141 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:04:21,141 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:04:21,142 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:04:21,142 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:04:21,142 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:04:21,142 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:04:21,142 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:04:21,142 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:04:21,143 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:04:21,143 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:04:21,143 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:04:21,145 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:04:21,146 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:04:21,146 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:04:21,146 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:04:21,147 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:04:21,147 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:04:21,147 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:04:21,147 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:04:21,147 Line:689 通过SQL读原始数据：8
 [DEBUG] 2017-12-20 16:04:21,148 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:04:21,158 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:05:12,131 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:05:12,132 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];GoodsCode=[,];
 [DEBUG] 2017-12-20 16:05:12,132 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:05:12,170 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:05:12,170 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:05:12,170 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:05:12,170 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:05:12,170 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:05:12,171 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:05:12,171 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:05:12,171 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:05:12,171 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:05:12,171 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:05:12,171 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:05:12,171 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:05:12,172 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:05:12,249 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:05:12,249 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:05:12,249 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:12,249 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:12,250 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:05:12,250 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:12,250 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:05:12,250 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:05:12,250 Line:689 通过SQL读原始数据：80
 [DEBUG] 2017-12-20 16:05:12,251 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:05:12,255 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:05:34,995 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:05:34,996 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:05:34,996 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:05:34,997 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:05:35,022 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:05:36,508 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:05:36,510 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:05:36,511 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:05:36,617 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:05:36,617 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:05:36,618 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:05:36,618 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:05:36,619 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:05:36,619 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:05:36,619 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:05:36,620 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:05:36,621 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:05:36,621 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:05:36,622 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:05:36,622 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:05:36,623 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:05:36,623 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:05:36,624 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:05:36,624 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:05:36,625 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:05:36,625 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:05:36,625 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:05:36,715 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:05:36,715 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:05:36,715 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:36,715 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:36,716 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:05:36,716 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:36,716 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:05:36,716 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:05:36,716 Line:689 通过SQL读原始数据：99
 [DEBUG] 2017-12-20 16:05:36,717 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:05:36,722 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:05:40,129 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:05:40,129 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];GoodsCode=[00003,];
 [DEBUG] 2017-12-20 16:05:40,130 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:05:40,155 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:05:40,156 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:05:40,156 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:05:40,156 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:05:40,156 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:05:40,156 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数8:00003
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:05:40,157 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:05:40,158 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:05:40,158 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:05:40,158 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:05:40,158 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:05:40,158 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:05:40,158 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:05:40,198 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:05:40,198 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:05:40,198 Line:587 ReportDataMgt.getReportData warn  and ( tblGoods.classCode in ('00003'))
 [DEBUG] 2017-12-20 16:05:40,198 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:40,198 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:05:40,199 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:05:40,199 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:05:40,199 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and ( tblGoods.classCode in ('00003')) and (tblGoods.classCode like '_%')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:05:40,199 Line:689 通过SQL读原始数据：43
 [DEBUG] 2017-12-20 16:05:40,199 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:05:40,201 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode","00003"],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 16:06:09,255 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 16:06:09,256 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 16:06:09,256 Line:243 AIOApi op=getSessEmp&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:06:09,257 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 16:06:09,270 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 16:06:09,272 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 16:06:09,273 Line:243 AIOApi op=getEnum&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:06:09,274 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 16:06:11,178 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:06:11,179 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:06:11,180 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:06:11,181 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:06:11,203 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:06:12,696 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:06:12,697 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:06:12,698 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:06:12,732 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:06:12,733 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:06:12,734 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:06:12,735 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:06:12,735 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:06:12,736 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:06:12,736 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:06:12,737 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:06:12,738 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:06:12,738 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:06:12,739 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:06:12,740 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:06:12,740 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:06:12,742 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:06:12,742 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:06:12,743 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:06:12,743 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:06:12,744 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:06:12,745 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:06:12,791 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:06:12,792 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:06:12,792 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:12,792 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:12,793 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:06:12,793 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:12,793 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:06:12,794 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:06:12,795 Line:689 通过SQL读原始数据：62
 [DEBUG] 2017-12-20 16:06:12,796 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:06:12,806 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:06:32,494 Line:135 BaseAction.execute 请求地址：/AIO.do
 [DEBUG] 2017-12-20 16:06:32,497 Line:146 BaseAction.execute 操作人:admin;请求数据：
 [DEBUG] 2017-12-20 16:06:32,500 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:06:32,652 Line:135 BaseAction.execute 请求地址：/newMenu.do?keyId=28141812_0811271603291400086&name=%E6%88%91%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8F%B0&operation=0&winCurIndex=0
 [DEBUG] 2017-12-20 16:06:32,652 Line:146 BaseAction.execute 操作人:admin;请求数据：keyId=[28141812_0811271603291400086,];name=[???????・??????°,];operation=[0,];winCurIndex=[0,];
 [DEBUG] 2017-12-20 16:06:32,665 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=1&loadMenu=true
 [DEBUG] 2017-12-20 16:06:32,666 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[1,];loadMenu=[true,];
 [DEBUG] 2017-12-20 16:06:32,666 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:06:32,673 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=2&loadMenu=true
 [DEBUG] 2017-12-20 16:06:32,674 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[2,];loadMenu=[true,];
 [DEBUG] 2017-12-20 16:06:32,676 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:06:32,680 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=3&loadMenu=true
 [DEBUG] 2017-12-20 16:06:32,681 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[3,];loadMenu=[true,];
 [DEBUG] 2017-12-20 16:06:32,681 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:06:32,686 Line:135 BaseAction.execute 请求地址：/MenuQueryAction.do?sysType=0&loadMenu=true
 [DEBUG] 2017-12-20 16:06:32,686 Line:146 BaseAction.execute 操作人:admin;请求数据：sysType=[0,];loadMenu=[true,];
 [DEBUG] 2017-12-20 16:06:32,687 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:06:37,371 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=1
 [DEBUG] 2017-12-20 16:06:37,372 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[1,];
 [DEBUG] 2017-12-20 16:06:37,372 Line:215 ---------->SET Page 1 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:06:37,447 Line:135 BaseAction.execute 请求地址：/TreeAction.do?tableName=tblGoods&moduleType=&SysType=&MOID=fc26a1c0_0911091930102960206&editable=&subSql=
 [DEBUG] 2017-12-20 16:06:37,447 Line:146 BaseAction.execute 操作人:admin;请求数据：tableName=[tblGoods,];moduleType=[,];SysType=[,];MOID=[fc26a1c0_0911091930102960206,];editable=[,];subSql=[,];
 [DEBUG] 2017-12-20 16:06:37,448 Line:229 TreeMgt.getTree sql= select classCode,GoodsFullName,GoodsNumber,id from tblGoods where statusId =0   and isCatalog=1 order by GoodsNumber
 [DEBUG] 2017-12-20 16:06:37,448 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do?reportNumber=tblVirtualStock&src=menu&winCurIndex=1&checkTab=Y
 [DEBUG] 2017-12-20 16:06:37,449 Line:146 BaseAction.execute 操作人:admin;请求数据：reportNumber=[tblVirtualStock,];src=[menu,];winCurIndex=[1,];checkTab=[Y,];
 [DEBUG] 2017-12-20 16:06:37,449 Line:215 ---------->SET Page 1 DEFAULT URL = /ReportDataAction.do?reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:06:42,134 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 16:06:42,134 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[1,];src=[,];parentCode=[,];queryChannel=[normal,];SQLSave=[@SQL:@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];mobileGoodsFullName=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 16:06:42,177 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:06:42,177 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:06:42,177 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 16:06:42,177 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:06:42,177 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:06:42,178 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:06:42,178 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:06:42,178 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:06:42,178 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:06:42,179 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:06:42,179 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:06:42,179 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:06:42,179 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:06:42,180 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:06:42,180 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:06:42,180 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:06:42,180 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:06:42,181 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:06:42,181 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:06:42,274 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:06:42,274 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:06:42,274 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:42,274 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:42,274 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:06:42,275 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:42,275 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:06:42,275 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:06:42,275 Line:689 通过SQL读原始数据：98
 [DEBUG] 2017-12-20 16:06:42,276 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:06:50,873 Line:135 BaseAction.execute 请求地址：/ReportDataAction.do
 [DEBUG] 2017-12-20 16:06:50,874 Line:146 BaseAction.execute 操作人:admin;请求数据：operation=[4,];reportNumber=[tblVirtualStock,];reportName=[虚拟库存查询,虚拟库存查询,];isClickQuery=[true,];isAllListQuery=[,];winCurIndex=[1,];src=[,];parentCode=[00003,];queryChannel=[normal,];SQLSave=[@SQL:{call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}@ParamList:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:@Param:0@Param:tblGoods@Param:@Param:@end:,];query=[,];NoButton=[,];backParent=[true,];checkTab=[Y,];defineOrderBy=[,];export=[,];noback=[,];mainNumber=[,];detTable_list=[,];moduleType=[,];popWinName=[,];upperQtyQ=[,];StockCode=[,];hide_StockCode=[,];tblStock.StockFullName=[,];GoodsCode=[,];hide_GoodsCode=[,];tblGoods.GoodsNumber=[,];tblGoods.GoodsFullName=[,];tblGoods.GoodsSpec=[,];tblGoods.BaseUnit=[,];NumberType=[0,];DataType=[tblGoods,];mobileGoodsFullName=[,];pageSize=[100,];pageNo=[1,];
 [DEBUG] 2017-12-20 16:06:50,906 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:06:50,907 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:06:50,907 Line:568 ReportDataMgt.getReportData 参数2:100
 [DEBUG] 2017-12-20 16:06:50,907 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:06:50,907 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:06:50,907 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:06:50,908 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:06:50,909 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:06:50,909 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:06:50,909 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:06:50,909 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:06:50,909 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:06:50,909 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:06:50,950 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:06:50,950 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:06:50,950 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:50,950 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:50,950 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:06:50,950 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:06:50,951 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:06:50,951 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:06:50,951 Line:689 通过SQL读原始数据：44
 [DEBUG] 2017-12-20 16:06:50,952 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:07:18,114 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:07:18,115 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:07:18,115 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:18,116 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:07:18,135 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:07:19,626 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:07:19,627 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:07:19,628 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:19,659 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:07:19,660 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:07:19,661 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:07:19,662 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:07:19,663 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:07:19,663 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:07:19,664 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:07:19,665 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:07:19,666 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:07:19,666 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:07:19,667 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:07:19,668 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:07:19,668 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:07:19,669 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:07:19,670 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:07:19,670 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:07:19,671 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:07:19,671 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:07:19,672 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:07:19,722 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:07:19,722 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:07:19,722 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:19,723 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:19,723 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:07:19,723 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:19,724 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:07:19,724 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:07:19,725 Line:689 通过SQL读原始数据：65
 [DEBUG] 2017-12-20 16:07:19,726 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:07:19,736 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:07:24,669 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:07:24,670 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:07:24,670 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:24,671 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:07:24,673 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:07:26,188 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:07:26,190 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:07:26,191 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:26,225 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:07:26,227 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:07:26,228 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:07:26,230 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:07:26,230 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:07:26,231 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:07:26,232 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:07:26,232 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:07:26,233 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:07:26,234 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:07:26,234 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:07:26,235 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:07:26,236 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:07:26,236 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:07:26,237 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:07:26,238 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:07:26,239 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:07:26,240 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:07:26,241 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:07:26,249 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:07:26,250 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:07:26,251 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:26,251 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:26,252 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:07:26,253 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:26,254 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:07:26,254 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:07:26,256 Line:689 通过SQL读原始数据：29
 [DEBUG] 2017-12-20 16:07:26,257 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:07:26,278 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:07:27,464 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:07:27,465 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[00003,];
 [DEBUG] 2017-12-20 16:07:27,465 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:27,475 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:07:27,475 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:07:27,475 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:07:27,475 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:07:27,476 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:07:27,476 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:07:27,476 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 16:07:27,476 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:07:27,477 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:07:27,477 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:07:27,477 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:07:27,477 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:07:27,478 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:07:27,478 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:07:27,478 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:07:27,478 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:07:27,479 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:07:27,479 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:07:27,479 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:07:27,481 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:07:27,481 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:07:27,481 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:27,481 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:27,482 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:07:27,482 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:27,482 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:07:27,482 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:07:27,482 Line:689 通过SQL读原始数据：7
 [DEBUG] 2017-12-20 16:07:27,483 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:07:27,486 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:07:44,031 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 16:07:44,032 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 16:07:44,032 Line:243 AIOApi op=getSessEmp&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:44,032 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 16:07:44,052 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 16:07:44,053 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 16:07:44,053 Line:243 AIOApi op=getEnum&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:44,054 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 16:07:56,971 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:07:56,971 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:07:56,971 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:56,972 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:07:56,990 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:07:58,486 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:07:58,488 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:07:58,489 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:07:58,567 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:07:58,569 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:07:58,570 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:07:58,571 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:07:58,572 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:07:58,573 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:07:58,574 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:07:58,574 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:07:58,574 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:07:58,575 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:07:58,576 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:07:58,576 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:07:58,577 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:07:58,577 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:07:58,578 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:07:58,579 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:07:58,580 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:07:58,580 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:07:58,581 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:07:58,641 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:07:58,641 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:07:58,641 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:58,641 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:58,642 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:07:58,642 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:07:58,642 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:07:58,642 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:07:58,642 Line:689 通过SQL读原始数据：73
 [DEBUG] 2017-12-20 16:07:58,643 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:07:58,650 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:08:00,130 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:08:00,130 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[00002,];
 [DEBUG] 2017-12-20 16:08:00,131 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:00,140 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:08:00,140 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:08:00,141 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:08:00,141 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:08:00,141 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:08:00,141 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:08:00,141 Line:582 ReportDataMgt.getReportData 参数6:00002
 [DEBUG] 2017-12-20 16:08:00,141 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:08:00,141 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:08:00,142 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:08:00,142 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:08:00,142 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:08:00,142 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:08:00,142 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:08:00,143 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:08:00,143 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:08:00,143 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:08:00,143 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:08:00,143 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:08:00,161 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:08:00,162 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:08:00,162 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:00,162 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:00,162 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:08:00,162 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:00,163 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:08:00,163 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00002_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00002%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00002%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00002%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:08:00,163 Line:689 通过SQL读原始数据：23
 [DEBUG] 2017-12-20 16:08:00,163 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:08:00,164 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:08:03,022 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:08:03,023 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:08:03,023 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:03,024 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:08:03,025 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:08:04,540 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:08:04,541 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:08:04,542 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:04,574 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:08:04,575 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:08:04,576 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:08:04,576 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:08:04,577 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:08:04,578 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:08:04,578 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:08:04,579 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:08:04,579 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:08:04,580 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:08:04,581 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:08:04,581 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:08:04,582 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:08:04,582 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:08:04,583 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:08:04,584 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:08:04,584 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:08:04,585 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:08:04,586 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:08:04,592 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:08:04,593 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:08:04,594 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:04,594 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:04,595 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:08:04,595 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:04,596 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:08:04,597 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:08:04,598 Line:689 通过SQL读原始数据：23
 [DEBUG] 2017-12-20 16:08:04,599 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:08:04,609 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:08:53,163 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:08:53,164 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:08:53,164 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:53,164 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:08:53,175 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:08:54,682 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:08:54,684 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:08:54,685 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:54,771 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:08:54,772 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:08:54,772 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:08:54,772 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:08:54,772 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:08:54,773 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:08:54,773 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:08:54,773 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:08:54,773 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:08:54,773 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:08:54,773 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:08:54,773 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:08:54,774 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:08:54,774 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:08:54,774 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:08:54,774 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:08:54,774 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:08:54,774 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:08:54,775 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:08:54,845 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:08:54,846 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:08:54,846 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:54,846 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:54,846 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:08:54,846 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:54,847 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:08:54,847 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:08:54,847 Line:689 通过SQL读原始数据：75
 [DEBUG] 2017-12-20 16:08:54,847 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:08:54,852 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:08:55,930 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:08:55,930 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[00003,];
 [DEBUG] 2017-12-20 16:08:55,931 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:55,951 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:08:55,952 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:08:55,952 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:08:55,952 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:08:55,952 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:08:55,952 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:08:55,952 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 16:08:55,952 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:08:55,953 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:08:55,954 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:08:55,954 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:08:55,954 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:08:55,997 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:08:55,997 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:08:55,997 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:55,998 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:55,998 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:08:55,998 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:08:55,998 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:08:55,998 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:08:55,998 Line:689 通过SQL读原始数据：46
 [DEBUG] 2017-12-20 16:08:55,998 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:08:56,002 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:08:57,743 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 16:08:57,744 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 16:08:57,744 Line:243 AIOApi op=getSessEmp&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:57,745 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 16:08:57,773 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 16:08:57,774 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 16:08:57,774 Line:243 AIOApi op=getEnum&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:08:57,775 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 16:09:04,249 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 16:09:04,249 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 16:09:04,250 Line:243 AIOApi op=getSessEmp&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:09:04,250 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 16:09:04,263 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 16:09:04,264 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 16:09:04,264 Line:243 AIOApi op=getEnum&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:09:04,265 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 16:09:37,438 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:09:37,439 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:09:37,439 Line:243 AIOApi op=popup&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:09:37,441 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:09:37,448 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:09:38,954 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:09:38,955 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:09:38,956 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:09:39,025 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:09:39,026 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:09:39,027 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:09:39,027 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:09:39,027 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:09:39,028 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:09:39,028 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:09:39,029 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:09:39,029 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:09:39,029 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:09:39,030 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:09:39,030 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:09:39,030 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:09:39,031 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:09:39,031 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:09:39,031 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:09:39,032 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:09:39,032 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:09:39,032 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:09:39,095 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:09:39,096 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:09:39,097 Line:689 通过SQL读原始数据：71
 [DEBUG] 2017-12-20 16:09:39,097 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:09:39,101 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:09:41,660 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:09:41,661 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[00003,];
 [DEBUG] 2017-12-20 16:09:41,662 Line:243 AIOApi op=report&sessionid=FFF01403963FA7A3E5753B95EBB6A71E
 [DEBUG] 2017-12-20 16:09:41,675 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:09:41,676 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:09:41,677 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:09:41,678 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:09:41,678 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:09:41,679 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:09:41,679 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 16:09:41,679 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:09:41,679 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:09:41,679 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:09:41,680 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:09:41,680 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:09:41,681 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:09:41,681 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:09:41,681 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:09:41,681 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:09:41,682 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:09:41,682 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:09:41,682 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:09:41,700 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:09:41,701 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:09:41,702 Line:689 通过SQL读原始数据：26
 [DEBUG] 2017-12-20 16:09:41,702 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 16:09:41,705 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 16:30:25,763 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 16:59:02,784 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:59:02,786 Line:3003 MobileAjax 操作人:;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:59:02,786 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:02,787 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 16:59:04,299 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:59:04,300 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:59:04,300 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:04,302 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 16:59:08,864 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 16:59:08,864 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 16:59:08,864 Line:243 AIOApi op=LOGIN&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:08,895 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 16:59:08,930 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 16:59:08,944 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 16:59:08,982 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 16:59:09,441 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 16:59:09,441 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 16:59:09,442 Line:243 AIOApi op=getSessEmp&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:09,442 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 16:59:09,462 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 16:59:09,462 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 16:59:09,463 Line:243 AIOApi op=getEnum&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:09,464 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 16:59:11,176 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 16:59:11,176 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 16:59:11,177 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:11,177 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 16:59:11,193 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 16:59:12,680 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 16:59:12,680 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 16:59:12,680 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 16:59:12,722 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 16:59:12,723 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 16:59:12,723 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 16:59:12,723 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 16:59:12,723 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 16:59:12,724 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 16:59:12,724 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 16:59:12,724 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 16:59:12,724 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 16:59:12,724 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 16:59:12,724 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 16:59:12,724 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 16:59:12,725 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 16:59:12,809 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 16:59:12,809 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 16:59:12,809 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:59:12,809 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:59:12,810 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 16:59:12,810 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 16:59:12,810 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 16:59:12,810 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 16:59:12,810 Line:689 通过SQL读原始数据：87
 [DEBUG] 2017-12-20 16:59:12,811 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 16:59:12,816 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:00:45,488 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 17:02:02,793 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:02:02,794 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:02:02,794 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:02:02,795 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:02:02,817 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:02:04,302 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:02:04,303 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:02:04,304 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:02:04,362 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:02:04,362 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:02:04,362 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:02:04,363 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:02:04,363 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:02:04,363 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:02:04,363 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:02:04,363 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:02:04,363 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:02:04,363 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:02:04,364 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:02:04,365 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:02:04,365 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:02:04,447 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:02:04,447 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:02:04,447 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:02:04,447 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:02:04,448 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:02:04,448 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:02:04,448 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:02:04,448 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:02:04,448 Line:689 通过SQL读原始数据：86
 [DEBUG] 2017-12-20 17:02:04,449 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 17:02:04,453 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:11:16,020 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:11:16,021 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:11:16,021 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:11:16,021 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:11:16,045 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:11:17,536 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:11:17,538 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:11:17,539 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:11:17,618 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:11:17,619 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:11:17,620 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:11:17,620 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:11:17,620 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:11:17,621 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:11:17,621 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:11:17,621 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:11:17,622 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:11:17,622 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:11:17,623 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:11:17,624 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:11:17,625 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:11:17,626 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:11:17,626 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:11:17,627 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:11:17,627 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:11:17,628 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:11:17,628 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:11:17,738 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:11:17,738 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:11:17,738 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:11:17,739 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:11:17,739 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:11:17,740 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:11:17,740 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:11:17,740 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:11:17,741 Line:689 通过SQL读原始数据：122
 [DEBUG] 2017-12-20 17:11:17,742 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 17:11:17,746 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:14:40,014 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:14:40,015 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:14:40,015 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:14:40,016 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:14:40,037 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:14:41,528 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:14:41,530 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:14:41,531 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:14:41,594 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:14:41,594 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:14:41,594 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:14:41,594 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:14:41,594 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:14:41,595 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:14:41,595 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:14:41,595 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:14:41,595 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:14:41,595 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:14:41,595 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:14:41,596 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:14:41,699 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:14:41,699 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:14:41,699 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:14:41,699 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:14:41,700 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:14:41,700 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:14:41,700 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:14:41,700 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:14:41,700 Line:689 通过SQL读原始数据：106
 [DEBUG] 2017-12-20 17:14:41,701 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 17:14:41,712 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:16:40,673 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:16:40,674 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:16:40,674 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:16:40,675 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:16:40,697 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:16:42,183 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:16:42,186 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:16:42,187 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:16:42,277 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:16:42,278 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:16:42,279 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:16:42,279 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:16:42,280 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:16:42,280 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:16:42,280 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:16:42,281 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:16:42,281 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:16:42,282 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:16:42,282 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:16:42,283 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:16:42,283 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:16:42,283 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:16:42,284 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:16:42,284 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:16:42,285 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:16:42,285 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:16:42,285 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:16:42,364 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:16:42,364 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:16:42,365 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:16:42,365 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:16:42,365 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:16:42,365 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:16:42,365 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:16:42,365 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:16:42,366 Line:689 通过SQL读原始数据：88
 [DEBUG] 2017-12-20 17:16:42,366 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 17:16:42,370 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:18:11,607 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:18:11,608 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:18:11,608 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:18:11,609 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:18:11,629 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:18:13,109 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:18:13,109 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:18:13,110 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:18:13,151 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:18:13,151 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:18:13,151 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:18:13,151 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:18:13,152 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:18:13,152 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:18:13,152 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:18:13,152 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:18:13,152 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:18:13,152 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:18:13,152 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:18:13,152 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:18:13,153 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:18:13,153 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:18:13,153 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:18:13,154 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:18:13,154 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:18:13,155 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:18:13,155 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:18:13,226 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:18:13,227 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:18:13,228 Line:689 通过SQL读原始数据：77
 [DEBUG] 2017-12-20 17:18:13,228 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 17:18:13,232 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:21:15,533 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:21:15,533 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:21:15,537 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:21:15,537 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:21:15,565 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:21:17,040 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:21:17,042 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:21:17,044 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:21:17,114 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:21:17,114 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:21:17,114 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:21:17,115 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:21:17,115 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:21:17,115 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:21:17,115 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:21:17,115 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:21:17,115 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:21:17,116 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:21:17,117 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:21:17,117 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:21:17,174 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:21:17,174 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:21:17,174 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:21:17,175 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:21:17,175 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:21:17,175 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:21:17,176 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:21:17,176 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:21:17,177 Line:689 通过SQL读原始数据：63
 [DEBUG] 2017-12-20 17:21:17,178 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 17:21:17,182 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:21:40,596 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:21:40,597 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:21:40,597 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:21:40,597 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:21:40,616 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:21:42,112 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:21:42,114 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:21:42,115 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:21:42,190 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:21:42,191 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:21:42,192 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:21:42,192 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:21:42,192 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:21:42,193 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:21:42,193 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:21:42,193 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:21:42,194 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:21:42,194 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:21:42,194 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:21:42,194 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:21:42,195 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:21:42,195 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:21:42,195 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:21:42,195 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:21:42,196 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:21:42,196 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:21:42,196 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:21:42,247 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:21:42,247 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:21:42,247 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:21:42,247 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:21:42,247 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:21:42,248 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:21:42,248 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:21:42,248 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:21:42,248 Line:689 通过SQL读原始数据：57
 [DEBUG] 2017-12-20 17:21:42,248 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 17:21:42,254 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:23:02,758 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:23:02,759 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:23:02,759 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:23:02,759 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:23:02,781 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:23:04,260 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:23:04,260 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:23:04,261 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:23:04,299 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:23:04,301 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:23:04,301 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:23:04,301 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:23:04,302 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:23:04,303 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:23:04,303 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:23:04,303 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:23:04,304 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:23:04,304 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:23:04,304 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:23:04,304 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:23:04,304 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:23:04,305 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:23:04,305 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:23:04,305 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:23:04,305 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:23:04,305 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:23:04,305 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:23:04,360 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:23:04,360 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:23:04,361 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:23:04,361 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:23:04,361 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:23:04,361 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:23:04,361 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:23:04,361 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:23:04,362 Line:689 通过SQL读原始数据：62
 [DEBUG] 2017-12-20 17:23:04,362 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 17:23:04,367 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:24:04,461 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:24:04,462 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:24:04,462 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:24:04,463 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:24:04,486 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:24:05,964 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:24:05,965 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:24:05,966 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:24:06,016 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:24:06,016 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:24:06,016 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:24:06,017 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:24:06,017 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:24:06,017 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:24:06,018 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:24:06,018 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:24:06,019 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:24:06,019 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:24:06,020 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:24:06,020 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:24:06,020 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:24:06,021 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:24:06,021 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:24:06,021 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:24:06,021 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:24:06,021 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:24:06,021 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:24:06,067 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:24:06,067 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:24:06,067 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:24:06,067 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:24:06,068 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:24:06,068 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:24:06,068 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:24:06,068 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:24:06,069 Line:689 通过SQL读原始数据：53
 [DEBUG] 2017-12-20 17:24:06,071 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 17:24:06,075 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:24:25,209 Line:2992 MobileAjax 请求地址：/MobileAjax?op=popup
 [DEBUG] 2017-12-20 17:24:25,210 Line:3003 MobileAjax 操作人:admin;请求数据：op=[popup,];tableName=[tblSalesOrder,];selectName=[model_getWorkNodeByTblName,];pageNo=[1,];pageSize=[10,];
 [DEBUG] 2017-12-20 17:24:25,210 Line:243 AIOApi op=popup&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:24:25,211 Line:3434 DynDBManager.popSelect selectName=model_getWorkNodeByTblName; sql=select *  from (select OAWorkFlowNode.keyId f1 ,OAWorkFlowNode.display f2 
,ROW_NUMBER() over( order by OAWorkFlowNode.keyId) as row_id from OAWorkFlowNode 
left join OAWorkFlowTemplate on OAWorkFlowNode.flowId = OAWorkFlowTemplate.id
where OAWorkFlowTemplate.templateFile = 'tblSalesOrder' and statusId = 0) a where  row_id between 1 and 10 order by row_id 
 [DEBUG] 2017-12-20 17:24:25,213 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"result":[{"label":"开始","value":"0"},{"label":"结束","value":"-1"},{"label":"主管审核","value":"1513322741341"},{"label":"财务审核","value":"1513322743692"}]}}
 [DEBUG] 2017-12-20 17:24:26,728 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 17:24:26,731 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 17:24:26,732 Line:243 AIOApi op=report&sessionid=8B582F9B1E55F6AFC61D43A1B531F6AE
 [DEBUG] 2017-12-20 17:24:26,769 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 17:24:26,769 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 17:24:26,770 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 17:24:26,770 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 17:24:26,770 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 17:24:26,771 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 17:24:26,771 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 17:24:26,771 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 17:24:26,772 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 17:24:26,772 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 17:24:26,772 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 17:24:26,773 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 17:24:26,773 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 17:24:26,773 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 17:24:26,773 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 17:24:26,774 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 17:24:26,774 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 17:24:26,774 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 17:24:26,774 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 17:24:26,777 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 17:24:26,777 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 17:24:26,777 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:24:26,778 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:24:26,778 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 17:24:26,778 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 17:24:26,778 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 17:24:26,778 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 17:24:26,779 Line:689 通过SQL读原始数据：10
 [DEBUG] 2017-12-20 17:24:26,780 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 17:24:26,786 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 17:31:05,931 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 18:07:48,146 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 18:08:54,191 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 18:08:54,193 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 18:08:54,193 Line:243 AIOApi op=report&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:08:54,194 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 18:08:57,195 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 18:08:57,196 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 18:08:57,196 Line:243 AIOApi op=LOGIN&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:08:57,224 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 18:08:57,260 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 18:08:57,271 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 18:08:57,317 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 18:08:57,786 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 18:08:57,788 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 18:08:57,788 Line:243 AIOApi op=getSessEmp&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:08:57,789 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 18:08:57,808 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 18:08:57,809 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 18:08:57,809 Line:243 AIOApi op=getEnum&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:08:57,810 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 18:09:01,086 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 18:09:01,086 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 18:09:01,086 Line:243 AIOApi op=report&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:09:01,133 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 18:09:01,134 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 18:09:01,134 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 18:09:01,134 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 18:09:01,134 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 18:09:01,135 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 18:09:01,135 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 18:09:01,135 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 18:09:01,135 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 18:09:01,135 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 18:09:01,135 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 18:09:01,135 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 18:09:01,136 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 18:09:01,243 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 18:09:01,243 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 18:09:01,243 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:09:01,243 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:09:01,243 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 18:09:01,244 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:09:01,244 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 18:09:01,244 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 18:09:01,244 Line:689 通过SQL读原始数据：111
 [DEBUG] 2017-12-20 18:09:01,245 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 18:09:01,251 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 18:15:21,836 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 18:15:21,836 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 18:15:21,837 Line:243 AIOApi op=report&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:15:21,883 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 18:15:21,883 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 18:15:21,883 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 18:15:21,884 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 18:15:21,884 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 18:15:21,884 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 18:15:21,884 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 18:15:21,884 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 18:15:21,884 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 18:15:21,884 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 18:15:21,884 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 18:15:21,885 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 18:15:22,041 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 18:15:22,041 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 18:15:22,042 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:15:22,042 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:15:22,042 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 18:15:22,042 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:15:22,042 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 18:15:22,043 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 18:15:22,043 Line:689 通过SQL读原始数据：160
 [DEBUG] 2017-12-20 18:15:22,043 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 18:15:22,049 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 18:16:09,524 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 18:16:09,525 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 18:16:09,526 Line:243 AIOApi op=report&sessionid=6AD36FC4F19B6BB29DE55C40AA52CA46
 [DEBUG] 2017-12-20 18:16:09,570 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 18:16:09,570 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 18:16:09,570 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 18:16:09,570 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 18:16:09,570 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 18:16:09,571 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 18:16:09,571 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 18:16:09,572 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 18:16:09,572 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 18:16:09,572 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 18:16:09,572 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 18:16:09,572 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 18:16:09,572 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 18:16:09,672 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 18:16:09,672 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 18:16:09,672 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:16:09,672 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:16:09,672 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 18:16:09,672 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 18:16:09,673 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 18:16:09,673 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 18:16:09,673 Line:689 通过SQL读原始数据：103
 [DEBUG] 2017-12-20 18:16:09,673 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 18:16:09,681 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [INFO ] 2017-12-20 22:38:52,979 Line:206 系统开始启动，最大内存：1792;目前总内存：301;目前空闲内存：200
 [INFO ] 2017-12-20 22:38:53,335 Line:284 ===========Tomcat Port=8888
 [INFO ] 2017-12-20 22:39:04,748 Line:2660 ---------------------------------first read dog =======-----------
 [DEBUG] 2017-12-20 22:39:05,120 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canJxc=1 
 [DEBUG] 2017-12-20 22:39:05,145 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canOa=1 
 [DEBUG] 2017-12-20 22:39:05,151 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canCrm=1 
 [DEBUG] 2017-12-20 22:39:05,158 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canHr=1 
 [DEBUG] 2017-12-20 22:39:05,179 Line:594 select AccPeriod,AccMonth,AccYear,scompanyId,statusId,isBegin from tblAccPeriod where statusId=1 or isBegin=1
 [DEBUG] 2017-12-20 22:39:05,193 Line:626 ------Init initAccPeriod record:1
 [DEBUG] 2017-12-20 22:39:07,953 Line:1061 ------Init Enumeration record:390
 [DEBUG] 2017-12-20 22:39:08,012 Line:1091 ------Init WorkProfession record:58
 [DEBUG] 2017-12-20 22:39:08,115 Line:1121 ------Init District record:3984
 [DEBUG] 2017-12-20 22:39:08,152 Line:1152 ------Init deptMap record:1
 [INFO ] 2017-12-20 22:39:45,030 Line:206 系统开始启动，最大内存：1792;目前总内存：551;目前空闲内存：88
 [INFO ] 2017-12-20 22:39:45,050 Line:284 ===========Tomcat Port=8888
 [INFO ] 2017-12-20 22:39:51,335 Line:2660 ---------------------------------first read dog =======-----------
 [DEBUG] 2017-12-20 22:39:51,646 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canJxc=1 
 [DEBUG] 2017-12-20 22:39:51,653 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canOa=1 
 [DEBUG] 2017-12-20 22:39:51,659 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canCrm=1 
 [DEBUG] 2017-12-20 22:39:51,664 Line:3336  select count(*) from tblEmployee where openFlag = 1 and statusid=0 and id <> '1' and canHr=1 
 [DEBUG] 2017-12-20 22:39:51,681 Line:594 select AccPeriod,AccMonth,AccYear,scompanyId,statusId,isBegin from tblAccPeriod where statusId=1 or isBegin=1
 [DEBUG] 2017-12-20 22:39:51,685 Line:626 ------Init initAccPeriod record:1
 [DEBUG] 2017-12-20 22:39:54,277 Line:1061 ------Init Enumeration record:390
 [DEBUG] 2017-12-20 22:39:54,335 Line:1091 ------Init WorkProfession record:58
 [DEBUG] 2017-12-20 22:39:54,399 Line:1121 ------Init District record:3984
 [DEBUG] 2017-12-20 22:39:54,419 Line:1152 ------Init deptMap record:1
 [DEBUG] 2017-12-20 22:39:56,828 Line:1832 ------Init ModuleList record:
 [DEBUG] 2017-12-20 22:39:56,828 Line:2855 --------Init ModuleList Successful---------------
 [DEBUG] 2017-12-20 22:39:58,284 Line:297  select * from tblDBTableInfo order by TableName 
 [DEBUG] 2017-12-20 22:39:58,520 Line:370 select * from tblDBFieldInfo order by tableId,listOrder
 [DEBUG] 2017-12-20 22:40:00,671 Line:538 ------Init TableInfo record:634
 [DEBUG] 2017-12-20 22:40:00,735 Line:651  select cataName,disName,module,tableName,nameField,codeField from tblScopeCataData order by orderby 
 [DEBUG] 2017-12-20 22:40:00,758 Line:682 ------Init TableInfo record:4
 [DEBUG] 2017-12-20 22:40:00,807 Line:775 ------Init initModuleField record:0
 [DEBUG] 2017-12-20 22:40:00,847 Line:702  select tableName,sentence from tblPopDisSentence where statusId=0 order by tableName 
 [DEBUG] 2017-12-20 22:40:00,866 Line:721 ------Init TableInfo record:26
 [DEBUG] 2017-12-20 22:40:00,951 Line:891 ------Init PropInfo record:7
 [DEBUG] 2017-12-20 22:40:05,930 Line:2947 --------Init Config File ---------------
 [ERROR] 2017-12-20 22:40:06,390 Line:48 java.io.FileNotFoundException: D:\Project\aio\tomcat7\bin\..\..\fileServer_v7\wokeflow\ffd4bcdd_1701241708235230006.xml (系统找不到指定的文件。)
 [DEBUG] 2017-12-20 22:40:06,409 Line:1873 ------Init RefreshTime 
 [DEBUG] 2017-12-20 22:40:06,473 Line:2994 --------Init SMS Start ---------------
 [INFO ] 2017-12-20 22:40:06,951 Line:3011 -------System init Secussful Set Normal status--------------
 [DEBUG] 2017-12-20 22:40:06,952 Line:3855 --------Init Dog Successful---------------
 [INFO ] 2017-12-20 22:40:09,616 Line:89 SAFE 数据库第一个备份任务启动，时间2017-12-21 00:00:00
 [INFO ] 2017-12-20 22:40:09,617 Line:137 SAFE 碎片任务启动，时间2017-12-24 00:00:00
 [DEBUG] 2017-12-20 22:40:13,500 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 22:40:13,504 Line:3003 MobileAjax 操作人:;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 22:40:13,505 Line:243 AIOApi op=getSessEmp&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:13,576 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 22:40:15,145 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:40:15,146 Line:3003 MobileAjax 操作人:;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:40:15,147 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:15,148 Line:2961 MobileAjax 操作人:;返回数据：{"code":"NOLOGIN","msg":"未登陆"}
 [DEBUG] 2017-12-20 22:40:22,729 Line:2992 MobileAjax 请求地址：/MobileAjax?op=LOGIN
 [DEBUG] 2017-12-20 22:40:22,730 Line:3003 MobileAjax 操作人:;请求数据：op=[LOGIN,];name=[admin,];password=[21232f297a57a5a743894a0e4a801fc3,];
 [DEBUG] 2017-12-20 22:40:22,731 Line:243 AIOApi op=LOGIN&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:22,823 Line:404 PublicMgt.queryClass 查询可新建工作流sql=select work.id,work.templateName,work.templateType,a.ModuleName,work.templateStatus,work.templateClass,work.statusId,work.flowOrder,work.templateFile,work.allowAdd,work.timeType,work.timeVal,work.designType  from OAWorkFlowTemplate work, tblWorkFlowType a where work.templateClass=a.classCode and a.classCode like '00002%'  and work.fileFinish='1' and work.templateStatus=1 and work.statusId=0  order by work.flowOrder
 [DEBUG] 2017-12-20 22:40:22,921 Line:2987 select count(*) from tblSunCompanys a where a.classCode like '00001_____%'
 [DEBUG] 2017-12-20 22:40:22,951 Line:530 select AccYear,AccOverYear from  tblAccPeriod group by Accyear,AccOverYear
 [DEBUG] 2017-12-20 22:40:23,222 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"登陆成功"}
 [DEBUG] 2017-12-20 22:40:23,701 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getSessEmp
 [DEBUG] 2017-12-20 22:40:23,702 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getSessEmp,];
 [DEBUG] 2017-12-20 22:40:23,702 Line:243 AIOApi op=getSessEmp&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:23,706 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"departmentName":"默认部门","titleId":"12","name":"admin","id":"1"}}
 [DEBUG] 2017-12-20 22:40:23,734 Line:2992 MobileAjax 请求地址：/MobileAjax?op=getEnum&enum=duty
 [DEBUG] 2017-12-20 22:40:23,735 Line:3003 MobileAjax 操作人:admin;请求数据：op=[getEnum,];enum=[duty,];
 [DEBUG] 2017-12-20 22:40:23,735 Line:243 AIOApi op=getEnum&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:23,741 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":[{"name":"职员","value":"11"},{"name":"法人","value":"1"},{"name":"董事","value":"10"},{"name":"董事长","value":"9"},{"name":"总经理","value":"2"},{"name":"部门经理","value":"3"},{"name":"副经理","value":"5"},{"name":"部长","value":"4"},{"name":"副部长","value":"6"},{"name":"主管","value":"7"},{"name":"副主管","value":"8"},{"name":"其他","value":"12"}]}
 [DEBUG] 2017-12-20 22:40:30,369 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:40:30,370 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:40:30,371 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:30,850 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:40:30,859 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:40:30,859 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:40:30,860 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:40:30,860 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:40:30,860 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:40:30,860 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:40:30,860 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:40:30,861 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:40:30,861 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:40:30,861 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:40:30,861 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:40:30,861 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:40:30,862 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:40:30,862 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:40:30,862 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:40:30,862 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:40:30,862 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:40:30,863 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:40:30,914 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:40:30,915 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:40:30,915 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:30,916 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:30,916 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:40:30,917 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:30,917 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:40:30,917 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:40:30,919 Line:689 通过SQL读原始数据：60
 [DEBUG] 2017-12-20 22:40:30,921 Line:1391 整理数据：1
 [DEBUG] 2017-12-20 22:40:30,966 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:40:33,406 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:40:33,407 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[00003,];StockCode=[,];
 [DEBUG] 2017-12-20 22:40:33,407 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:33,428 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:40:33,429 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:40:33,430 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:40:33,431 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:40:33,431 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:40:33,432 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:40:33,432 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 22:40:33,433 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:40:33,433 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:40:33,434 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:40:33,434 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:40:33,435 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:40:33,436 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:40:33,436 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:40:33,437 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:40:33,437 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:40:33,438 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:40:33,438 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:40:33,439 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:40:33,473 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:40:33,474 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:40:33,474 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:33,474 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:33,474 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:40:33,475 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:33,475 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:40:33,475 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%')) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:40:33,476 Line:689 通过SQL读原始数据：47
 [DEBUG] 2017-12-20 22:40:33,477 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:40:33,491 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:40:58,786 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:40:58,788 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:40:58,788 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:40:58,830 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:40:58,832 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:40:58,832 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:40:58,833 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:40:58,834 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:40:58,834 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:40:58,835 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:40:58,836 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:40:58,836 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:40:58,837 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:40:58,838 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:40:58,838 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:40:58,839 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:40:58,839 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:40:58,840 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:40:58,842 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:40:58,843 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:40:58,844 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:40:58,845 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:40:58,850 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:40:58,851 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:40:58,851 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:58,852 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:58,852 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:40:58,853 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:40:58,853 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:40:58,854 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:40:58,856 Line:689 通过SQL读原始数据：25
 [DEBUG] 2017-12-20 22:40:58,860 Line:1391 整理数据：4
 [DEBUG] 2017-12-20 22:40:58,892 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:41:07,110 Line:56 ConfigRefresh.getLastInfo -- and refresh ip
 [DEBUG] 2017-12-20 22:43:29,243 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:43:29,246 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:43:29,246 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:43:29,314 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:43:29,315 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:43:29,316 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:43:29,316 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:43:29,316 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:43:29,317 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:43:29,317 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:43:29,317 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:43:29,318 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:43:29,318 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:43:29,318 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:43:29,319 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:43:29,319 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:43:29,320 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:43:29,320 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:43:29,321 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:43:29,321 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:43:29,322 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:43:29,322 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:43:29,443 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:43:29,444 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:43:29,444 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:43:29,444 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:43:29,445 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:43:29,445 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:43:29,445 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:43:29,446 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:43:29,447 Line:689 通过SQL读原始数据：132
 [DEBUG] 2017-12-20 22:43:29,450 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 22:43:29,470 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:43:49,521 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:43:49,523 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:43:49,524 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:43:49,568 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:43:49,568 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:43:49,569 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:43:49,569 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:43:49,570 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:43:49,570 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:43:49,570 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:43:49,571 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:43:49,571 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:43:49,572 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:43:49,572 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:43:49,572 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:43:49,573 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:43:49,573 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:43:49,573 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:43:49,574 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:43:49,574 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:43:49,574 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:43:49,575 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:43:49,634 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:43:49,635 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:43:49,635 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:43:49,635 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:43:49,635 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:43:49,635 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:43:49,636 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:43:49,636 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:43:49,636 Line:689 通过SQL读原始数据：68
 [DEBUG] 2017-12-20 22:43:49,637 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:43:49,646 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:45:20,438 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:45:20,438 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:45:20,439 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:45:20,463 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:45:20,464 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:45:20,464 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:45:20,464 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:45:20,464 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:45:20,465 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:45:20,465 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:45:20,465 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:45:20,465 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:45:20,465 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:45:20,465 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:45:20,465 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:45:20,466 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:45:20,466 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:45:20,466 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:45:20,466 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:45:20,466 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:45:20,466 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:45:20,467 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:45:20,504 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:45:20,505 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:45:20,505 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:45:20,505 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:45:20,505 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:45:20,505 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:45:20,505 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:45:20,506 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:45:20,506 Line:689 通过SQL读原始数据：42
 [DEBUG] 2017-12-20 22:45:20,508 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 22:45:20,516 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:47:15,317 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:47:15,319 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:47:15,320 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:47:15,394 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:47:15,395 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:47:15,395 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:47:15,395 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:47:15,396 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:47:15,396 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:47:15,396 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:47:15,396 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:47:15,396 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:47:15,397 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:47:15,397 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:47:15,397 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:47:15,397 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:47:15,397 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:47:15,397 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:47:15,398 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:47:15,398 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:47:15,398 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:47:15,398 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:47:15,443 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:47:15,443 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:47:15,444 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:15,444 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:15,444 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:47:15,444 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:15,444 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:47:15,444 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:47:15,445 Line:689 通过SQL读原始数据：50
 [DEBUG] 2017-12-20 22:47:15,445 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:47:15,451 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:47:25,007 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:47:25,010 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:47:25,011 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:47:25,030 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:47:25,031 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:47:25,032 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:47:25,032 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:47:25,032 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:47:25,033 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:47:25,033 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:47:25,033 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:47:25,034 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:47:25,034 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:47:25,034 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:47:25,035 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:47:25,035 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:47:25,035 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:47:25,036 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:47:25,036 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:47:25,036 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:47:25,036 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:47:25,037 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:47:25,040 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:47:25,040 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:47:25,041 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:25,041 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:25,042 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:47:25,042 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:25,042 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:47:25,043 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:47:25,044 Line:689 通过SQL读原始数据：13
 [DEBUG] 2017-12-20 22:47:25,046 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 22:47:25,059 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:47:35,522 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:47:35,524 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[,];StockCode=[00001,];
 [DEBUG] 2017-12-20 22:47:35,524 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:47:35,547 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:47:35,548 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:47:35,548 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:47:35,548 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:47:35,549 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:47:35,549 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:47:35,549 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:47:35,549 Line:582 ReportDataMgt.getReportData 参数7:00001
 [DEBUG] 2017-12-20 22:47:35,549 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:47:35,549 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:47:35,549 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:47:35,550 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:47:35,551 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:47:35,571 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:47:35,572 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:47:35,572 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:35,572 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00001'+'%' )
 [DEBUG] 2017-12-20 22:47:35,572 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:47:35,572 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:35,572 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:47:35,573 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:47:35,573 Line:689 通过SQL读原始数据：25
 [DEBUG] 2017-12-20 22:47:35,573 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:47:35,576 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00001"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 22:47:46,076 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:47:46,077 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[,];StockCode=[00002,];
 [DEBUG] 2017-12-20 22:47:46,077 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:47:46,088 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:47:46,089 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:47:46,089 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:47:46,089 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:47:46,089 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:47:46,089 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:47:46,090 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:47:46,090 Line:582 ReportDataMgt.getReportData 参数7:00002
 [DEBUG] 2017-12-20 22:47:46,090 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:47:46,090 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:47:46,090 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:47:46,090 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:47:46,091 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:47:46,091 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:47:46,091 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:47:46,091 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:47:46,092 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:47:46,092 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:47:46,092 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:47:46,108 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:47:46,109 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:47:46,109 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:46,109 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00002'+'%' )
 [DEBUG] 2017-12-20 22:47:46,109 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:47:46,109 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:46,109 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:47:46,110 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and ( b.StockCode like '00002'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00002'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00002'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:47:46,110 Line:689 通过SQL读原始数据：21
 [DEBUG] 2017-12-20 22:47:46,110 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:47:46,111 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00002"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 22:47:55,757 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:47:55,760 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[,];StockCode=[00001,];
 [DEBUG] 2017-12-20 22:47:55,760 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:47:55,782 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:47:55,782 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:47:55,783 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:47:55,783 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:47:55,783 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:47:55,784 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:47:55,784 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:47:55,784 Line:582 ReportDataMgt.getReportData 参数7:00001
 [DEBUG] 2017-12-20 22:47:55,785 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:47:55,785 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:47:55,785 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:47:55,786 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:47:55,786 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:47:55,786 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:47:55,787 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:47:55,787 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:47:55,787 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:47:55,788 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:47:55,788 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:47:55,791 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:47:55,792 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:47:55,793 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:55,793 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00001'+'%' )
 [DEBUG] 2017-12-20 22:47:55,794 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:47:55,794 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:55,794 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:47:55,795 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:47:55,795 Line:689 通过SQL读原始数据：13
 [DEBUG] 2017-12-20 22:47:55,796 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:47:55,802 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00001"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 22:47:58,892 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:47:58,895 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[,];StockCode=[00001,];
 [DEBUG] 2017-12-20 22:47:58,896 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:47:58,946 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:47:58,946 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:47:58,946 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:47:58,946 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:47:58,947 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:47:58,947 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:47:58,947 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:47:58,947 Line:582 ReportDataMgt.getReportData 参数7:00001
 [DEBUG] 2017-12-20 22:47:58,947 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:47:58,947 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:47:58,947 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:47:58,948 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:47:58,948 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:47:58,948 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:47:58,948 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:47:58,948 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:47:58,948 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:47:58,949 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:47:58,949 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:47:58,995 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:47:58,996 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:47:58,996 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:58,996 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00001'+'%' )
 [DEBUG] 2017-12-20 22:47:58,996 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:47:58,997 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:47:58,997 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:47:58,997 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:47:58,997 Line:689 通过SQL读原始数据：51
 [DEBUG] 2017-12-20 22:47:58,998 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:47:59,001 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00001"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 22:52:00,721 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:52:00,722 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:52:00,723 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:52:00,749 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:52:00,750 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:52:00,750 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:52:00,750 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:52:00,750 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:52:00,750 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:52:00,750 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:52:00,751 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:52:00,752 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:52:00,752 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:52:00,752 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:52:00,752 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:52:00,792 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:52:00,792 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:52:00,792 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:00,792 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:00,793 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:52:00,793 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:00,793 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:52:00,793 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:52:00,793 Line:689 通过SQL读原始数据：43
 [DEBUG] 2017-12-20 22:52:00,794 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:52:00,800 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:52:06,098 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:52:06,100 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:52:06,101 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:52:06,126 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:52:06,127 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:52:06,128 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:52:06,128 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:52:06,129 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:52:06,129 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:52:06,130 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:52:06,130 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:52:06,130 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:52:06,131 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:52:06,131 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:52:06,132 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:52:06,132 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:52:06,132 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:52:06,133 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:52:06,133 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:52:06,133 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:52:06,134 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:52:06,134 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:52:06,138 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:52:06,139 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:52:06,139 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:06,140 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:06,140 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:52:06,141 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:06,141 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:52:06,142 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:52:06,142 Line:689 通过SQL读原始数据：15
 [DEBUG] 2017-12-20 22:52:06,146 Line:1391 整理数据：2
 [DEBUG] 2017-12-20 22:52:06,157 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:52:42,343 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:52:42,345 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];
 [DEBUG] 2017-12-20 22:52:42,346 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:52:42,409 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:52:42,410 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:52:42,410 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:52:42,411 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:52:42,411 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:52:42,412 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:52:42,412 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:52:42,412 Line:582 ReportDataMgt.getReportData 参数7:
 [DEBUG] 2017-12-20 22:52:42,413 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:52:42,413 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:52:42,413 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:52:42,414 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:52:42,414 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:52:42,415 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:52:42,415 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:52:42,415 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:52:42,415 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:52:42,416 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:52:42,416 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:52:42,465 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:52:42,466 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:52:42,466 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:42,466 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:42,466 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:52:42,466 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:42,466 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:52:42,467 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish') as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:52:42,467 Line:689 通过SQL读原始数据：57
 [DEBUG] 2017-12-20 22:52:42,467 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:52:42,473 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode",""],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","floatc等等！
 [DEBUG] 2017-12-20 22:52:46,738 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:52:46,740 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[,];StockCode=[00001,];
 [DEBUG] 2017-12-20 22:52:46,740 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:52:46,756 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:52:46,756 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:52:46,756 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:52:46,756 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:52:46,757 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:52:46,757 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:52:46,757 Line:582 ReportDataMgt.getReportData 参数6:
 [DEBUG] 2017-12-20 22:52:46,757 Line:582 ReportDataMgt.getReportData 参数7:00001
 [DEBUG] 2017-12-20 22:52:46,757 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:52:46,757 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:52:46,757 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:52:46,758 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:52:46,759 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:52:46,775 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:52:46,775 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:52:46,776 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:46,776 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00001'+'%' )
 [DEBUG] 2017-12-20 22:52:46,776 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:52:46,776 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:52:46,776 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:52:46,776 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and ( b.StockCode like '00001'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:52:46,777 Line:689 通过SQL读原始数据：21
 [DEBUG] 2017-12-20 22:52:46,777 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:52:46,779 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00001"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 22:53:01,749 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:53:01,752 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[00003,];StockCode=[00001,];
 [DEBUG] 2017-12-20 22:53:01,753 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:53:01,777 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:53:01,778 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:53:01,778 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:53:01,778 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:53:01,779 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:53:01,781 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:53:01,782 Line:582 ReportDataMgt.getReportData 参数6:00003
 [DEBUG] 2017-12-20 22:53:01,782 Line:582 ReportDataMgt.getReportData 参数7:00001
 [DEBUG] 2017-12-20 22:53:01,783 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:53:01,783 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:53:01,783 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:53:01,783 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:53:01,783 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:53:01,783 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:53:01,784 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:53:01,784 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:53:01,784 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:53:01,784 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:53:01,784 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:53:01,801 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:53:01,802 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:53:01,802 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:53:01,802 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00001'+'%' )
 [DEBUG] 2017-12-20 22:53:01,802 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:53:01,802 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:53:01,802 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:53:01,803 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '00003_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '00003%') and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '00003%') and ( b.StockCode like '00001'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:53:01,803 Line:689 通过SQL读原始数据：25
 [DEBUG] 2017-12-20 22:53:01,803 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:53:01,807 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00001"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 22:53:18,252 Line:2992 MobileAjax 请求地址：/MobileAjax?op=report&reportNumber=tblVirtualStock
 [DEBUG] 2017-12-20 22:53:18,256 Line:3003 MobileAjax 操作人:admin;请求数据：op=[report,];reportNumber=[tblVirtualStock,];pageNo=[1,];pageSize=[10,];src=[menu,];DataType=[tblGoods,];mobileGoodsFullName=[,];parentCode=[0000300001,];StockCode=[00001,];
 [DEBUG] 2017-12-20 22:53:18,257 Line:243 AIOApi op=report&sessionid=5918D922D14EDCCBFD75167D0596B230
 [DEBUG] 2017-12-20 22:53:18,278 Line:549 ReportDataMgt.getReportData SQL={call report_VirtualStock (@pageNo=?,@pageSize=?,@locale=?,@userId=?,@sunCompany=?,@classCode=?,@StockCode=?,@GoodsCode=?,@BatchNo=?,@Inch=?,@Hue=?,@yearNO=?,@ProDate=?,@Availably=?,@NumberType=?,@DataType=?,@upperQtyQ=?,@mobileGoodsFullName=?)}
 [DEBUG] 2017-12-20 22:53:18,279 Line:567 ReportDataMgt.getReportData 参数1:1
 [DEBUG] 2017-12-20 22:53:18,280 Line:568 ReportDataMgt.getReportData 参数2:10
 [DEBUG] 2017-12-20 22:53:18,281 Line:569 ReportDataMgt.getReportData 参数3:zh_CN
 [DEBUG] 2017-12-20 22:53:18,281 Line:570 ReportDataMgt.getReportData 参数4:1
 [DEBUG] 2017-12-20 22:53:18,282 Line:571 ReportDataMgt.getReportData 参数5:00001
 [DEBUG] 2017-12-20 22:53:18,282 Line:582 ReportDataMgt.getReportData 参数6:0000300001
 [DEBUG] 2017-12-20 22:53:18,282 Line:582 ReportDataMgt.getReportData 参数7:00001
 [DEBUG] 2017-12-20 22:53:18,282 Line:582 ReportDataMgt.getReportData 参数8:
 [DEBUG] 2017-12-20 22:53:18,282 Line:582 ReportDataMgt.getReportData 参数9:
 [DEBUG] 2017-12-20 22:53:18,282 Line:582 ReportDataMgt.getReportData 参数10:
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数11:
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数12:
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数13:
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数14:
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数15:0
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数16:tblGoods
 [DEBUG] 2017-12-20 22:53:18,283 Line:582 ReportDataMgt.getReportData 参数17:
 [DEBUG] 2017-12-20 22:53:18,284 Line:582 ReportDataMgt.getReportData 参数18:
 [DEBUG] 2017-12-20 22:53:18,301 Line:587 ReportDataMgt.getReportData warn 正在直接执行 SQL；无游标。
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn 商品，仓库权限语句
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn  and ( b.StockCode like '00001'+'%' )
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn 解析出的查询条件
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn  
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn 最终显示数据的查询语句
 [DEBUG] 2017-12-20 22:53:18,302 Line:587 ReportDataMgt.getReportData warn SELECT ROW_NUMBER() OVER(ORDER BY tblGoods.GoodsNumber) AS rowid,
			tblGoods.classCode,
            tblGoods.isCatalog,
            tblGoods.classCode+ '#;#'+ CAST(tblGoods.isCatalog AS VARCHAR(10))+ '#;##;#' AS hide_GoodsCode,
            tblGoods.GoodsNumber AS GoodsNumber,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end as BatchNo,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end as Inch,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end as Hue,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end as yearNO,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end as ProDate,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end as Availably,sum(isnull(lastQty,0)),sum(isnull(inQtyNotAudit,0)),sum(isnull(SInQtyNotAudit,0)),sum(isnull(outQtyNotAudit,0)),sum(isnull(BOutQtyNotAudit,0)),sum(isnull(UseQty,0)),sum(isnull(buyOrderQty,0)),sum(isnull(salesOrderQty,0)),sum(isnull(UseQty,0))+sum(isnull(buyOrderQty,0))-sum(isnull(salesOrderQty,0)) as orderQty FROM (select GoodsNumber,classCode,isCatalog,upperQty,lowerQty from tblGoods where workFlowNodeName='finish' and (tblGoods.classCode like '0000300001_____')) as tblGoods  LEFT JOIN (SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,lastQty,inQtyNotAudit,SInQtyNotAudit,outQtyNotAudit,BOutQtyNotAudit,lastQty+inQtyNotAudit+SInQtyNotAudit-outQtyNotAudit-BOutQtyNotAudit as UseQty,0 as buyOrderQty,0 as salesOrderQty FROM tblStocks as b where 1=1 and (b.GoodsCode like '0000300001%') and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,NotInQty,0 FROM tblBuyOrder a,tblBuyOrderDet b WHERE a.id = b.f_ref AND b.NotInQty>0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '0000300001%') and ( b.StockCode like '00001'+'%' ) union all SELECT GoodsCode,BatchNo,Inch,Hue,yearNO,ProDate,Availably,0,0,0,0,0,0,0,NotOutQty FROM tblSalesOrder a,tblSalesOrderDet b WHERE a.id = b.f_ref AND b.NotOutQty> 0 AND a.statusId = 0 AND a.workFlowNodeName = 'finish' and (b.GoodsCode like '0000300001%') and ( b.StockCode like '00001'+'%' )) as b on tblGoods.classCode = SUBSTRING(b.GoodsCode, 1, LEN(tblGoods.classCode)) group by tblGoods.classCode,tblGoods.GoodsNumber,tblGoods.isCatalog,tblGoods.upperQty,tblGoods.lowerQty,case when tblGoods.isCatalog=1 then '' else isnull(b.BatchNo,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Inch,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Hue,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.yearNO,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.ProDate,'') end,
						case when tblGoods.isCatalog=1 then '' else isnull(b.Availably,'') end  having 1=1 and abs(sum(isnull(lastQty,0)))+abs(sum(isnull(inQtyNotAudit,0)))+abs(sum(isnull(SInQtyNotAudit,0)))+abs(sum(isnull(outQtyNotAudit,0)))+abs(sum(isnull(BOutQtyNotAudit,0)))+abs(sum(isnull(buyOrderQty,0)))+abs(sum(isnull(salesOrderQty,0)))>0
 [DEBUG] 2017-12-20 22:53:18,303 Line:689 通过SQL读原始数据：24
 [DEBUG] 2017-12-20 22:53:18,303 Line:1391 整理数据：0
 [DEBUG] 2017-12-20 22:53:18,304 Line:2961 MobileAjax 操作人:admin;返回数据：{"code":"OK","msg":"","obj":{"conditions":[["StockCode","00001"],["GoodsCode",""],["NumberType","0"],["DataType","tblGoods"],["upperQtyQ",""],["mobileGoodsFullName",""]],"cols":[["classCode","-1","string","","GoodsCode"],["","-1","string","","classCode"],["商品编号","100","string","","GoodsNumber"],["商品名称","150","string","","GoodsFullName"],["商品规格","200","string","","GoodsSpec"],["单位","30","string","","BaseUnit"],["库存上限","90","float","","upperQty"],["库存下限","90","float","","lowerQty"],["实际库存","90","f等等！
 [DEBUG] 2017-12-20 23:01:22,754 Line:73 --------Destroy Config Refresh Thread---------------
 [DEBUG] 2017-12-20 23:01:22,756 Line:105 --------Destroy Hibernate---------------
 [INFO ] 2017-12-20 23:01:22,773 Line:127 测试执行路径
 java.lang.Exception
	at com.menyi.web.util.BaseFilter.destroy(BaseFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterConfig.release(ApplicationFilterConfig.java:313)
	at org.apache.catalina.core.StandardContext.filterStop(StandardContext.java:4890)
	at org.apache.catalina.core.StandardContext.stopInternal(StandardContext.java:5711)
	at org.apache.catalina.util.LifecycleBase.stop(LifecycleBase.java:232)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1591)
	at org.apache.catalina.core.ContainerBase$StopChild.call(ContainerBase.java:1580)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
[ERROR] 2017-12-20 23:01:22,794 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineAcc.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1370)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,795 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineBuy.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,796 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineFixedAsset.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,797 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineFlowNqingjiadan2.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,797 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineMobileVue.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,798 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineOther.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,798 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\definePluginunit.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,798 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineSales.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,800 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineStore.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,801 Line:60 -----------SqlConfig parse file D:\Project\aio\tomcat7\bin\..\..\config_v7\define\defineTask.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.SqlConfig.parse(SqlConfig.java:44)
	at com.menyi.web.util.SqlConfig.parseConfig(SqlConfig.java:33)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3875)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,801 Line:3876 --------Refresh SqlConfig Failture---------------
 [ERROR] 2017-12-20 23:01:22,803 Line:3887 --------Refresh DefineButton Failture---------------
 [ERROR] 2017-12-20 23:01:22,803 Line:69 -----------NoteConfig parse file ../../config_v7/TimingMsg.xml error----------------
 java.lang.NullPointerException
	at org.apache.catalina.loader.WebappClassLoader.findResources(WebappClassLoader.java:1334)
	at java.lang.ClassLoader.getResources(ClassLoader.java:1142)
	at java.util.ServiceLoader$LazyIterator.hasNextService(ServiceLoader.java:348)
	at java.util.ServiceLoader$LazyIterator.hasNext(ServiceLoader.java:393)
	at java.util.ServiceLoader$1.hasNext(ServiceLoader.java:474)
	at javax.xml.parsers.FactoryFinder$1.run(FactoryFinder.java:293)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.xml.parsers.FactoryFinder.findServiceProvider(FactoryFinder.java:289)
	at javax.xml.parsers.FactoryFinder.find(FactoryFinder.java:267)
	at javax.xml.parsers.DocumentBuilderFactory.newInstance(DocumentBuilderFactory.java:120)
	at com.menyi.web.util.NoteConfig.parse(NoteConfig.java:38)
	at com.menyi.web.util.NoteConfig.parseConfig(NoteConfig.java:30)
	at com.menyi.web.util.InitMenData.initConfigFile(InitMenData.java:3896)
	at com.menyi.web.util.ConfigRefresh.run(ConfigRefresh.java:192)
[ERROR] 2017-12-20 23:01:22,803 Line:3897 --------Init TimingConfig Failture---------------
 